\section{C\+AN Bus Error management functions}
\label{group__CAN__Group5}\index{C\+A\+N Bus Error management functions@{C\+A\+N Bus Error management functions}}


C\+AN Bus Error management functions.  


\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
uint8\+\_\+t \textbf{ C\+A\+N\+\_\+\+Get\+Last\+Error\+Code} (\textbf{ C\+A\+N\+\_\+\+Type\+Def} $\ast$C\+A\+Nx)
\begin{DoxyCompactList}\small\item\em Returns the C\+A\+Nx\textquotesingle{}s last error code (L\+EC). \end{DoxyCompactList}\item 
uint8\+\_\+t \textbf{ C\+A\+N\+\_\+\+Get\+Receive\+Error\+Counter} (\textbf{ C\+A\+N\+\_\+\+Type\+Def} $\ast$C\+A\+Nx)
\begin{DoxyCompactList}\small\item\em Returns the C\+A\+Nx Receive Error Counter (R\+EC). \end{DoxyCompactList}\item 
uint8\+\_\+t \textbf{ C\+A\+N\+\_\+\+Get\+L\+S\+B\+Transmit\+Error\+Counter} (\textbf{ C\+A\+N\+\_\+\+Type\+Def} $\ast$C\+A\+Nx)
\begin{DoxyCompactList}\small\item\em Returns the L\+SB of the 9-\/bit C\+A\+Nx Transmit Error Counter(\+T\+E\+C). \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
C\+AN Bus Error management functions. 

\begin{DoxyVerb} ===============================================================================
                      CAN Bus Error management functions
 ===============================================================================  
  This section provides functions allowing to 
   -  Return the CANx's last error code (LEC)
   -  Return the CANx Receive Error Counter (REC)
   -  Return the LSB of the 9-bit CANx Transmit Error Counter(TEC).
   
   @note If TEC is greater than 255, The CAN is in bus-off state.
   @note if REC or TEC are greater than 96, an Error warning flag occurs.
   @note if REC or TEC are greater than 127, an Error Passive Flag occurs.\end{DoxyVerb}
 

\subsection{Function Documentation}
\mbox{\label{group__CAN__Group5_gaaee721a392b6b21bfd15dc160aeb6924}} 
\index{C\+A\+N Bus Error management functions@{C\+A\+N Bus Error management functions}!C\+A\+N\+\_\+\+Get\+Last\+Error\+Code@{C\+A\+N\+\_\+\+Get\+Last\+Error\+Code}}
\index{C\+A\+N\+\_\+\+Get\+Last\+Error\+Code@{C\+A\+N\+\_\+\+Get\+Last\+Error\+Code}!C\+A\+N Bus Error management functions@{C\+A\+N Bus Error management functions}}
\subsubsection{C\+A\+N\+\_\+\+Get\+Last\+Error\+Code()}
{\footnotesize\ttfamily uint8\+\_\+t C\+A\+N\+\_\+\+Get\+Last\+Error\+Code (\begin{DoxyParamCaption}\item[{\textbf{ C\+A\+N\+\_\+\+Type\+Def} $\ast$}]{C\+A\+Nx }\end{DoxyParamCaption})}



Returns the C\+A\+Nx\textquotesingle{}s last error code (L\+EC). 


\begin{DoxyParams}{Parameters}
{\em C\+A\+Nx} & where x can be 1 or 2 to select the C\+AN peripheral. \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em Error} & code\+:
\begin{DoxyItemize}
\item C\+A\+N\+\_\+\+E\+R\+R\+O\+R\+C\+O\+D\+E\+\_\+\+No\+Err\+: No Error
\item C\+A\+N\+\_\+\+E\+R\+R\+O\+R\+C\+O\+D\+E\+\_\+\+Stuff\+Err\+: Stuff Error
\item C\+A\+N\+\_\+\+E\+R\+R\+O\+R\+C\+O\+D\+E\+\_\+\+Form\+Err\+: Form Error
\item C\+A\+N\+\_\+\+E\+R\+R\+O\+R\+C\+O\+D\+E\+\_\+\+A\+C\+K\+Err \+: Acknowledgment Error
\item C\+A\+N\+\_\+\+E\+R\+R\+O\+R\+C\+O\+D\+E\+\_\+\+Bit\+Recessive\+Err\+: Bit Recessive Error
\item C\+A\+N\+\_\+\+E\+R\+R\+O\+R\+C\+O\+D\+E\+\_\+\+Bit\+Dominant\+Err\+: Bit Dominant Error
\item C\+A\+N\+\_\+\+E\+R\+R\+O\+R\+C\+O\+D\+E\+\_\+\+C\+R\+C\+Err\+: C\+RC Error
\item C\+A\+N\+\_\+\+E\+R\+R\+O\+R\+C\+O\+D\+E\+\_\+\+Software\+Set\+Err\+: Software Set Error 
\end{DoxyItemize}\\
\hline
\end{DoxyRetVals}


Definition at line \textbf{ 1035} of file \textbf{ stm32f4xx\+\_\+can.\+c}.


\begin{DoxyCode}
01036 \{
01037   uint8\_t errorcode=0;
01038   
01039   \textcolor{comment}{/* Check the parameters */}
01040   assert_param(IS_CAN_ALL_PERIPH(CANx));
01041   
01042   \textcolor{comment}{/* Get the error code*/}
01043   errorcode = (((uint8\_t)CANx->ESR) & (uint8\_t)CAN_ESR_LEC);
01044   
01045   \textcolor{comment}{/* Return the error code*/}
01046   \textcolor{keywordflow}{return} errorcode;
01047 \}
\end{DoxyCode}
\mbox{\label{group__CAN__Group5_ga85ee0c35bf7ca15d4e4c862eef534843}} 
\index{C\+A\+N Bus Error management functions@{C\+A\+N Bus Error management functions}!C\+A\+N\+\_\+\+Get\+L\+S\+B\+Transmit\+Error\+Counter@{C\+A\+N\+\_\+\+Get\+L\+S\+B\+Transmit\+Error\+Counter}}
\index{C\+A\+N\+\_\+\+Get\+L\+S\+B\+Transmit\+Error\+Counter@{C\+A\+N\+\_\+\+Get\+L\+S\+B\+Transmit\+Error\+Counter}!C\+A\+N Bus Error management functions@{C\+A\+N Bus Error management functions}}
\subsubsection{C\+A\+N\+\_\+\+Get\+L\+S\+B\+Transmit\+Error\+Counter()}
{\footnotesize\ttfamily uint8\+\_\+t C\+A\+N\+\_\+\+Get\+L\+S\+B\+Transmit\+Error\+Counter (\begin{DoxyParamCaption}\item[{\textbf{ C\+A\+N\+\_\+\+Type\+Def} $\ast$}]{C\+A\+Nx }\end{DoxyParamCaption})}



Returns the L\+SB of the 9-\/bit C\+A\+Nx Transmit Error Counter(\+T\+E\+C). 


\begin{DoxyParams}{Parameters}
{\em C\+A\+Nx} & where x can be 1 or 2 to to select the C\+AN peripheral. \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em L\+SB} & of the 9-\/bit C\+AN Transmit Error Counter. \\
\hline
\end{DoxyRetVals}


Definition at line \textbf{ 1080} of file \textbf{ stm32f4xx\+\_\+can.\+c}.


\begin{DoxyCode}
01081 \{
01082   uint8\_t counter=0;
01083   
01084   \textcolor{comment}{/* Check the parameters */}
01085   assert_param(IS_CAN_ALL_PERIPH(CANx));
01086   
01087   \textcolor{comment}{/* Get the LSB of the 9-bit CANx Transmit Error Counter(TEC) */}
01088   counter = (uint8\_t)((CANx->ESR & CAN_ESR_TEC)>> 16);
01089   
01090   \textcolor{comment}{/* Return the LSB of the 9-bit CANx Transmit Error Counter(TEC) */}
01091   \textcolor{keywordflow}{return} counter;
01092 \}
\end{DoxyCode}
\mbox{\label{group__CAN__Group5_ga6903eecbec40eb1361d915ddde9a3274}} 
\index{C\+A\+N Bus Error management functions@{C\+A\+N Bus Error management functions}!C\+A\+N\+\_\+\+Get\+Receive\+Error\+Counter@{C\+A\+N\+\_\+\+Get\+Receive\+Error\+Counter}}
\index{C\+A\+N\+\_\+\+Get\+Receive\+Error\+Counter@{C\+A\+N\+\_\+\+Get\+Receive\+Error\+Counter}!C\+A\+N Bus Error management functions@{C\+A\+N Bus Error management functions}}
\subsubsection{C\+A\+N\+\_\+\+Get\+Receive\+Error\+Counter()}
{\footnotesize\ttfamily uint8\+\_\+t C\+A\+N\+\_\+\+Get\+Receive\+Error\+Counter (\begin{DoxyParamCaption}\item[{\textbf{ C\+A\+N\+\_\+\+Type\+Def} $\ast$}]{C\+A\+Nx }\end{DoxyParamCaption})}



Returns the C\+A\+Nx Receive Error Counter (R\+EC). 

\begin{DoxyNote}{Note}
In case of an error during reception, this counter is incremented by 1 or by 8 depending on the error condition as defined by the C\+AN standard. After every successful reception, the counter is decremented by 1 or reset to 120 if its value was higher than 128. When the counter value exceeds 127, the C\+AN controller enters the error passive state. 
\end{DoxyNote}

\begin{DoxyParams}{Parameters}
{\em C\+A\+Nx} & where x can be 1 or 2 to to select the C\+AN peripheral. \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em C\+AN} & Receive Error Counter. \\
\hline
\end{DoxyRetVals}


Definition at line \textbf{ 1060} of file \textbf{ stm32f4xx\+\_\+can.\+c}.


\begin{DoxyCode}
01061 \{
01062   uint8\_t counter=0;
01063   
01064   \textcolor{comment}{/* Check the parameters */}
01065   assert_param(IS_CAN_ALL_PERIPH(CANx));
01066   
01067   \textcolor{comment}{/* Get the Receive Error Counter*/}
01068   counter = (uint8\_t)((CANx->ESR & CAN_ESR_REC)>> 24);
01069   
01070   \textcolor{comment}{/* Return the Receive Error Counter*/}
01071   \textcolor{keywordflow}{return} counter;
01072 \}
\end{DoxyCode}
