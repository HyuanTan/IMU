\section{C\+AN}
\label{group__CAN}\index{C\+AN@{C\+AN}}


C\+AN driver modules.  


\subsection*{Modules}
\begin{DoxyCompactItemize}
\item 
\textbf{ C\+A\+N\+\_\+\+Exported\+\_\+\+Constants}
\item 
\textbf{ C\+A\+N\+\_\+\+Private\+\_\+\+Functions}
\end{DoxyCompactItemize}
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \textbf{ C\+A\+N\+\_\+\+Init\+Type\+Def}
\begin{DoxyCompactList}\small\item\em C\+AN init structure definition. \end{DoxyCompactList}\item 
struct \textbf{ C\+A\+N\+\_\+\+Filter\+Init\+Type\+Def}
\begin{DoxyCompactList}\small\item\em C\+AN filter init structure definition. \end{DoxyCompactList}\item 
struct \textbf{ Can\+Tx\+Msg}
\begin{DoxyCompactList}\small\item\em C\+AN Tx message structure definition. \end{DoxyCompactList}\item 
struct \textbf{ Can\+Rx\+Msg}
\begin{DoxyCompactList}\small\item\em C\+AN Rx message structure definition. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \textbf{ M\+C\+R\+\_\+\+D\+BF}~((uint32\+\_\+t)0x00010000) /$\ast$ software master reset $\ast$/
\item 
\#define \textbf{ T\+M\+I\+Dx\+R\+\_\+\+T\+X\+RQ}~((uint32\+\_\+t)0x00000001) /$\ast$ Transmit mailbox request $\ast$/
\item 
\#define \textbf{ F\+M\+R\+\_\+\+F\+I\+N\+IT}~((uint32\+\_\+t)0x00000001) /$\ast$ Filter init mode $\ast$/
\item 
\#define \textbf{ I\+N\+A\+K\+\_\+\+T\+I\+M\+E\+O\+UT}~((uint32\+\_\+t)0x0000\+F\+F\+F\+F)
\item 
\#define \textbf{ S\+L\+A\+K\+\_\+\+T\+I\+M\+E\+O\+UT}~((uint32\+\_\+t)0x0000\+F\+F\+F\+F)
\item 
\#define \textbf{ C\+A\+N\+\_\+\+F\+L\+A\+G\+S\+\_\+\+T\+SR}~((uint32\+\_\+t)0x08000000)
\item 
\#define \textbf{ C\+A\+N\+\_\+\+F\+L\+A\+G\+S\+\_\+\+R\+F1R}~((uint32\+\_\+t)0x04000000)
\item 
\#define \textbf{ C\+A\+N\+\_\+\+F\+L\+A\+G\+S\+\_\+\+R\+F0R}~((uint32\+\_\+t)0x02000000)
\item 
\#define \textbf{ C\+A\+N\+\_\+\+F\+L\+A\+G\+S\+\_\+\+M\+SR}~((uint32\+\_\+t)0x01000000)
\item 
\#define \textbf{ C\+A\+N\+\_\+\+F\+L\+A\+G\+S\+\_\+\+E\+SR}~((uint32\+\_\+t)0x00\+F00000)
\item 
\#define \textbf{ C\+A\+N\+\_\+\+T\+X\+M\+A\+I\+L\+B\+O\+X\+\_\+0}~((uint8\+\_\+t)0x00)
\item 
\#define \textbf{ C\+A\+N\+\_\+\+T\+X\+M\+A\+I\+L\+B\+O\+X\+\_\+1}~((uint8\+\_\+t)0x01)
\item 
\#define \textbf{ C\+A\+N\+\_\+\+T\+X\+M\+A\+I\+L\+B\+O\+X\+\_\+2}~((uint8\+\_\+t)0x02)
\item 
\#define \textbf{ C\+A\+N\+\_\+\+M\+O\+D\+E\+\_\+\+M\+A\+SK}~((uint32\+\_\+t) 0x00000003)
\item 
\#define \textbf{ I\+S\+\_\+\+C\+A\+N\+\_\+\+A\+L\+L\+\_\+\+P\+E\+R\+I\+PH}(P\+E\+R\+I\+PH)
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \textbf{ C\+A\+N\+\_\+\+De\+Init} (\textbf{ C\+A\+N\+\_\+\+Type\+Def} $\ast$C\+A\+Nx)
\begin{DoxyCompactList}\small\item\em Deinitializes the C\+AN peripheral registers to their default reset values. \end{DoxyCompactList}\item 
uint8\+\_\+t \textbf{ C\+A\+N\+\_\+\+Init} (\textbf{ C\+A\+N\+\_\+\+Type\+Def} $\ast$C\+A\+Nx, \textbf{ C\+A\+N\+\_\+\+Init\+Type\+Def} $\ast$C\+A\+N\+\_\+\+Init\+Struct)
\begin{DoxyCompactList}\small\item\em Initializes the C\+AN peripheral according to the specified parameters in the C\+A\+N\+\_\+\+Init\+Struct. \end{DoxyCompactList}\item 
void \textbf{ C\+A\+N\+\_\+\+Filter\+Init} (\textbf{ C\+A\+N\+\_\+\+Filter\+Init\+Type\+Def} $\ast$C\+A\+N\+\_\+\+Filter\+Init\+Struct)
\begin{DoxyCompactList}\small\item\em Configures the C\+AN reception filter according to the specified parameters in the C\+A\+N\+\_\+\+Filter\+Init\+Struct. \end{DoxyCompactList}\item 
void \textbf{ C\+A\+N\+\_\+\+Struct\+Init} (\textbf{ C\+A\+N\+\_\+\+Init\+Type\+Def} $\ast$C\+A\+N\+\_\+\+Init\+Struct)
\begin{DoxyCompactList}\small\item\em Fills each C\+A\+N\+\_\+\+Init\+Struct member with its default value. \end{DoxyCompactList}\item 
void \textbf{ C\+A\+N\+\_\+\+Slave\+Start\+Bank} (uint8\+\_\+t C\+A\+N\+\_\+\+Bank\+Number)
\begin{DoxyCompactList}\small\item\em Select the start bank filter for slave C\+AN. \end{DoxyCompactList}\item 
void \textbf{ C\+A\+N\+\_\+\+D\+B\+G\+Freeze} (\textbf{ C\+A\+N\+\_\+\+Type\+Def} $\ast$C\+A\+Nx, \textbf{ Functional\+State} New\+State)
\begin{DoxyCompactList}\small\item\em Enables or disables the D\+BG Freeze for C\+AN. \end{DoxyCompactList}\item 
void \textbf{ C\+A\+N\+\_\+\+T\+T\+Com\+Mode\+Cmd} (\textbf{ C\+A\+N\+\_\+\+Type\+Def} $\ast$C\+A\+Nx, \textbf{ Functional\+State} New\+State)
\begin{DoxyCompactList}\small\item\em Enables or disables the C\+AN Time Trigger\+Operation communication mode. \end{DoxyCompactList}\item 
uint8\+\_\+t \textbf{ C\+A\+N\+\_\+\+Transmit} (\textbf{ C\+A\+N\+\_\+\+Type\+Def} $\ast$C\+A\+Nx, \textbf{ Can\+Tx\+Msg} $\ast$Tx\+Message)
\begin{DoxyCompactList}\small\item\em Initiates and transmits a C\+AN frame message. \end{DoxyCompactList}\item 
uint8\+\_\+t \textbf{ C\+A\+N\+\_\+\+Transmit\+Status} (\textbf{ C\+A\+N\+\_\+\+Type\+Def} $\ast$C\+A\+Nx, uint8\+\_\+t Transmit\+Mailbox)
\begin{DoxyCompactList}\small\item\em Checks the transmission status of a C\+AN Frame. \end{DoxyCompactList}\item 
void \textbf{ C\+A\+N\+\_\+\+Cancel\+Transmit} (\textbf{ C\+A\+N\+\_\+\+Type\+Def} $\ast$C\+A\+Nx, uint8\+\_\+t Mailbox)
\begin{DoxyCompactList}\small\item\em Cancels a transmit request. \end{DoxyCompactList}\item 
void \textbf{ C\+A\+N\+\_\+\+Receive} (\textbf{ C\+A\+N\+\_\+\+Type\+Def} $\ast$C\+A\+Nx, uint8\+\_\+t F\+I\+F\+O\+Number, \textbf{ Can\+Rx\+Msg} $\ast$Rx\+Message)
\begin{DoxyCompactList}\small\item\em Receives a correct C\+AN frame. \end{DoxyCompactList}\item 
void \textbf{ C\+A\+N\+\_\+\+F\+I\+F\+O\+Release} (\textbf{ C\+A\+N\+\_\+\+Type\+Def} $\ast$C\+A\+Nx, uint8\+\_\+t F\+I\+F\+O\+Number)
\begin{DoxyCompactList}\small\item\em Releases the specified receive F\+I\+FO. \end{DoxyCompactList}\item 
uint8\+\_\+t \textbf{ C\+A\+N\+\_\+\+Message\+Pending} (\textbf{ C\+A\+N\+\_\+\+Type\+Def} $\ast$C\+A\+Nx, uint8\+\_\+t F\+I\+F\+O\+Number)
\begin{DoxyCompactList}\small\item\em Returns the number of pending received messages. \end{DoxyCompactList}\item 
uint8\+\_\+t \textbf{ C\+A\+N\+\_\+\+Operating\+Mode\+Request} (\textbf{ C\+A\+N\+\_\+\+Type\+Def} $\ast$C\+A\+Nx, uint8\+\_\+t C\+A\+N\+\_\+\+Operating\+Mode)
\begin{DoxyCompactList}\small\item\em Selects the C\+AN Operation mode. \end{DoxyCompactList}\item 
uint8\+\_\+t \textbf{ C\+A\+N\+\_\+\+Sleep} (\textbf{ C\+A\+N\+\_\+\+Type\+Def} $\ast$C\+A\+Nx)
\begin{DoxyCompactList}\small\item\em Enters the Sleep (low power) mode. \end{DoxyCompactList}\item 
uint8\+\_\+t \textbf{ C\+A\+N\+\_\+\+Wake\+Up} (\textbf{ C\+A\+N\+\_\+\+Type\+Def} $\ast$C\+A\+Nx)
\begin{DoxyCompactList}\small\item\em Wakes up the C\+AN peripheral from sleep mode . \end{DoxyCompactList}\item 
uint8\+\_\+t \textbf{ C\+A\+N\+\_\+\+Get\+Last\+Error\+Code} (\textbf{ C\+A\+N\+\_\+\+Type\+Def} $\ast$C\+A\+Nx)
\begin{DoxyCompactList}\small\item\em Returns the C\+A\+Nx\textquotesingle{}s last error code (L\+EC). \end{DoxyCompactList}\item 
uint8\+\_\+t \textbf{ C\+A\+N\+\_\+\+Get\+Receive\+Error\+Counter} (\textbf{ C\+A\+N\+\_\+\+Type\+Def} $\ast$C\+A\+Nx)
\begin{DoxyCompactList}\small\item\em Returns the C\+A\+Nx Receive Error Counter (R\+EC). \end{DoxyCompactList}\item 
uint8\+\_\+t \textbf{ C\+A\+N\+\_\+\+Get\+L\+S\+B\+Transmit\+Error\+Counter} (\textbf{ C\+A\+N\+\_\+\+Type\+Def} $\ast$C\+A\+Nx)
\begin{DoxyCompactList}\small\item\em Returns the L\+SB of the 9-\/bit C\+A\+Nx Transmit Error Counter(\+T\+E\+C). \end{DoxyCompactList}\item 
void \textbf{ C\+A\+N\+\_\+\+I\+T\+Config} (\textbf{ C\+A\+N\+\_\+\+Type\+Def} $\ast$C\+A\+Nx, uint32\+\_\+t C\+A\+N\+\_\+\+IT, \textbf{ Functional\+State} New\+State)
\begin{DoxyCompactList}\small\item\em Enables or disables the specified C\+A\+Nx interrupts. \end{DoxyCompactList}\item 
\textbf{ Flag\+Status} \textbf{ C\+A\+N\+\_\+\+Get\+Flag\+Status} (\textbf{ C\+A\+N\+\_\+\+Type\+Def} $\ast$C\+A\+Nx, uint32\+\_\+t C\+A\+N\+\_\+\+F\+L\+AG)
\begin{DoxyCompactList}\small\item\em Checks whether the specified C\+AN flag is set or not. \end{DoxyCompactList}\item 
void \textbf{ C\+A\+N\+\_\+\+Clear\+Flag} (\textbf{ C\+A\+N\+\_\+\+Type\+Def} $\ast$C\+A\+Nx, uint32\+\_\+t C\+A\+N\+\_\+\+F\+L\+AG)
\begin{DoxyCompactList}\small\item\em Clears the C\+AN\textquotesingle{}s pending flags. \end{DoxyCompactList}\item 
\textbf{ I\+T\+Status} \textbf{ C\+A\+N\+\_\+\+Get\+I\+T\+Status} (\textbf{ C\+A\+N\+\_\+\+Type\+Def} $\ast$C\+A\+Nx, uint32\+\_\+t C\+A\+N\+\_\+\+IT)
\begin{DoxyCompactList}\small\item\em Checks whether the specified C\+A\+Nx interrupt has occurred or not. \end{DoxyCompactList}\item 
void \textbf{ C\+A\+N\+\_\+\+Clear\+I\+T\+Pending\+Bit} (\textbf{ C\+A\+N\+\_\+\+Type\+Def} $\ast$C\+A\+Nx, uint32\+\_\+t C\+A\+N\+\_\+\+IT)
\begin{DoxyCompactList}\small\item\em Clears the C\+A\+Nx\textquotesingle{}s interrupt pending bits. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
C\+AN driver modules. 



\subsection{Macro Definition Documentation}
\mbox{\label{group__CAN_ga14f7bb0b320da21443c9bd60b1f86b5d}} 
\index{C\+AN@{C\+AN}!C\+A\+N\+\_\+\+F\+L\+A\+G\+S\+\_\+\+E\+SR@{C\+A\+N\+\_\+\+F\+L\+A\+G\+S\+\_\+\+E\+SR}}
\index{C\+A\+N\+\_\+\+F\+L\+A\+G\+S\+\_\+\+E\+SR@{C\+A\+N\+\_\+\+F\+L\+A\+G\+S\+\_\+\+E\+SR}!C\+AN@{C\+AN}}
\subsubsection{C\+A\+N\+\_\+\+F\+L\+A\+G\+S\+\_\+\+E\+SR}
{\footnotesize\ttfamily \#define C\+A\+N\+\_\+\+F\+L\+A\+G\+S\+\_\+\+E\+SR~((uint32\+\_\+t)0x00\+F00000)}



Definition at line \textbf{ 117} of file \textbf{ stm32f4xx\+\_\+can.\+c}.

\mbox{\label{group__CAN_ga3aaa7df395ce1a90cb6e2ff3d2c4b24e}} 
\index{C\+AN@{C\+AN}!C\+A\+N\+\_\+\+F\+L\+A\+G\+S\+\_\+\+M\+SR@{C\+A\+N\+\_\+\+F\+L\+A\+G\+S\+\_\+\+M\+SR}}
\index{C\+A\+N\+\_\+\+F\+L\+A\+G\+S\+\_\+\+M\+SR@{C\+A\+N\+\_\+\+F\+L\+A\+G\+S\+\_\+\+M\+SR}!C\+AN@{C\+AN}}
\subsubsection{C\+A\+N\+\_\+\+F\+L\+A\+G\+S\+\_\+\+M\+SR}
{\footnotesize\ttfamily \#define C\+A\+N\+\_\+\+F\+L\+A\+G\+S\+\_\+\+M\+SR~((uint32\+\_\+t)0x01000000)}



Definition at line \textbf{ 115} of file \textbf{ stm32f4xx\+\_\+can.\+c}.

\mbox{\label{group__CAN_ga4b22b2552759778ac07825240823a45f}} 
\index{C\+AN@{C\+AN}!C\+A\+N\+\_\+\+F\+L\+A\+G\+S\+\_\+\+R\+F0R@{C\+A\+N\+\_\+\+F\+L\+A\+G\+S\+\_\+\+R\+F0R}}
\index{C\+A\+N\+\_\+\+F\+L\+A\+G\+S\+\_\+\+R\+F0R@{C\+A\+N\+\_\+\+F\+L\+A\+G\+S\+\_\+\+R\+F0R}!C\+AN@{C\+AN}}
\subsubsection{C\+A\+N\+\_\+\+F\+L\+A\+G\+S\+\_\+\+R\+F0R}
{\footnotesize\ttfamily \#define C\+A\+N\+\_\+\+F\+L\+A\+G\+S\+\_\+\+R\+F0R~((uint32\+\_\+t)0x02000000)}



Definition at line \textbf{ 113} of file \textbf{ stm32f4xx\+\_\+can.\+c}.

\mbox{\label{group__CAN_ga2a03d73273ab353c8deb3a4730431977}} 
\index{C\+AN@{C\+AN}!C\+A\+N\+\_\+\+F\+L\+A\+G\+S\+\_\+\+R\+F1R@{C\+A\+N\+\_\+\+F\+L\+A\+G\+S\+\_\+\+R\+F1R}}
\index{C\+A\+N\+\_\+\+F\+L\+A\+G\+S\+\_\+\+R\+F1R@{C\+A\+N\+\_\+\+F\+L\+A\+G\+S\+\_\+\+R\+F1R}!C\+AN@{C\+AN}}
\subsubsection{C\+A\+N\+\_\+\+F\+L\+A\+G\+S\+\_\+\+R\+F1R}
{\footnotesize\ttfamily \#define C\+A\+N\+\_\+\+F\+L\+A\+G\+S\+\_\+\+R\+F1R~((uint32\+\_\+t)0x04000000)}



Definition at line \textbf{ 111} of file \textbf{ stm32f4xx\+\_\+can.\+c}.

\mbox{\label{group__CAN_gac67e7d905ba11441bf9e14180805cf3a}} 
\index{C\+AN@{C\+AN}!C\+A\+N\+\_\+\+F\+L\+A\+G\+S\+\_\+\+T\+SR@{C\+A\+N\+\_\+\+F\+L\+A\+G\+S\+\_\+\+T\+SR}}
\index{C\+A\+N\+\_\+\+F\+L\+A\+G\+S\+\_\+\+T\+SR@{C\+A\+N\+\_\+\+F\+L\+A\+G\+S\+\_\+\+T\+SR}!C\+AN@{C\+AN}}
\subsubsection{C\+A\+N\+\_\+\+F\+L\+A\+G\+S\+\_\+\+T\+SR}
{\footnotesize\ttfamily \#define C\+A\+N\+\_\+\+F\+L\+A\+G\+S\+\_\+\+T\+SR~((uint32\+\_\+t)0x08000000)}



Definition at line \textbf{ 109} of file \textbf{ stm32f4xx\+\_\+can.\+c}.

\mbox{\label{group__CAN_ga79094ce5a3a2f717140e8cc9b7c161b6}} 
\index{C\+AN@{C\+AN}!C\+A\+N\+\_\+\+M\+O\+D\+E\+\_\+\+M\+A\+SK@{C\+A\+N\+\_\+\+M\+O\+D\+E\+\_\+\+M\+A\+SK}}
\index{C\+A\+N\+\_\+\+M\+O\+D\+E\+\_\+\+M\+A\+SK@{C\+A\+N\+\_\+\+M\+O\+D\+E\+\_\+\+M\+A\+SK}!C\+AN@{C\+AN}}
\subsubsection{C\+A\+N\+\_\+\+M\+O\+D\+E\+\_\+\+M\+A\+SK}
{\footnotesize\ttfamily \#define C\+A\+N\+\_\+\+M\+O\+D\+E\+\_\+\+M\+A\+SK~((uint32\+\_\+t) 0x00000003)}



Definition at line \textbf{ 124} of file \textbf{ stm32f4xx\+\_\+can.\+c}.

\mbox{\label{group__CAN_gaa62f09d0693681cb7576f61c93b7cf0f}} 
\index{C\+AN@{C\+AN}!C\+A\+N\+\_\+\+T\+X\+M\+A\+I\+L\+B\+O\+X\+\_\+0@{C\+A\+N\+\_\+\+T\+X\+M\+A\+I\+L\+B\+O\+X\+\_\+0}}
\index{C\+A\+N\+\_\+\+T\+X\+M\+A\+I\+L\+B\+O\+X\+\_\+0@{C\+A\+N\+\_\+\+T\+X\+M\+A\+I\+L\+B\+O\+X\+\_\+0}!C\+AN@{C\+AN}}
\subsubsection{C\+A\+N\+\_\+\+T\+X\+M\+A\+I\+L\+B\+O\+X\+\_\+0}
{\footnotesize\ttfamily \#define C\+A\+N\+\_\+\+T\+X\+M\+A\+I\+L\+B\+O\+X\+\_\+0~((uint8\+\_\+t)0x00)}



Definition at line \textbf{ 120} of file \textbf{ stm32f4xx\+\_\+can.\+c}.

\mbox{\label{group__CAN_ga4e20f0aac1ac940014a6c66971890943}} 
\index{C\+AN@{C\+AN}!C\+A\+N\+\_\+\+T\+X\+M\+A\+I\+L\+B\+O\+X\+\_\+1@{C\+A\+N\+\_\+\+T\+X\+M\+A\+I\+L\+B\+O\+X\+\_\+1}}
\index{C\+A\+N\+\_\+\+T\+X\+M\+A\+I\+L\+B\+O\+X\+\_\+1@{C\+A\+N\+\_\+\+T\+X\+M\+A\+I\+L\+B\+O\+X\+\_\+1}!C\+AN@{C\+AN}}
\subsubsection{C\+A\+N\+\_\+\+T\+X\+M\+A\+I\+L\+B\+O\+X\+\_\+1}
{\footnotesize\ttfamily \#define C\+A\+N\+\_\+\+T\+X\+M\+A\+I\+L\+B\+O\+X\+\_\+1~((uint8\+\_\+t)0x01)}



Definition at line \textbf{ 121} of file \textbf{ stm32f4xx\+\_\+can.\+c}.

\mbox{\label{group__CAN_ga8a842aa352d72321930cc963b26bf6d7}} 
\index{C\+AN@{C\+AN}!C\+A\+N\+\_\+\+T\+X\+M\+A\+I\+L\+B\+O\+X\+\_\+2@{C\+A\+N\+\_\+\+T\+X\+M\+A\+I\+L\+B\+O\+X\+\_\+2}}
\index{C\+A\+N\+\_\+\+T\+X\+M\+A\+I\+L\+B\+O\+X\+\_\+2@{C\+A\+N\+\_\+\+T\+X\+M\+A\+I\+L\+B\+O\+X\+\_\+2}!C\+AN@{C\+AN}}
\subsubsection{C\+A\+N\+\_\+\+T\+X\+M\+A\+I\+L\+B\+O\+X\+\_\+2}
{\footnotesize\ttfamily \#define C\+A\+N\+\_\+\+T\+X\+M\+A\+I\+L\+B\+O\+X\+\_\+2~((uint8\+\_\+t)0x02)}



Definition at line \textbf{ 122} of file \textbf{ stm32f4xx\+\_\+can.\+c}.

\mbox{\label{group__CAN_ga6125d0273c466e402db1a8f5bf888857}} 
\index{C\+AN@{C\+AN}!F\+M\+R\+\_\+\+F\+I\+N\+IT@{F\+M\+R\+\_\+\+F\+I\+N\+IT}}
\index{F\+M\+R\+\_\+\+F\+I\+N\+IT@{F\+M\+R\+\_\+\+F\+I\+N\+IT}!C\+AN@{C\+AN}}
\subsubsection{F\+M\+R\+\_\+\+F\+I\+N\+IT}
{\footnotesize\ttfamily \#define F\+M\+R\+\_\+\+F\+I\+N\+IT~((uint32\+\_\+t)0x00000001) /$\ast$ Filter init mode $\ast$/}



Definition at line \textbf{ 101} of file \textbf{ stm32f4xx\+\_\+can.\+c}.

\mbox{\label{group__CAN_ga60a32132df242146efd3e9f7a079f0f0}} 
\index{C\+AN@{C\+AN}!I\+N\+A\+K\+\_\+\+T\+I\+M\+E\+O\+UT@{I\+N\+A\+K\+\_\+\+T\+I\+M\+E\+O\+UT}}
\index{I\+N\+A\+K\+\_\+\+T\+I\+M\+E\+O\+UT@{I\+N\+A\+K\+\_\+\+T\+I\+M\+E\+O\+UT}!C\+AN@{C\+AN}}
\subsubsection{I\+N\+A\+K\+\_\+\+T\+I\+M\+E\+O\+UT}
{\footnotesize\ttfamily \#define I\+N\+A\+K\+\_\+\+T\+I\+M\+E\+O\+UT~((uint32\+\_\+t)0x0000\+F\+F\+F\+F)}



Definition at line \textbf{ 104} of file \textbf{ stm32f4xx\+\_\+can.\+c}.

\mbox{\label{group__CAN_gaf471a53f52a02078ffd842658d932f63}} 
\index{C\+AN@{C\+AN}!I\+S\+\_\+\+C\+A\+N\+\_\+\+A\+L\+L\+\_\+\+P\+E\+R\+I\+PH@{I\+S\+\_\+\+C\+A\+N\+\_\+\+A\+L\+L\+\_\+\+P\+E\+R\+I\+PH}}
\index{I\+S\+\_\+\+C\+A\+N\+\_\+\+A\+L\+L\+\_\+\+P\+E\+R\+I\+PH@{I\+S\+\_\+\+C\+A\+N\+\_\+\+A\+L\+L\+\_\+\+P\+E\+R\+I\+PH}!C\+AN@{C\+AN}}
\subsubsection{I\+S\+\_\+\+C\+A\+N\+\_\+\+A\+L\+L\+\_\+\+P\+E\+R\+I\+PH}
{\footnotesize\ttfamily \#define I\+S\+\_\+\+C\+A\+N\+\_\+\+A\+L\+L\+\_\+\+P\+E\+R\+I\+PH(\begin{DoxyParamCaption}\item[{}]{P\+E\+R\+I\+PH }\end{DoxyParamCaption})}

{\bfseries Value\+:}
\begin{DoxyCode}
(((PERIPH) == CAN1) || \(\backslash\)
                                   ((PERIPH) == CAN2))
\end{DoxyCode}


Definition at line \textbf{ 44} of file \textbf{ stm32f4xx\+\_\+can.\+h}.

\mbox{\label{group__CAN_ga1ded3736beb63c49281f2983fc68c36d}} 
\index{C\+AN@{C\+AN}!M\+C\+R\+\_\+\+D\+BF@{M\+C\+R\+\_\+\+D\+BF}}
\index{M\+C\+R\+\_\+\+D\+BF@{M\+C\+R\+\_\+\+D\+BF}!C\+AN@{C\+AN}}
\subsubsection{M\+C\+R\+\_\+\+D\+BF}
{\footnotesize\ttfamily \#define M\+C\+R\+\_\+\+D\+BF~((uint32\+\_\+t)0x00010000) /$\ast$ software master reset $\ast$/}



Definition at line \textbf{ 95} of file \textbf{ stm32f4xx\+\_\+can.\+c}.

\mbox{\label{group__CAN_ga1bb8107706c8b4039ac55a122f3c65bb}} 
\index{C\+AN@{C\+AN}!S\+L\+A\+K\+\_\+\+T\+I\+M\+E\+O\+UT@{S\+L\+A\+K\+\_\+\+T\+I\+M\+E\+O\+UT}}
\index{S\+L\+A\+K\+\_\+\+T\+I\+M\+E\+O\+UT@{S\+L\+A\+K\+\_\+\+T\+I\+M\+E\+O\+UT}!C\+AN@{C\+AN}}
\subsubsection{S\+L\+A\+K\+\_\+\+T\+I\+M\+E\+O\+UT}
{\footnotesize\ttfamily \#define S\+L\+A\+K\+\_\+\+T\+I\+M\+E\+O\+UT~((uint32\+\_\+t)0x0000\+F\+F\+F\+F)}



Definition at line \textbf{ 106} of file \textbf{ stm32f4xx\+\_\+can.\+c}.

\mbox{\label{group__CAN_gabeb6db5ba5c01da5084ec1605f868e18}} 
\index{C\+AN@{C\+AN}!T\+M\+I\+Dx\+R\+\_\+\+T\+X\+RQ@{T\+M\+I\+Dx\+R\+\_\+\+T\+X\+RQ}}
\index{T\+M\+I\+Dx\+R\+\_\+\+T\+X\+RQ@{T\+M\+I\+Dx\+R\+\_\+\+T\+X\+RQ}!C\+AN@{C\+AN}}
\subsubsection{T\+M\+I\+Dx\+R\+\_\+\+T\+X\+RQ}
{\footnotesize\ttfamily \#define T\+M\+I\+Dx\+R\+\_\+\+T\+X\+RQ~((uint32\+\_\+t)0x00000001) /$\ast$ Transmit mailbox request $\ast$/}



Definition at line \textbf{ 98} of file \textbf{ stm32f4xx\+\_\+can.\+c}.



\subsection{Function Documentation}
\mbox{\label{group__CAN_ga81106cdf5395a1947bfc87ec1685829e}} 
\index{C\+AN@{C\+AN}!C\+A\+N\+\_\+\+Cancel\+Transmit@{C\+A\+N\+\_\+\+Cancel\+Transmit}}
\index{C\+A\+N\+\_\+\+Cancel\+Transmit@{C\+A\+N\+\_\+\+Cancel\+Transmit}!C\+AN@{C\+AN}}
\subsubsection{C\+A\+N\+\_\+\+Cancel\+Transmit()}
{\footnotesize\ttfamily void C\+A\+N\+\_\+\+Cancel\+Transmit (\begin{DoxyParamCaption}\item[{\textbf{ C\+A\+N\+\_\+\+Type\+Def} $\ast$}]{C\+A\+Nx,  }\item[{uint8\+\_\+t}]{Mailbox }\end{DoxyParamCaption})}



Cancels a transmit request. 


\begin{DoxyParams}{Parameters}
{\em C\+A\+Nx} & where x can be 1 or 2 to select the C\+AN peripheral. \\
\hline
{\em Mailbox} & Mailbox number. \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em None} & \\
\hline
\end{DoxyRetVals}


Definition at line \textbf{ 698} of file \textbf{ stm32f4xx\+\_\+can.\+c}.


\begin{DoxyCode}
00699 \{
00700   \textcolor{comment}{/* Check the parameters */}
00701   assert_param(IS_CAN_ALL_PERIPH(CANx));
00702   assert_param(IS_CAN_TRANSMITMAILBOX(Mailbox));
00703   \textcolor{comment}{/* abort transmission */}
00704   \textcolor{keywordflow}{switch} (Mailbox)
00705   \{
00706     \textcolor{keywordflow}{case} (CAN_TXMAILBOX_0): CANx->TSR |= CAN_TSR_ABRQ0;
00707       \textcolor{keywordflow}{break};
00708     \textcolor{keywordflow}{case} (CAN_TXMAILBOX_1): CANx->TSR |= CAN_TSR_ABRQ1;
00709       \textcolor{keywordflow}{break};
00710     \textcolor{keywordflow}{case} (CAN_TXMAILBOX_2): CANx->TSR |= CAN_TSR_ABRQ2;
00711       \textcolor{keywordflow}{break};
00712     \textcolor{keywordflow}{default}:
00713       \textcolor{keywordflow}{break};
00714   \}
00715 \}
\end{DoxyCode}
\mbox{\label{group__CAN_ga2c01646d5d3a2d7045e8dd71f58f8742}} 
\index{C\+AN@{C\+AN}!C\+A\+N\+\_\+\+Clear\+Flag@{C\+A\+N\+\_\+\+Clear\+Flag}}
\index{C\+A\+N\+\_\+\+Clear\+Flag@{C\+A\+N\+\_\+\+Clear\+Flag}!C\+AN@{C\+AN}}
\subsubsection{C\+A\+N\+\_\+\+Clear\+Flag()}
{\footnotesize\ttfamily void C\+A\+N\+\_\+\+Clear\+Flag (\begin{DoxyParamCaption}\item[{\textbf{ C\+A\+N\+\_\+\+Type\+Def} $\ast$}]{C\+A\+Nx,  }\item[{uint32\+\_\+t}]{C\+A\+N\+\_\+\+F\+L\+AG }\end{DoxyParamCaption})}



Clears the C\+AN\textquotesingle{}s pending flags. 


\begin{DoxyParams}{Parameters}
{\em C\+A\+Nx} & where x can be 1 or 2 to to select the C\+AN peripheral. \\
\hline
{\em C\+A\+N\+\_\+\+F\+L\+AG} & specifies the flag to clear. This parameter can be one of the following values\+: \begin{DoxyItemize}
\item C\+A\+N\+\_\+\+F\+L\+A\+G\+\_\+\+R\+Q\+C\+P0\+: Request Mail\+Box0 Flag \item C\+A\+N\+\_\+\+F\+L\+A\+G\+\_\+\+R\+Q\+C\+P1\+: Request Mail\+Box1 Flag \item C\+A\+N\+\_\+\+F\+L\+A\+G\+\_\+\+R\+Q\+C\+P2\+: Request Mail\+Box2 Flag \item C\+A\+N\+\_\+\+F\+L\+A\+G\+\_\+\+F\+F0\+: F\+I\+FO 0 Full Flag \item C\+A\+N\+\_\+\+F\+L\+A\+G\+\_\+\+F\+O\+V0\+: F\+I\+FO 0 Overrun Flag \item C\+A\+N\+\_\+\+F\+L\+A\+G\+\_\+\+F\+F1\+: F\+I\+FO 1 Full Flag \item C\+A\+N\+\_\+\+F\+L\+A\+G\+\_\+\+F\+O\+V1\+: F\+I\+FO 1 Overrun Flag \item C\+A\+N\+\_\+\+F\+L\+A\+G\+\_\+\+W\+KU\+: Wake up Flag \item C\+A\+N\+\_\+\+F\+L\+A\+G\+\_\+\+S\+L\+AK\+: Sleep acknowledge Flag \item C\+A\+N\+\_\+\+F\+L\+A\+G\+\_\+\+L\+EC\+: Last error code Flag \end{DoxyItemize}
\\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em None} & \\
\hline
\end{DoxyRetVals}


Definition at line \textbf{ 1427} of file \textbf{ stm32f4xx\+\_\+can.\+c}.



References \textbf{ R\+E\+S\+ET}.


\begin{DoxyCode}
01428 \{
01429   uint32\_t flagtmp=0;
01430   \textcolor{comment}{/* Check the parameters */}
01431   assert_param(IS_CAN_ALL_PERIPH(CANx));
01432   assert_param(IS_CAN_CLEAR_FLAG(CAN\_FLAG));
01433   
01434   \textcolor{keywordflow}{if} (CAN\_FLAG == CAN_FLAG_LEC) \textcolor{comment}{/* ESR register */}
01435   \{
01436     \textcolor{comment}{/* Clear the selected CAN flags */}
01437     CANx->ESR = (uint32\_t)RESET;
01438   \}
01439   \textcolor{keywordflow}{else} \textcolor{comment}{/* MSR or TSR or RF0R or RF1R */}
01440   \{
01441     flagtmp = CAN\_FLAG & 0x000FFFFF;
01442 
01443     \textcolor{keywordflow}{if} ((CAN\_FLAG & CAN_FLAGS_RF0R)!=(uint32\_t)RESET)
01444     \{
01445       \textcolor{comment}{/* Receive Flags */}
01446       CANx->RF0R = (uint32\_t)(flagtmp);
01447     \}
01448     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((CAN\_FLAG & CAN_FLAGS_RF1R)!=(uint32\_t)RESET)
01449     \{
01450       \textcolor{comment}{/* Receive Flags */}
01451       CANx->RF1R = (uint32\_t)(flagtmp);
01452     \}
01453     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((CAN\_FLAG & CAN_FLAGS_TSR)!=(uint32\_t)RESET)
01454     \{
01455       \textcolor{comment}{/* Transmit Flags */}
01456       CANx->TSR = (uint32\_t)(flagtmp);
01457     \}
01458     \textcolor{keywordflow}{else} \textcolor{comment}{/* If((CAN\_FLAG & CAN\_FLAGS\_MSR)!=(uint32\_t)RESET) */}
01459     \{
01460       \textcolor{comment}{/* Operating mode Flags */}
01461       CANx->MSR = (uint32\_t)(flagtmp);
01462     \}
01463   \}
01464 \}
\end{DoxyCode}
\mbox{\label{group__CAN_ga30bf7ac0c1793f6622a4a1adbb7dbc8a}} 
\index{C\+AN@{C\+AN}!C\+A\+N\+\_\+\+Clear\+I\+T\+Pending\+Bit@{C\+A\+N\+\_\+\+Clear\+I\+T\+Pending\+Bit}}
\index{C\+A\+N\+\_\+\+Clear\+I\+T\+Pending\+Bit@{C\+A\+N\+\_\+\+Clear\+I\+T\+Pending\+Bit}!C\+AN@{C\+AN}}
\subsubsection{C\+A\+N\+\_\+\+Clear\+I\+T\+Pending\+Bit()}
{\footnotesize\ttfamily void C\+A\+N\+\_\+\+Clear\+I\+T\+Pending\+Bit (\begin{DoxyParamCaption}\item[{\textbf{ C\+A\+N\+\_\+\+Type\+Def} $\ast$}]{C\+A\+Nx,  }\item[{uint32\+\_\+t}]{C\+A\+N\+\_\+\+IT }\end{DoxyParamCaption})}



Clears the C\+A\+Nx\textquotesingle{}s interrupt pending bits. 


\begin{DoxyParams}{Parameters}
{\em C\+A\+Nx} & where x can be 1 or 2 to to select the C\+AN peripheral. \\
\hline
{\em C\+A\+N\+\_\+\+IT} & specifies the interrupt pending bit to clear. This parameter can be one of the following values\+: \begin{DoxyItemize}
\item C\+A\+N\+\_\+\+I\+T\+\_\+\+T\+ME\+: Transmit mailbox empty Interrupt \item C\+A\+N\+\_\+\+I\+T\+\_\+\+F\+F0\+: F\+I\+FO 0 full Interrupt \item C\+A\+N\+\_\+\+I\+T\+\_\+\+F\+O\+V0\+: F\+I\+FO 0 overrun Interrupt \item C\+A\+N\+\_\+\+I\+T\+\_\+\+F\+F1\+: F\+I\+FO 1 full Interrupt \item C\+A\+N\+\_\+\+I\+T\+\_\+\+F\+O\+V1\+: F\+I\+FO 1 overrun Interrupt \item C\+A\+N\+\_\+\+I\+T\+\_\+\+W\+KU\+: Wake-\/up Interrupt \item C\+A\+N\+\_\+\+I\+T\+\_\+\+S\+LK\+: Sleep acknowledge Interrupt \item C\+A\+N\+\_\+\+I\+T\+\_\+\+E\+WG\+: Error warning Interrupt \item C\+A\+N\+\_\+\+I\+T\+\_\+\+E\+PV\+: Error passive Interrupt \item C\+A\+N\+\_\+\+I\+T\+\_\+\+B\+OF\+: Bus-\/off Interrupt \item C\+A\+N\+\_\+\+I\+T\+\_\+\+L\+EC\+: Last error code Interrupt \item C\+A\+N\+\_\+\+I\+T\+\_\+\+E\+RR\+: Error Interrupt \end{DoxyItemize}
\\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em None} & \\
\hline
\end{DoxyRetVals}


Definition at line \textbf{ 1591} of file \textbf{ stm32f4xx\+\_\+can.\+c}.


\begin{DoxyCode}
01592 \{
01593   \textcolor{comment}{/* Check the parameters */}
01594   assert_param(IS_CAN_ALL_PERIPH(CANx));
01595   assert_param(IS_CAN_CLEAR_IT(CAN\_IT));
01596 
01597   \textcolor{keywordflow}{switch} (CAN\_IT)
01598   \{
01599     \textcolor{keywordflow}{case} CAN_IT_TME:
01600       \textcolor{comment}{/* Clear CAN\_TSR\_RQCPx (rc\_w1)*/}
01601       CANx->TSR = CAN_TSR_RQCP0|CAN_TSR_RQCP1|CAN_TSR_RQCP2;  
01602       \textcolor{keywordflow}{break};
01603     \textcolor{keywordflow}{case} CAN_IT_FF0:
01604       \textcolor{comment}{/* Clear CAN\_RF0R\_FULL0 (rc\_w1)*/}
01605       CANx->RF0R = CAN_RF0R_FULL0; 
01606       \textcolor{keywordflow}{break};
01607     \textcolor{keywordflow}{case} CAN_IT_FOV0:
01608       \textcolor{comment}{/* Clear CAN\_RF0R\_FOVR0 (rc\_w1)*/}
01609       CANx->RF0R = CAN_RF0R_FOVR0; 
01610       \textcolor{keywordflow}{break};
01611     \textcolor{keywordflow}{case} CAN_IT_FF1:
01612       \textcolor{comment}{/* Clear CAN\_RF1R\_FULL1 (rc\_w1)*/}
01613       CANx->RF1R = CAN_RF1R_FULL1;  
01614       \textcolor{keywordflow}{break};
01615     \textcolor{keywordflow}{case} CAN_IT_FOV1:
01616       \textcolor{comment}{/* Clear CAN\_RF1R\_FOVR1 (rc\_w1)*/}
01617       CANx->RF1R = CAN_RF1R_FOVR1; 
01618       \textcolor{keywordflow}{break};
01619     \textcolor{keywordflow}{case} CAN_IT_WKU:
01620       \textcolor{comment}{/* Clear CAN\_MSR\_WKUI (rc\_w1)*/}
01621       CANx->MSR = CAN_MSR_WKUI;  
01622       \textcolor{keywordflow}{break};
01623     \textcolor{keywordflow}{case} CAN_IT_SLK:
01624       \textcolor{comment}{/* Clear CAN\_MSR\_SLAKI (rc\_w1)*/} 
01625       CANx->MSR = CAN_MSR_SLAKI;   
01626       \textcolor{keywordflow}{break};
01627     \textcolor{keywordflow}{case} CAN_IT_EWG:
01628       \textcolor{comment}{/* Clear CAN\_MSR\_ERRI (rc\_w1) */}
01629       CANx->MSR = CAN_MSR_ERRI;
01630        \textcolor{comment}{/* @note the corresponding Flag is cleared by hardware depending on the CAN Bus status*/} 
01631       \textcolor{keywordflow}{break};
01632     \textcolor{keywordflow}{case} CAN_IT_EPV:
01633       \textcolor{comment}{/* Clear CAN\_MSR\_ERRI (rc\_w1) */}
01634       CANx->MSR = CAN_MSR_ERRI; 
01635        \textcolor{comment}{/* @note the corresponding Flag is cleared by hardware depending on the CAN Bus status*/}
01636       \textcolor{keywordflow}{break};
01637     \textcolor{keywordflow}{case} CAN_IT_BOF:
01638       \textcolor{comment}{/* Clear CAN\_MSR\_ERRI (rc\_w1) */} 
01639       CANx->MSR = CAN_MSR_ERRI; 
01640        \textcolor{comment}{/* @note the corresponding Flag is cleared by hardware depending on the CAN Bus status*/}
01641        \textcolor{keywordflow}{break};
01642     \textcolor{keywordflow}{case} CAN_IT_LEC:
01643       \textcolor{comment}{/*  Clear LEC bits */}
01644       CANx->ESR = RESET; 
01645       \textcolor{comment}{/* Clear CAN\_MSR\_ERRI (rc\_w1) */}
01646       CANx->MSR = CAN_MSR_ERRI; 
01647       \textcolor{keywordflow}{break};
01648     \textcolor{keywordflow}{case} CAN_IT_ERR:
01649       \textcolor{comment}{/*Clear LEC bits */}
01650       CANx->ESR = RESET; 
01651       \textcolor{comment}{/* Clear CAN\_MSR\_ERRI (rc\_w1) */}
01652       CANx->MSR = CAN_MSR_ERRI; 
01653        \textcolor{comment}{/* @note BOFF, EPVF and EWGF Flags are cleared by hardware depending on the CAN Bus status*/}
01654        \textcolor{keywordflow}{break};
01655     \textcolor{keywordflow}{default}:
01656        \textcolor{keywordflow}{break};
01657    \}
01658 \}
\end{DoxyCode}
\mbox{\label{group__CAN_gac0e2d33e08caf49d1f1251f0dcc20213}} 
\index{C\+AN@{C\+AN}!C\+A\+N\+\_\+\+D\+B\+G\+Freeze@{C\+A\+N\+\_\+\+D\+B\+G\+Freeze}}
\index{C\+A\+N\+\_\+\+D\+B\+G\+Freeze@{C\+A\+N\+\_\+\+D\+B\+G\+Freeze}!C\+AN@{C\+AN}}
\subsubsection{C\+A\+N\+\_\+\+D\+B\+G\+Freeze()}
{\footnotesize\ttfamily void C\+A\+N\+\_\+\+D\+B\+G\+Freeze (\begin{DoxyParamCaption}\item[{\textbf{ C\+A\+N\+\_\+\+Type\+Def} $\ast$}]{C\+A\+Nx,  }\item[{\textbf{ Functional\+State}}]{New\+State }\end{DoxyParamCaption})}



Enables or disables the D\+BG Freeze for C\+AN. 


\begin{DoxyParams}{Parameters}
{\em C\+A\+Nx} & where x can be 1 or 2 to to select the C\+AN peripheral. \\
\hline
{\em New\+State} & new state of the C\+AN peripheral. This parameter can be\+: E\+N\+A\+B\+LE (C\+AN reception/transmission is frozen during debug. Reception F\+I\+F\+Os can still be accessed/controlled normally) or D\+I\+S\+A\+B\+LE (C\+AN is working during debug). \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em None} & \\
\hline
\end{DoxyRetVals}


Definition at line \textbf{ 488} of file \textbf{ stm32f4xx\+\_\+can.\+c}.



References \textbf{ D\+I\+S\+A\+B\+LE}.


\begin{DoxyCode}
00489 \{
00490   \textcolor{comment}{/* Check the parameters */}
00491   assert_param(IS_CAN_ALL_PERIPH(CANx));
00492   assert_param(IS_FUNCTIONAL_STATE(NewState));
00493   
00494   \textcolor{keywordflow}{if} (NewState != DISABLE)
00495   \{
00496     \textcolor{comment}{/* Enable Debug Freeze  */}
00497     CANx->MCR |= MCR_DBF;
00498   \}
00499   \textcolor{keywordflow}{else}
00500   \{
00501     \textcolor{comment}{/* Disable Debug Freeze */}
00502     CANx->MCR &= ~MCR_DBF;
00503   \}
00504 \}
\end{DoxyCode}
\mbox{\label{group__CAN_ga002b74cd69574a14b17ad445090245cd}} 
\index{C\+AN@{C\+AN}!C\+A\+N\+\_\+\+De\+Init@{C\+A\+N\+\_\+\+De\+Init}}
\index{C\+A\+N\+\_\+\+De\+Init@{C\+A\+N\+\_\+\+De\+Init}!C\+AN@{C\+AN}}
\subsubsection{C\+A\+N\+\_\+\+De\+Init()}
{\footnotesize\ttfamily void C\+A\+N\+\_\+\+De\+Init (\begin{DoxyParamCaption}\item[{\textbf{ C\+A\+N\+\_\+\+Type\+Def} $\ast$}]{C\+A\+Nx }\end{DoxyParamCaption})}



Deinitializes the C\+AN peripheral registers to their default reset values. 


\begin{DoxyParams}{Parameters}
{\em C\+A\+Nx} & where x can be 1 or 2 to select the C\+AN peripheral. \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em None.} & \\
\hline
\end{DoxyRetVals}


Definition at line \textbf{ 162} of file \textbf{ stm32f4xx\+\_\+can.\+c}.



References \textbf{ D\+I\+S\+A\+B\+LE}, \textbf{ E\+N\+A\+B\+LE}, and \textbf{ R\+C\+C\+\_\+\+A\+P\+B1\+Periph\+Reset\+Cmd()}.


\begin{DoxyCode}
00163 \{
00164   \textcolor{comment}{/* Check the parameters */}
00165   assert_param(IS_CAN_ALL_PERIPH(CANx));
00166  
00167   \textcolor{keywordflow}{if} (CANx == CAN1)
00168   \{
00169     \textcolor{comment}{/* Enable CAN1 reset state */}
00170     RCC_APB1PeriphResetCmd(RCC_APB1Periph_CAN1, ENABLE);
00171     \textcolor{comment}{/* Release CAN1 from reset state */}
00172     RCC_APB1PeriphResetCmd(RCC_APB1Periph_CAN1, DISABLE);
00173   \}
00174   \textcolor{keywordflow}{else}
00175   \{  
00176     \textcolor{comment}{/* Enable CAN2 reset state */}
00177     RCC_APB1PeriphResetCmd(RCC_APB1Periph_CAN2, ENABLE);
00178     \textcolor{comment}{/* Release CAN2 from reset state */}
00179     RCC_APB1PeriphResetCmd(RCC_APB1Periph_CAN2, DISABLE);
00180   \}
00181 \}
\end{DoxyCode}
\mbox{\label{group__CAN_ga1bc3b39471e579b4101624c33d27918b}} 
\index{C\+AN@{C\+AN}!C\+A\+N\+\_\+\+F\+I\+F\+O\+Release@{C\+A\+N\+\_\+\+F\+I\+F\+O\+Release}}
\index{C\+A\+N\+\_\+\+F\+I\+F\+O\+Release@{C\+A\+N\+\_\+\+F\+I\+F\+O\+Release}!C\+AN@{C\+AN}}
\subsubsection{C\+A\+N\+\_\+\+F\+I\+F\+O\+Release()}
{\footnotesize\ttfamily void C\+A\+N\+\_\+\+F\+I\+F\+O\+Release (\begin{DoxyParamCaption}\item[{\textbf{ C\+A\+N\+\_\+\+Type\+Def} $\ast$}]{C\+A\+Nx,  }\item[{uint8\+\_\+t}]{F\+I\+F\+O\+Number }\end{DoxyParamCaption})}



Releases the specified receive F\+I\+FO. 


\begin{DoxyParams}{Parameters}
{\em C\+A\+Nx} & where x can be 1 or 2 to select the C\+AN peripheral. \\
\hline
{\em F\+I\+F\+O\+Number} & F\+I\+FO to release, C\+A\+N\+\_\+\+F\+I\+F\+O0 or C\+A\+N\+\_\+\+F\+I\+F\+O1. \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em None} & \\
\hline
\end{DoxyRetVals}


Definition at line \textbf{ 794} of file \textbf{ stm32f4xx\+\_\+can.\+c}.


\begin{DoxyCode}
00795 \{
00796   \textcolor{comment}{/* Check the parameters */}
00797   assert_param(IS_CAN_ALL_PERIPH(CANx));
00798   assert_param(IS_CAN_FIFO(FIFONumber));
00799   \textcolor{comment}{/* Release FIFO0 */}
00800   \textcolor{keywordflow}{if} (FIFONumber == CAN_FIFO0)
00801   \{
00802     CANx->RF0R |= CAN_RF0R_RFOM0;
00803   \}
00804   \textcolor{comment}{/* Release FIFO1 */}
00805   \textcolor{keywordflow}{else} \textcolor{comment}{/* FIFONumber == CAN\_FIFO1 */}
00806   \{
00807     CANx->RF1R |= CAN_RF1R_RFOM1;
00808   \}
00809 \}
\end{DoxyCode}
\mbox{\label{group__CAN_ga39476830280340363c51041be6b12647}} 
\index{C\+AN@{C\+AN}!C\+A\+N\+\_\+\+Filter\+Init@{C\+A\+N\+\_\+\+Filter\+Init}}
\index{C\+A\+N\+\_\+\+Filter\+Init@{C\+A\+N\+\_\+\+Filter\+Init}!C\+AN@{C\+AN}}
\subsubsection{C\+A\+N\+\_\+\+Filter\+Init()}
{\footnotesize\ttfamily void C\+A\+N\+\_\+\+Filter\+Init (\begin{DoxyParamCaption}\item[{\textbf{ C\+A\+N\+\_\+\+Filter\+Init\+Type\+Def} $\ast$}]{C\+A\+N\+\_\+\+Filter\+Init\+Struct }\end{DoxyParamCaption})}



Configures the C\+AN reception filter according to the specified parameters in the C\+A\+N\+\_\+\+Filter\+Init\+Struct. 


\begin{DoxyParams}{Parameters}
{\em C\+A\+N\+\_\+\+Filter\+Init\+Struct} & pointer to a \doxyref{C\+A\+N\+\_\+\+Filter\+Init\+Type\+Def}{p.}{structCAN__FilterInitTypeDef} structure that contains the configuration information. \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em None} & \\
\hline
\end{DoxyRetVals}


Definition at line \textbf{ 329} of file \textbf{ stm32f4xx\+\_\+can.\+c}.



References \textbf{ C\+A\+N\+\_\+\+Filter\+Init\+Type\+Def\+::\+C\+A\+N\+\_\+\+Filter\+Activation}, \textbf{ C\+A\+N\+\_\+\+Filter\+Init\+Type\+Def\+::\+C\+A\+N\+\_\+\+Filter\+F\+I\+F\+O\+Assignment}, \textbf{ C\+A\+N\+\_\+\+Filter\+Init\+Type\+Def\+::\+C\+A\+N\+\_\+\+Filter\+Mode}, \textbf{ C\+A\+N\+\_\+\+Filter\+Init\+Type\+Def\+::\+C\+A\+N\+\_\+\+Filter\+Number}, \textbf{ C\+A\+N\+\_\+\+Filter\+Init\+Type\+Def\+::\+C\+A\+N\+\_\+\+Filter\+Scale}, and \textbf{ E\+N\+A\+B\+LE}.


\begin{DoxyCode}
00330 \{
00331   uint32\_t filter\_number\_bit\_pos = 0;
00332   \textcolor{comment}{/* Check the parameters */}
00333   assert_param(IS_CAN_FILTER_NUMBER(CAN\_FilterInitStruct->CAN_FilterNumber));
00334   assert_param(IS_CAN_FILTER_MODE(CAN\_FilterInitStruct->CAN_FilterMode));
00335   assert_param(IS_CAN_FILTER_SCALE(CAN\_FilterInitStruct->CAN_FilterScale));
00336   assert_param(IS_CAN_FILTER_FIFO(CAN\_FilterInitStruct->CAN_FilterFIFOAssignment));
00337   assert_param(IS_FUNCTIONAL_STATE(CAN\_FilterInitStruct->CAN_FilterActivation));
00338 
00339   filter\_number\_bit\_pos = ((uint32\_t)1) << CAN\_FilterInitStruct->
      CAN_FilterNumber;
00340 
00341   \textcolor{comment}{/* Initialisation mode for the filter */}
00342   CAN1->FMR |= FMR_FINIT;
00343 
00344   \textcolor{comment}{/* Filter Deactivation */}
00345   CAN1->FA1R &= ~(uint32\_t)filter\_number\_bit\_pos;
00346 
00347   \textcolor{comment}{/* Filter Scale */}
00348   \textcolor{keywordflow}{if} (CAN\_FilterInitStruct->CAN_FilterScale == CAN_FilterScale_16bit)
00349   \{
00350     \textcolor{comment}{/* 16-bit scale for the filter */}
00351     CAN1->FS1R &= ~(uint32\_t)filter\_number\_bit\_pos;
00352 
00353     \textcolor{comment}{/* First 16-bit identifier and First 16-bit mask */}
00354     \textcolor{comment}{/* Or First 16-bit identifier and Second 16-bit identifier */}
00355     CAN1->sFilterRegister[CAN\_FilterInitStruct->CAN_FilterNumber].FR1 = 
00356        ((0x0000FFFF & (uint32\_t)CAN\_FilterInitStruct->CAN_FilterMaskIdLow) << 16) |
00357         (0x0000FFFF & (uint32\_t)CAN\_FilterInitStruct->CAN_FilterIdLow);
00358 
00359     \textcolor{comment}{/* Second 16-bit identifier and Second 16-bit mask */}
00360     \textcolor{comment}{/* Or Third 16-bit identifier and Fourth 16-bit identifier */}
00361     CAN1->sFilterRegister[CAN\_FilterInitStruct->CAN_FilterNumber].FR2 = 
00362        ((0x0000FFFF & (uint32\_t)CAN\_FilterInitStruct->CAN_FilterMaskIdHigh) << 16) |
00363         (0x0000FFFF & (uint32\_t)CAN\_FilterInitStruct->CAN_FilterIdHigh);
00364   \}
00365 
00366   \textcolor{keywordflow}{if} (CAN\_FilterInitStruct->CAN_FilterScale == CAN_FilterScale_32bit)
00367   \{
00368     \textcolor{comment}{/* 32-bit scale for the filter */}
00369     CAN1->FS1R |= filter\_number\_bit\_pos;
00370     \textcolor{comment}{/* 32-bit identifier or First 32-bit identifier */}
00371     CAN1->sFilterRegister[CAN\_FilterInitStruct->CAN_FilterNumber].FR1 = 
00372        ((0x0000FFFF & (uint32\_t)CAN\_FilterInitStruct->CAN_FilterIdHigh) << 16) |
00373         (0x0000FFFF & (uint32\_t)CAN\_FilterInitStruct->CAN_FilterIdLow);
00374     \textcolor{comment}{/* 32-bit mask or Second 32-bit identifier */}
00375     CAN1->sFilterRegister[CAN\_FilterInitStruct->CAN_FilterNumber].FR2 = 
00376        ((0x0000FFFF & (uint32\_t)CAN\_FilterInitStruct->CAN_FilterMaskIdHigh) << 16) |
00377         (0x0000FFFF & (uint32\_t)CAN\_FilterInitStruct->CAN_FilterMaskIdLow);
00378   \}
00379 
00380   \textcolor{comment}{/* Filter Mode */}
00381   \textcolor{keywordflow}{if} (CAN\_FilterInitStruct->CAN_FilterMode == CAN_FilterMode_IdMask)
00382   \{
00383     \textcolor{comment}{/*Id/Mask mode for the filter*/}
00384     CAN1->FM1R &= ~(uint32\_t)filter\_number\_bit\_pos;
00385   \}
00386   \textcolor{keywordflow}{else} \textcolor{comment}{/* CAN\_FilterInitStruct->CAN\_FilterMode == CAN\_FilterMode\_IdList */}
00387   \{
00388     \textcolor{comment}{/*Identifier list mode for the filter*/}
00389     CAN1->FM1R |= (uint32\_t)filter\_number\_bit\_pos;
00390   \}
00391 
00392   \textcolor{comment}{/* Filter FIFO assignment */}
00393   \textcolor{keywordflow}{if} (CAN\_FilterInitStruct->CAN_FilterFIFOAssignment == CAN_Filter_FIFO0)
00394   \{
00395     \textcolor{comment}{/* FIFO 0 assignation for the filter */}
00396     CAN1->FFA1R &= ~(uint32\_t)filter\_number\_bit\_pos;
00397   \}
00398 
00399   \textcolor{keywordflow}{if} (CAN\_FilterInitStruct->CAN_FilterFIFOAssignment == CAN_Filter_FIFO1)
00400   \{
00401     \textcolor{comment}{/* FIFO 1 assignation for the filter */}
00402     CAN1->FFA1R |= (uint32\_t)filter\_number\_bit\_pos;
00403   \}
00404   
00405   \textcolor{comment}{/* Filter activation */}
00406   \textcolor{keywordflow}{if} (CAN\_FilterInitStruct->CAN_FilterActivation == ENABLE)
00407   \{
00408     CAN1->FA1R |= filter\_number\_bit\_pos;
00409   \}
00410 
00411   \textcolor{comment}{/* Leave the initialisation mode for the filter */}
00412   CAN1->FMR &= ~FMR_FINIT;
00413 \}
\end{DoxyCode}
\mbox{\label{group__CAN_ga2faad96caf823ef463cc5b5b25c480bb}} 
\index{C\+AN@{C\+AN}!C\+A\+N\+\_\+\+Get\+Flag\+Status@{C\+A\+N\+\_\+\+Get\+Flag\+Status}}
\index{C\+A\+N\+\_\+\+Get\+Flag\+Status@{C\+A\+N\+\_\+\+Get\+Flag\+Status}!C\+AN@{C\+AN}}
\subsubsection{C\+A\+N\+\_\+\+Get\+Flag\+Status()}
{\footnotesize\ttfamily \textbf{ Flag\+Status} C\+A\+N\+\_\+\+Get\+Flag\+Status (\begin{DoxyParamCaption}\item[{\textbf{ C\+A\+N\+\_\+\+Type\+Def} $\ast$}]{C\+A\+Nx,  }\item[{uint32\+\_\+t}]{C\+A\+N\+\_\+\+F\+L\+AG }\end{DoxyParamCaption})}



Checks whether the specified C\+AN flag is set or not. 


\begin{DoxyParams}{Parameters}
{\em C\+A\+Nx} & where x can be 1 or 2 to to select the C\+AN peripheral. \\
\hline
{\em C\+A\+N\+\_\+\+F\+L\+AG} & specifies the flag to check. This parameter can be one of the following values\+: \begin{DoxyItemize}
\item C\+A\+N\+\_\+\+F\+L\+A\+G\+\_\+\+R\+Q\+C\+P0\+: Request Mail\+Box0 Flag \item C\+A\+N\+\_\+\+F\+L\+A\+G\+\_\+\+R\+Q\+C\+P1\+: Request Mail\+Box1 Flag \item C\+A\+N\+\_\+\+F\+L\+A\+G\+\_\+\+R\+Q\+C\+P2\+: Request Mail\+Box2 Flag \item C\+A\+N\+\_\+\+F\+L\+A\+G\+\_\+\+F\+M\+P0\+: F\+I\+FO 0 Message Pending Flag \item C\+A\+N\+\_\+\+F\+L\+A\+G\+\_\+\+F\+F0\+: F\+I\+FO 0 Full Flag \item C\+A\+N\+\_\+\+F\+L\+A\+G\+\_\+\+F\+O\+V0\+: F\+I\+FO 0 Overrun Flag \item C\+A\+N\+\_\+\+F\+L\+A\+G\+\_\+\+F\+M\+P1\+: F\+I\+FO 1 Message Pending Flag \item C\+A\+N\+\_\+\+F\+L\+A\+G\+\_\+\+F\+F1\+: F\+I\+FO 1 Full Flag \item C\+A\+N\+\_\+\+F\+L\+A\+G\+\_\+\+F\+O\+V1\+: F\+I\+FO 1 Overrun Flag \item C\+A\+N\+\_\+\+F\+L\+A\+G\+\_\+\+W\+KU\+: Wake up Flag \item C\+A\+N\+\_\+\+F\+L\+A\+G\+\_\+\+S\+L\+AK\+: Sleep acknowledge Flag \item C\+A\+N\+\_\+\+F\+L\+A\+G\+\_\+\+E\+WG\+: Error Warning Flag \item C\+A\+N\+\_\+\+F\+L\+A\+G\+\_\+\+E\+PV\+: Error Passive Flag \item C\+A\+N\+\_\+\+F\+L\+A\+G\+\_\+\+B\+OF\+: Bus-\/\+Off Flag \item C\+A\+N\+\_\+\+F\+L\+A\+G\+\_\+\+L\+EC\+: Last error code Flag \end{DoxyItemize}
\\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em The} & new state of C\+A\+N\+\_\+\+F\+L\+AG (S\+ET or R\+E\+S\+ET). \\
\hline
\end{DoxyRetVals}


Definition at line \textbf{ 1327} of file \textbf{ stm32f4xx\+\_\+can.\+c}.



References \textbf{ R\+E\+S\+ET}.


\begin{DoxyCode}
01328 \{
01329   FlagStatus bitstatus = RESET;
01330   
01331   \textcolor{comment}{/* Check the parameters */}
01332   assert_param(IS_CAN_ALL_PERIPH(CANx));
01333   assert_param(IS_CAN_GET_FLAG(CAN\_FLAG));
01334   
01335 
01336   \textcolor{keywordflow}{if}((CAN\_FLAG & CAN_FLAGS_ESR) != (uint32\_t)RESET)
01337   \{ 
01338     \textcolor{comment}{/* Check the status of the specified CAN flag */}
01339     \textcolor{keywordflow}{if} ((CANx->ESR & (CAN\_FLAG & 0x000FFFFF)) != (uint32\_t)RESET)
01340     \{ 
01341       \textcolor{comment}{/* CAN\_FLAG is set */}
01342       bitstatus = SET;
01343     \}
01344     \textcolor{keywordflow}{else}
01345     \{ 
01346       \textcolor{comment}{/* CAN\_FLAG is reset */}
01347       bitstatus = RESET;
01348     \}
01349   \}
01350   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}((CAN\_FLAG & CAN_FLAGS_MSR) != (uint32\_t)RESET)
01351   \{ 
01352     \textcolor{comment}{/* Check the status of the specified CAN flag */}
01353     \textcolor{keywordflow}{if} ((CANx->MSR & (CAN\_FLAG & 0x000FFFFF)) != (uint32\_t)RESET)
01354     \{ 
01355       \textcolor{comment}{/* CAN\_FLAG is set */}
01356       bitstatus = SET;
01357     \}
01358     \textcolor{keywordflow}{else}
01359     \{ 
01360       \textcolor{comment}{/* CAN\_FLAG is reset */}
01361       bitstatus = RESET;
01362     \}
01363   \}
01364   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}((CAN\_FLAG & CAN_FLAGS_TSR) != (uint32\_t)RESET)
01365   \{ 
01366     \textcolor{comment}{/* Check the status of the specified CAN flag */}
01367     \textcolor{keywordflow}{if} ((CANx->TSR & (CAN\_FLAG & 0x000FFFFF)) != (uint32\_t)RESET)
01368     \{ 
01369       \textcolor{comment}{/* CAN\_FLAG is set */}
01370       bitstatus = SET;
01371     \}
01372     \textcolor{keywordflow}{else}
01373     \{ 
01374       \textcolor{comment}{/* CAN\_FLAG is reset */}
01375       bitstatus = RESET;
01376     \}
01377   \}
01378   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}((CAN\_FLAG & CAN_FLAGS_RF0R) != (uint32\_t)RESET)
01379   \{ 
01380     \textcolor{comment}{/* Check the status of the specified CAN flag */}
01381     \textcolor{keywordflow}{if} ((CANx->RF0R & (CAN\_FLAG & 0x000FFFFF)) != (uint32\_t)RESET)
01382     \{ 
01383       \textcolor{comment}{/* CAN\_FLAG is set */}
01384       bitstatus = SET;
01385     \}
01386     \textcolor{keywordflow}{else}
01387     \{ 
01388       \textcolor{comment}{/* CAN\_FLAG is reset */}
01389       bitstatus = RESET;
01390     \}
01391   \}
01392   \textcolor{keywordflow}{else} \textcolor{comment}{/* If(CAN\_FLAG & CAN\_FLAGS\_RF1R != (uint32\_t)RESET) */}
01393   \{ 
01394     \textcolor{comment}{/* Check the status of the specified CAN flag */}
01395     \textcolor{keywordflow}{if} ((uint32\_t)(CANx->RF1R & (CAN\_FLAG & 0x000FFFFF)) != (uint32\_t)RESET)
01396     \{ 
01397       \textcolor{comment}{/* CAN\_FLAG is set */}
01398       bitstatus = SET;
01399     \}
01400     \textcolor{keywordflow}{else}
01401     \{ 
01402       \textcolor{comment}{/* CAN\_FLAG is reset */}
01403       bitstatus = RESET;
01404     \}
01405   \}
01406   \textcolor{comment}{/* Return the CAN\_FLAG status */}
01407   \textcolor{keywordflow}{return}  bitstatus;
01408 \}
\end{DoxyCode}
\mbox{\label{group__CAN_ga9aca05b3013e1b3438f3559f80b33c82}} 
\index{C\+AN@{C\+AN}!C\+A\+N\+\_\+\+Get\+I\+T\+Status@{C\+A\+N\+\_\+\+Get\+I\+T\+Status}}
\index{C\+A\+N\+\_\+\+Get\+I\+T\+Status@{C\+A\+N\+\_\+\+Get\+I\+T\+Status}!C\+AN@{C\+AN}}
\subsubsection{C\+A\+N\+\_\+\+Get\+I\+T\+Status()}
{\footnotesize\ttfamily \textbf{ I\+T\+Status} C\+A\+N\+\_\+\+Get\+I\+T\+Status (\begin{DoxyParamCaption}\item[{\textbf{ C\+A\+N\+\_\+\+Type\+Def} $\ast$}]{C\+A\+Nx,  }\item[{uint32\+\_\+t}]{C\+A\+N\+\_\+\+IT }\end{DoxyParamCaption})}



Checks whether the specified C\+A\+Nx interrupt has occurred or not. 


\begin{DoxyParams}{Parameters}
{\em C\+A\+Nx} & where x can be 1 or 2 to to select the C\+AN peripheral. \\
\hline
{\em C\+A\+N\+\_\+\+IT} & specifies the C\+AN interrupt source to check. This parameter can be one of the following values\+: \begin{DoxyItemize}
\item C\+A\+N\+\_\+\+I\+T\+\_\+\+T\+ME\+: Transmit mailbox empty Interrupt \item C\+A\+N\+\_\+\+I\+T\+\_\+\+F\+M\+P0\+: F\+I\+FO 0 message pending Interrupt \item C\+A\+N\+\_\+\+I\+T\+\_\+\+F\+F0\+: F\+I\+FO 0 full Interrupt \item C\+A\+N\+\_\+\+I\+T\+\_\+\+F\+O\+V0\+: F\+I\+FO 0 overrun Interrupt \item C\+A\+N\+\_\+\+I\+T\+\_\+\+F\+M\+P1\+: F\+I\+FO 1 message pending Interrupt \item C\+A\+N\+\_\+\+I\+T\+\_\+\+F\+F1\+: F\+I\+FO 1 full Interrupt \item C\+A\+N\+\_\+\+I\+T\+\_\+\+F\+O\+V1\+: F\+I\+FO 1 overrun Interrupt \item C\+A\+N\+\_\+\+I\+T\+\_\+\+W\+KU\+: Wake-\/up Interrupt \item C\+A\+N\+\_\+\+I\+T\+\_\+\+S\+LK\+: Sleep acknowledge Interrupt \item C\+A\+N\+\_\+\+I\+T\+\_\+\+E\+WG\+: Error warning Interrupt \item C\+A\+N\+\_\+\+I\+T\+\_\+\+E\+PV\+: Error passive Interrupt \item C\+A\+N\+\_\+\+I\+T\+\_\+\+B\+OF\+: Bus-\/off Interrupt \item C\+A\+N\+\_\+\+I\+T\+\_\+\+L\+EC\+: Last error code Interrupt \item C\+A\+N\+\_\+\+I\+T\+\_\+\+E\+RR\+: Error Interrupt \end{DoxyItemize}
\\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em The} & current state of C\+A\+N\+\_\+\+IT (S\+ET or R\+E\+S\+ET). \\
\hline
\end{DoxyRetVals}


Definition at line \textbf{ 1487} of file \textbf{ stm32f4xx\+\_\+can.\+c}.



References \textbf{ R\+E\+S\+ET}.


\begin{DoxyCode}
01488 \{
01489   ITStatus itstatus = RESET;
01490   \textcolor{comment}{/* Check the parameters */}
01491   assert_param(IS_CAN_ALL_PERIPH(CANx));
01492   assert_param(IS_CAN_IT(CAN\_IT));
01493   
01494   \textcolor{comment}{/* check the interrupt enable bit */}
01495  \textcolor{keywordflow}{if}((CANx->IER & CAN\_IT) != RESET)
01496  \{
01497    \textcolor{comment}{/* in case the Interrupt is enabled, .... */}
01498     \textcolor{keywordflow}{switch} (CAN\_IT)
01499     \{
01500       \textcolor{keywordflow}{case} CAN_IT_TME:
01501         \textcolor{comment}{/* Check CAN\_TSR\_RQCPx bits */}
01502         itstatus = CheckITStatus(CANx->TSR, CAN_TSR_RQCP0|CAN_TSR_RQCP1|
      CAN_TSR_RQCP2);  
01503         \textcolor{keywordflow}{break};
01504       \textcolor{keywordflow}{case} CAN_IT_FMP0:
01505         \textcolor{comment}{/* Check CAN\_RF0R\_FMP0 bit */}
01506         itstatus = CheckITStatus(CANx->RF0R, CAN_RF0R_FMP0);  
01507         \textcolor{keywordflow}{break};
01508       \textcolor{keywordflow}{case} CAN_IT_FF0:
01509         \textcolor{comment}{/* Check CAN\_RF0R\_FULL0 bit */}
01510         itstatus = CheckITStatus(CANx->RF0R, CAN_RF0R_FULL0);  
01511         \textcolor{keywordflow}{break};
01512       \textcolor{keywordflow}{case} CAN_IT_FOV0:
01513         \textcolor{comment}{/* Check CAN\_RF0R\_FOVR0 bit */}
01514         itstatus = CheckITStatus(CANx->RF0R, CAN_RF0R_FOVR0);  
01515         \textcolor{keywordflow}{break};
01516       \textcolor{keywordflow}{case} CAN_IT_FMP1:
01517         \textcolor{comment}{/* Check CAN\_RF1R\_FMP1 bit */}
01518         itstatus = CheckITStatus(CANx->RF1R, CAN_RF1R_FMP1);  
01519         \textcolor{keywordflow}{break};
01520       \textcolor{keywordflow}{case} CAN_IT_FF1:
01521         \textcolor{comment}{/* Check CAN\_RF1R\_FULL1 bit */}
01522         itstatus = CheckITStatus(CANx->RF1R, CAN_RF1R_FULL1);  
01523         \textcolor{keywordflow}{break};
01524       \textcolor{keywordflow}{case} CAN_IT_FOV1:
01525         \textcolor{comment}{/* Check CAN\_RF1R\_FOVR1 bit */}
01526         itstatus = CheckITStatus(CANx->RF1R, CAN_RF1R_FOVR1);  
01527         \textcolor{keywordflow}{break};
01528       \textcolor{keywordflow}{case} CAN_IT_WKU:
01529         \textcolor{comment}{/* Check CAN\_MSR\_WKUI bit */}
01530         itstatus = CheckITStatus(CANx->MSR, CAN_MSR_WKUI);  
01531         \textcolor{keywordflow}{break};
01532       \textcolor{keywordflow}{case} CAN_IT_SLK:
01533         \textcolor{comment}{/* Check CAN\_MSR\_SLAKI bit */}
01534         itstatus = CheckITStatus(CANx->MSR, CAN_MSR_SLAKI);  
01535         \textcolor{keywordflow}{break};
01536       \textcolor{keywordflow}{case} CAN_IT_EWG:
01537         \textcolor{comment}{/* Check CAN\_ESR\_EWGF bit */}
01538         itstatus = CheckITStatus(CANx->ESR, CAN_ESR_EWGF);  
01539         \textcolor{keywordflow}{break};
01540       \textcolor{keywordflow}{case} CAN_IT_EPV:
01541         \textcolor{comment}{/* Check CAN\_ESR\_EPVF bit */}
01542         itstatus = CheckITStatus(CANx->ESR, CAN_ESR_EPVF);  
01543         \textcolor{keywordflow}{break};
01544       \textcolor{keywordflow}{case} CAN_IT_BOF:
01545         \textcolor{comment}{/* Check CAN\_ESR\_BOFF bit */}
01546         itstatus = CheckITStatus(CANx->ESR, CAN_ESR_BOFF);  
01547         \textcolor{keywordflow}{break};
01548       \textcolor{keywordflow}{case} CAN_IT_LEC:
01549         \textcolor{comment}{/* Check CAN\_ESR\_LEC bit */}
01550         itstatus = CheckITStatus(CANx->ESR, CAN_ESR_LEC);  
01551         \textcolor{keywordflow}{break};
01552       \textcolor{keywordflow}{case} CAN_IT_ERR:
01553         \textcolor{comment}{/* Check CAN\_MSR\_ERRI bit */} 
01554         itstatus = CheckITStatus(CANx->MSR, CAN_MSR_ERRI); 
01555         \textcolor{keywordflow}{break};
01556       \textcolor{keywordflow}{default}:
01557         \textcolor{comment}{/* in case of error, return RESET */}
01558         itstatus = RESET;
01559         \textcolor{keywordflow}{break};
01560     \}
01561   \}
01562   \textcolor{keywordflow}{else}
01563   \{
01564    \textcolor{comment}{/* in case the Interrupt is not enabled, return RESET */}
01565     itstatus  = RESET;
01566   \}
01567   
01568   \textcolor{comment}{/* Return the CAN\_IT status */}
01569   \textcolor{keywordflow}{return}  itstatus;
01570 \}
\end{DoxyCode}
\mbox{\label{group__CAN_gaaee721a392b6b21bfd15dc160aeb6924}} 
\index{C\+AN@{C\+AN}!C\+A\+N\+\_\+\+Get\+Last\+Error\+Code@{C\+A\+N\+\_\+\+Get\+Last\+Error\+Code}}
\index{C\+A\+N\+\_\+\+Get\+Last\+Error\+Code@{C\+A\+N\+\_\+\+Get\+Last\+Error\+Code}!C\+AN@{C\+AN}}
\subsubsection{C\+A\+N\+\_\+\+Get\+Last\+Error\+Code()}
{\footnotesize\ttfamily uint8\+\_\+t C\+A\+N\+\_\+\+Get\+Last\+Error\+Code (\begin{DoxyParamCaption}\item[{\textbf{ C\+A\+N\+\_\+\+Type\+Def} $\ast$}]{C\+A\+Nx }\end{DoxyParamCaption})}



Returns the C\+A\+Nx\textquotesingle{}s last error code (L\+EC). 


\begin{DoxyParams}{Parameters}
{\em C\+A\+Nx} & where x can be 1 or 2 to select the C\+AN peripheral. \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em Error} & code\+:
\begin{DoxyItemize}
\item C\+A\+N\+\_\+\+E\+R\+R\+O\+R\+C\+O\+D\+E\+\_\+\+No\+Err\+: No Error
\item C\+A\+N\+\_\+\+E\+R\+R\+O\+R\+C\+O\+D\+E\+\_\+\+Stuff\+Err\+: Stuff Error
\item C\+A\+N\+\_\+\+E\+R\+R\+O\+R\+C\+O\+D\+E\+\_\+\+Form\+Err\+: Form Error
\item C\+A\+N\+\_\+\+E\+R\+R\+O\+R\+C\+O\+D\+E\+\_\+\+A\+C\+K\+Err \+: Acknowledgment Error
\item C\+A\+N\+\_\+\+E\+R\+R\+O\+R\+C\+O\+D\+E\+\_\+\+Bit\+Recessive\+Err\+: Bit Recessive Error
\item C\+A\+N\+\_\+\+E\+R\+R\+O\+R\+C\+O\+D\+E\+\_\+\+Bit\+Dominant\+Err\+: Bit Dominant Error
\item C\+A\+N\+\_\+\+E\+R\+R\+O\+R\+C\+O\+D\+E\+\_\+\+C\+R\+C\+Err\+: C\+RC Error
\item C\+A\+N\+\_\+\+E\+R\+R\+O\+R\+C\+O\+D\+E\+\_\+\+Software\+Set\+Err\+: Software Set Error 
\end{DoxyItemize}\\
\hline
\end{DoxyRetVals}


Definition at line \textbf{ 1035} of file \textbf{ stm32f4xx\+\_\+can.\+c}.


\begin{DoxyCode}
01036 \{
01037   uint8\_t errorcode=0;
01038   
01039   \textcolor{comment}{/* Check the parameters */}
01040   assert_param(IS_CAN_ALL_PERIPH(CANx));
01041   
01042   \textcolor{comment}{/* Get the error code*/}
01043   errorcode = (((uint8\_t)CANx->ESR) & (uint8\_t)CAN_ESR_LEC);
01044   
01045   \textcolor{comment}{/* Return the error code*/}
01046   \textcolor{keywordflow}{return} errorcode;
01047 \}
\end{DoxyCode}
\mbox{\label{group__CAN_ga85ee0c35bf7ca15d4e4c862eef534843}} 
\index{C\+AN@{C\+AN}!C\+A\+N\+\_\+\+Get\+L\+S\+B\+Transmit\+Error\+Counter@{C\+A\+N\+\_\+\+Get\+L\+S\+B\+Transmit\+Error\+Counter}}
\index{C\+A\+N\+\_\+\+Get\+L\+S\+B\+Transmit\+Error\+Counter@{C\+A\+N\+\_\+\+Get\+L\+S\+B\+Transmit\+Error\+Counter}!C\+AN@{C\+AN}}
\subsubsection{C\+A\+N\+\_\+\+Get\+L\+S\+B\+Transmit\+Error\+Counter()}
{\footnotesize\ttfamily uint8\+\_\+t C\+A\+N\+\_\+\+Get\+L\+S\+B\+Transmit\+Error\+Counter (\begin{DoxyParamCaption}\item[{\textbf{ C\+A\+N\+\_\+\+Type\+Def} $\ast$}]{C\+A\+Nx }\end{DoxyParamCaption})}



Returns the L\+SB of the 9-\/bit C\+A\+Nx Transmit Error Counter(\+T\+E\+C). 


\begin{DoxyParams}{Parameters}
{\em C\+A\+Nx} & where x can be 1 or 2 to to select the C\+AN peripheral. \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em L\+SB} & of the 9-\/bit C\+AN Transmit Error Counter. \\
\hline
\end{DoxyRetVals}


Definition at line \textbf{ 1080} of file \textbf{ stm32f4xx\+\_\+can.\+c}.


\begin{DoxyCode}
01081 \{
01082   uint8\_t counter=0;
01083   
01084   \textcolor{comment}{/* Check the parameters */}
01085   assert_param(IS_CAN_ALL_PERIPH(CANx));
01086   
01087   \textcolor{comment}{/* Get the LSB of the 9-bit CANx Transmit Error Counter(TEC) */}
01088   counter = (uint8\_t)((CANx->ESR & CAN_ESR_TEC)>> 16);
01089   
01090   \textcolor{comment}{/* Return the LSB of the 9-bit CANx Transmit Error Counter(TEC) */}
01091   \textcolor{keywordflow}{return} counter;
01092 \}
\end{DoxyCode}
\mbox{\label{group__CAN_ga6903eecbec40eb1361d915ddde9a3274}} 
\index{C\+AN@{C\+AN}!C\+A\+N\+\_\+\+Get\+Receive\+Error\+Counter@{C\+A\+N\+\_\+\+Get\+Receive\+Error\+Counter}}
\index{C\+A\+N\+\_\+\+Get\+Receive\+Error\+Counter@{C\+A\+N\+\_\+\+Get\+Receive\+Error\+Counter}!C\+AN@{C\+AN}}
\subsubsection{C\+A\+N\+\_\+\+Get\+Receive\+Error\+Counter()}
{\footnotesize\ttfamily uint8\+\_\+t C\+A\+N\+\_\+\+Get\+Receive\+Error\+Counter (\begin{DoxyParamCaption}\item[{\textbf{ C\+A\+N\+\_\+\+Type\+Def} $\ast$}]{C\+A\+Nx }\end{DoxyParamCaption})}



Returns the C\+A\+Nx Receive Error Counter (R\+EC). 

\begin{DoxyNote}{Note}
In case of an error during reception, this counter is incremented by 1 or by 8 depending on the error condition as defined by the C\+AN standard. After every successful reception, the counter is decremented by 1 or reset to 120 if its value was higher than 128. When the counter value exceeds 127, the C\+AN controller enters the error passive state. 
\end{DoxyNote}

\begin{DoxyParams}{Parameters}
{\em C\+A\+Nx} & where x can be 1 or 2 to to select the C\+AN peripheral. \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em C\+AN} & Receive Error Counter. \\
\hline
\end{DoxyRetVals}


Definition at line \textbf{ 1060} of file \textbf{ stm32f4xx\+\_\+can.\+c}.


\begin{DoxyCode}
01061 \{
01062   uint8\_t counter=0;
01063   
01064   \textcolor{comment}{/* Check the parameters */}
01065   assert_param(IS_CAN_ALL_PERIPH(CANx));
01066   
01067   \textcolor{comment}{/* Get the Receive Error Counter*/}
01068   counter = (uint8\_t)((CANx->ESR & CAN_ESR_REC)>> 24);
01069   
01070   \textcolor{comment}{/* Return the Receive Error Counter*/}
01071   \textcolor{keywordflow}{return} counter;
01072 \}
\end{DoxyCode}
\mbox{\label{group__CAN_ga9023c35a9ab931ad4513fc5d19b4bd6c}} 
\index{C\+AN@{C\+AN}!C\+A\+N\+\_\+\+Init@{C\+A\+N\+\_\+\+Init}}
\index{C\+A\+N\+\_\+\+Init@{C\+A\+N\+\_\+\+Init}!C\+AN@{C\+AN}}
\subsubsection{C\+A\+N\+\_\+\+Init()}
{\footnotesize\ttfamily uint8\+\_\+t C\+A\+N\+\_\+\+Init (\begin{DoxyParamCaption}\item[{\textbf{ C\+A\+N\+\_\+\+Type\+Def} $\ast$}]{C\+A\+Nx,  }\item[{\textbf{ C\+A\+N\+\_\+\+Init\+Type\+Def} $\ast$}]{C\+A\+N\+\_\+\+Init\+Struct }\end{DoxyParamCaption})}



Initializes the C\+AN peripheral according to the specified parameters in the C\+A\+N\+\_\+\+Init\+Struct. 


\begin{DoxyParams}{Parameters}
{\em C\+A\+Nx} & where x can be 1 or 2 to select the C\+AN peripheral. \\
\hline
{\em C\+A\+N\+\_\+\+Init\+Struct} & pointer to a \doxyref{C\+A\+N\+\_\+\+Init\+Type\+Def}{p.}{structCAN__InitTypeDef} structure that contains the configuration information for the C\+AN peripheral. \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em Constant} & indicates initialization succeed which will be C\+A\+N\+\_\+\+Init\+Status\+\_\+\+Failed or C\+A\+N\+\_\+\+Init\+Status\+\_\+\+Success. \\
\hline
\end{DoxyRetVals}


Definition at line \textbf{ 192} of file \textbf{ stm32f4xx\+\_\+can.\+c}.


\begin{DoxyCode}
00193 \{
00194   uint8\_t InitStatus = CAN_InitStatus_Failed;
00195   uint32\_t wait\_ack = 0x00000000;
00196   \textcolor{comment}{/* Check the parameters */}
00197   assert_param(IS_CAN_ALL_PERIPH(CANx));
00198   assert_param(IS_FUNCTIONAL_STATE(CAN\_InitStruct->CAN_TTCM));
00199   assert_param(IS_FUNCTIONAL_STATE(CAN\_InitStruct->CAN_ABOM));
00200   assert_param(IS_FUNCTIONAL_STATE(CAN\_InitStruct->CAN_AWUM));
00201   assert_param(IS_FUNCTIONAL_STATE(CAN\_InitStruct->CAN_NART));
00202   assert_param(IS_FUNCTIONAL_STATE(CAN\_InitStruct->CAN_RFLM));
00203   assert_param(IS_FUNCTIONAL_STATE(CAN\_InitStruct->CAN_TXFP));
00204   assert_param(IS_CAN_MODE(CAN\_InitStruct->CAN_Mode));
00205   assert_param(IS_CAN_SJW(CAN\_InitStruct->CAN_SJW));
00206   assert_param(IS_CAN_BS1(CAN\_InitStruct->CAN_BS1));
00207   assert_param(IS_CAN_BS2(CAN\_InitStruct->CAN_BS2));
00208   assert_param(IS_CAN_PRESCALER(CAN\_InitStruct->CAN_Prescaler));
00209 
00210   \textcolor{comment}{/* Exit from sleep mode */}
00211   CANx->MCR &= (~(uint32\_t)CAN_MCR_SLEEP);
00212 
00213   \textcolor{comment}{/* Request initialisation */}
00214   CANx->MCR |= CAN_MCR_INRQ ;
00215 
00216   \textcolor{comment}{/* Wait the acknowledge */}
00217   \textcolor{keywordflow}{while} (((CANx->MSR & CAN_MSR_INAK) != CAN_MSR_INAK) && (wait\_ack != 
      INAK_TIMEOUT))
00218   \{
00219     wait\_ack++;
00220   \}
00221 
00222   \textcolor{comment}{/* Check acknowledge */}
00223   \textcolor{keywordflow}{if} ((CANx->MSR & CAN_MSR_INAK) != CAN_MSR_INAK)
00224   \{
00225     InitStatus = CAN_InitStatus_Failed;
00226   \}
00227   \textcolor{keywordflow}{else} 
00228   \{
00229     \textcolor{comment}{/* Set the time triggered communication mode */}
00230     \textcolor{keywordflow}{if} (CAN\_InitStruct->CAN_TTCM == ENABLE)
00231     \{
00232       CANx->MCR |= CAN_MCR_TTCM;
00233     \}
00234     \textcolor{keywordflow}{else}
00235     \{
00236       CANx->MCR &= ~(uint32\_t)CAN_MCR_TTCM;
00237     \}
00238 
00239     \textcolor{comment}{/* Set the automatic bus-off management */}
00240     \textcolor{keywordflow}{if} (CAN\_InitStruct->CAN_ABOM == ENABLE)
00241     \{
00242       CANx->MCR |= CAN_MCR_ABOM;
00243     \}
00244     \textcolor{keywordflow}{else}
00245     \{
00246       CANx->MCR &= ~(uint32\_t)CAN_MCR_ABOM;
00247     \}
00248 
00249     \textcolor{comment}{/* Set the automatic wake-up mode */}
00250     \textcolor{keywordflow}{if} (CAN\_InitStruct->CAN_AWUM == ENABLE)
00251     \{
00252       CANx->MCR |= CAN_MCR_AWUM;
00253     \}
00254     \textcolor{keywordflow}{else}
00255     \{
00256       CANx->MCR &= ~(uint32\_t)CAN_MCR_AWUM;
00257     \}
00258 
00259     \textcolor{comment}{/* Set the no automatic retransmission */}
00260     \textcolor{keywordflow}{if} (CAN\_InitStruct->CAN_NART == ENABLE)
00261     \{
00262       CANx->MCR |= CAN_MCR_NART;
00263     \}
00264     \textcolor{keywordflow}{else}
00265     \{
00266       CANx->MCR &= ~(uint32\_t)CAN_MCR_NART;
00267     \}
00268 
00269     \textcolor{comment}{/* Set the receive FIFO locked mode */}
00270     \textcolor{keywordflow}{if} (CAN\_InitStruct->CAN_RFLM == ENABLE)
00271     \{
00272       CANx->MCR |= CAN_MCR_RFLM;
00273     \}
00274     \textcolor{keywordflow}{else}
00275     \{
00276       CANx->MCR &= ~(uint32\_t)CAN_MCR_RFLM;
00277     \}
00278 
00279     \textcolor{comment}{/* Set the transmit FIFO priority */}
00280     \textcolor{keywordflow}{if} (CAN\_InitStruct->CAN_TXFP == ENABLE)
00281     \{
00282       CANx->MCR |= CAN_MCR_TXFP;
00283     \}
00284     \textcolor{keywordflow}{else}
00285     \{
00286       CANx->MCR &= ~(uint32\_t)CAN_MCR_TXFP;
00287     \}
00288 
00289     \textcolor{comment}{/* Set the bit timing register */}
00290     CANx->BTR = (uint32\_t)((uint32\_t)CAN\_InitStruct->CAN_Mode << 30) | \(\backslash\)
00291                 ((uint32\_t)CAN\_InitStruct->CAN_SJW << 24) | \(\backslash\)
00292                 ((uint32\_t)CAN\_InitStruct->CAN_BS1 << 16) | \(\backslash\)
00293                 ((uint32\_t)CAN\_InitStruct->CAN_BS2 << 20) | \(\backslash\)
00294                ((uint32\_t)CAN\_InitStruct->CAN_Prescaler - 1);
00295 
00296     \textcolor{comment}{/* Request leave initialisation */}
00297     CANx->MCR &= ~(uint32\_t)CAN_MCR_INRQ;
00298 
00299    \textcolor{comment}{/* Wait the acknowledge */}
00300    wait\_ack = 0;
00301 
00302    \textcolor{keywordflow}{while} (((CANx->MSR & CAN_MSR_INAK) == CAN_MSR_INAK) && (wait\_ack != 
      INAK_TIMEOUT))
00303    \{
00304      wait\_ack++;
00305    \}
00306 
00307     \textcolor{comment}{/* ...and check acknowledged */}
00308     \textcolor{keywordflow}{if} ((CANx->MSR & CAN_MSR_INAK) == CAN_MSR_INAK)
00309     \{
00310       InitStatus = CAN_InitStatus_Failed;
00311     \}
00312     \textcolor{keywordflow}{else}
00313     \{
00314       InitStatus = CAN_InitStatus_Success ;
00315     \}
00316   \}
00317 
00318   \textcolor{comment}{/* At this step, return the status of initialization */}
00319   \textcolor{keywordflow}{return} InitStatus;
00320 \}
\end{DoxyCode}
\mbox{\label{group__CAN_gad1a8b2499a780b5bfa4accb3597b02f4}} 
\index{C\+AN@{C\+AN}!C\+A\+N\+\_\+\+I\+T\+Config@{C\+A\+N\+\_\+\+I\+T\+Config}}
\index{C\+A\+N\+\_\+\+I\+T\+Config@{C\+A\+N\+\_\+\+I\+T\+Config}!C\+AN@{C\+AN}}
\subsubsection{C\+A\+N\+\_\+\+I\+T\+Config()}
{\footnotesize\ttfamily void C\+A\+N\+\_\+\+I\+T\+Config (\begin{DoxyParamCaption}\item[{\textbf{ C\+A\+N\+\_\+\+Type\+Def} $\ast$}]{C\+A\+Nx,  }\item[{uint32\+\_\+t}]{C\+A\+N\+\_\+\+IT,  }\item[{\textbf{ Functional\+State}}]{New\+State }\end{DoxyParamCaption})}



Enables or disables the specified C\+A\+Nx interrupts. 


\begin{DoxyParams}{Parameters}
{\em C\+A\+Nx} & where x can be 1 or 2 to to select the C\+AN peripheral. \\
\hline
{\em C\+A\+N\+\_\+\+IT} & specifies the C\+AN interrupt sources to be enabled or disabled. This parameter can be\+: \begin{DoxyItemize}
\item C\+A\+N\+\_\+\+I\+T\+\_\+\+T\+ME\+: Transmit mailbox empty Interrupt \item C\+A\+N\+\_\+\+I\+T\+\_\+\+F\+M\+P0\+: F\+I\+FO 0 message pending Interrupt \item C\+A\+N\+\_\+\+I\+T\+\_\+\+F\+F0\+: F\+I\+FO 0 full Interrupt \item C\+A\+N\+\_\+\+I\+T\+\_\+\+F\+O\+V0\+: F\+I\+FO 0 overrun Interrupt \item C\+A\+N\+\_\+\+I\+T\+\_\+\+F\+M\+P1\+: F\+I\+FO 1 message pending Interrupt \item C\+A\+N\+\_\+\+I\+T\+\_\+\+F\+F1\+: F\+I\+FO 1 full Interrupt \item C\+A\+N\+\_\+\+I\+T\+\_\+\+F\+O\+V1\+: F\+I\+FO 1 overrun Interrupt \item C\+A\+N\+\_\+\+I\+T\+\_\+\+W\+KU\+: Wake-\/up Interrupt \item C\+A\+N\+\_\+\+I\+T\+\_\+\+S\+LK\+: Sleep acknowledge Interrupt \item C\+A\+N\+\_\+\+I\+T\+\_\+\+E\+WG\+: Error warning Interrupt \item C\+A\+N\+\_\+\+I\+T\+\_\+\+E\+PV\+: Error passive Interrupt \item C\+A\+N\+\_\+\+I\+T\+\_\+\+B\+OF\+: Bus-\/off Interrupt \item C\+A\+N\+\_\+\+I\+T\+\_\+\+L\+EC\+: Last error code Interrupt \item C\+A\+N\+\_\+\+I\+T\+\_\+\+E\+RR\+: Error Interrupt \end{DoxyItemize}
\\
\hline
{\em New\+State} & new state of the C\+AN interrupts. This parameter can be\+: E\+N\+A\+B\+LE or D\+I\+S\+A\+B\+LE. \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em None} & \\
\hline
\end{DoxyRetVals}


Definition at line \textbf{ 1287} of file \textbf{ stm32f4xx\+\_\+can.\+c}.



References \textbf{ D\+I\+S\+A\+B\+LE}.


\begin{DoxyCode}
01288 \{
01289   \textcolor{comment}{/* Check the parameters */}
01290   assert_param(IS_CAN_ALL_PERIPH(CANx));
01291   assert_param(IS_CAN_IT(CAN\_IT));
01292   assert_param(IS_FUNCTIONAL_STATE(NewState));
01293 
01294   \textcolor{keywordflow}{if} (NewState != DISABLE)
01295   \{
01296     \textcolor{comment}{/* Enable the selected CANx interrupt */}
01297     CANx->IER |= CAN\_IT;
01298   \}
01299   \textcolor{keywordflow}{else}
01300   \{
01301     \textcolor{comment}{/* Disable the selected CANx interrupt */}
01302     CANx->IER &= ~CAN\_IT;
01303   \}
01304 \}
\end{DoxyCode}
\mbox{\label{group__CAN_ga7100459a95ce1b3cfe8ab15e112029fe}} 
\index{C\+AN@{C\+AN}!C\+A\+N\+\_\+\+Message\+Pending@{C\+A\+N\+\_\+\+Message\+Pending}}
\index{C\+A\+N\+\_\+\+Message\+Pending@{C\+A\+N\+\_\+\+Message\+Pending}!C\+AN@{C\+AN}}
\subsubsection{C\+A\+N\+\_\+\+Message\+Pending()}
{\footnotesize\ttfamily uint8\+\_\+t C\+A\+N\+\_\+\+Message\+Pending (\begin{DoxyParamCaption}\item[{\textbf{ C\+A\+N\+\_\+\+Type\+Def} $\ast$}]{C\+A\+Nx,  }\item[{uint8\+\_\+t}]{F\+I\+F\+O\+Number }\end{DoxyParamCaption})}



Returns the number of pending received messages. 


\begin{DoxyParams}{Parameters}
{\em C\+A\+Nx} & where x can be 1 or 2 to select the C\+AN peripheral. \\
\hline
{\em F\+I\+F\+O\+Number} & Receive F\+I\+FO number, C\+A\+N\+\_\+\+F\+I\+F\+O0 or C\+A\+N\+\_\+\+F\+I\+F\+O1. \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em Nb\+Message} & \+: which is the number of pending message. \\
\hline
\end{DoxyRetVals}


Definition at line \textbf{ 817} of file \textbf{ stm32f4xx\+\_\+can.\+c}.


\begin{DoxyCode}
00818 \{
00819   uint8\_t message\_pending=0;
00820   \textcolor{comment}{/* Check the parameters */}
00821   assert_param(IS_CAN_ALL_PERIPH(CANx));
00822   assert_param(IS_CAN_FIFO(FIFONumber));
00823   \textcolor{keywordflow}{if} (FIFONumber == CAN_FIFO0)
00824   \{
00825     message\_pending = (uint8\_t)(CANx->RF0R&(uint32\_t)0x03);
00826   \}
00827   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (FIFONumber == CAN_FIFO1)
00828   \{
00829     message\_pending = (uint8\_t)(CANx->RF1R&(uint32\_t)0x03);
00830   \}
00831   \textcolor{keywordflow}{else}
00832   \{
00833     message\_pending = 0;
00834   \}
00835   \textcolor{keywordflow}{return} message\_pending;
00836 \}
\end{DoxyCode}
\mbox{\label{group__CAN_gab2a3630e9e3024114eb117d14e514208}} 
\index{C\+AN@{C\+AN}!C\+A\+N\+\_\+\+Operating\+Mode\+Request@{C\+A\+N\+\_\+\+Operating\+Mode\+Request}}
\index{C\+A\+N\+\_\+\+Operating\+Mode\+Request@{C\+A\+N\+\_\+\+Operating\+Mode\+Request}!C\+AN@{C\+AN}}
\subsubsection{C\+A\+N\+\_\+\+Operating\+Mode\+Request()}
{\footnotesize\ttfamily uint8\+\_\+t C\+A\+N\+\_\+\+Operating\+Mode\+Request (\begin{DoxyParamCaption}\item[{\textbf{ C\+A\+N\+\_\+\+Type\+Def} $\ast$}]{C\+A\+Nx,  }\item[{uint8\+\_\+t}]{C\+A\+N\+\_\+\+Operating\+Mode }\end{DoxyParamCaption})}



Selects the C\+AN Operation mode. 


\begin{DoxyParams}{Parameters}
{\em C\+A\+N\+\_\+\+Operating\+Mode} & C\+AN Operating Mode. This parameter can be one of C\+A\+N\+\_\+\+Operating\+Mode\+\_\+\+Type\+Def enumeration. \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em status} & of the requested mode which can be
\begin{DoxyItemize}
\item C\+A\+N\+\_\+\+Mode\+Status\+\_\+\+Failed\+: C\+AN failed entering the specific mode
\item C\+A\+N\+\_\+\+Mode\+Status\+\_\+\+Success\+: C\+AN Succeed entering the specific mode 
\end{DoxyItemize}\\
\hline
\end{DoxyRetVals}


Definition at line \textbf{ 867} of file \textbf{ stm32f4xx\+\_\+can.\+c}.


\begin{DoxyCode}
00868 \{
00869   uint8\_t status = CAN_ModeStatus_Failed;
00870   
00871   \textcolor{comment}{/* Timeout for INAK or also for SLAK bits*/}
00872   uint32\_t timeout = INAK_TIMEOUT; 
00873 
00874   \textcolor{comment}{/* Check the parameters */}
00875   assert_param(IS_CAN_ALL_PERIPH(CANx));
00876   assert_param(IS_CAN_OPERATING_MODE(CAN\_OperatingMode));
00877 
00878   \textcolor{keywordflow}{if} (CAN\_OperatingMode == CAN_OperatingMode_Initialization)
00879   \{
00880     \textcolor{comment}{/* Request initialisation */}
00881     CANx->MCR = (uint32\_t)((CANx->MCR & (uint32\_t)(~(uint32\_t)CAN_MCR_SLEEP)) | 
      CAN_MCR_INRQ);
00882 
00883     \textcolor{comment}{/* Wait the acknowledge */}
00884     \textcolor{keywordflow}{while} (((CANx->MSR & CAN_MODE_MASK) != CAN_MSR_INAK) && (timeout != 0))
00885     \{
00886       timeout--;
00887     \}
00888     \textcolor{keywordflow}{if} ((CANx->MSR & CAN_MODE_MASK) != CAN_MSR_INAK)
00889     \{
00890       status = CAN_ModeStatus_Failed;
00891     \}
00892     \textcolor{keywordflow}{else}
00893     \{
00894       status = CAN_ModeStatus_Success;
00895     \}
00896   \}
00897   \textcolor{keywordflow}{else}  \textcolor{keywordflow}{if} (CAN\_OperatingMode == CAN_OperatingMode_Normal)
00898   \{
00899     \textcolor{comment}{/* Request leave initialisation and sleep mode  and enter Normal mode */}
00900     CANx->MCR &= (uint32\_t)(~(CAN\_MCR\_SLEEP|CAN_MCR_INRQ));
00901 
00902     \textcolor{comment}{/* Wait the acknowledge */}
00903     \textcolor{keywordflow}{while} (((CANx->MSR & CAN_MODE_MASK) != 0) && (timeout!=0))
00904     \{
00905       timeout--;
00906     \}
00907     \textcolor{keywordflow}{if} ((CANx->MSR & CAN_MODE_MASK) != 0)
00908     \{
00909       status = CAN_ModeStatus_Failed;
00910     \}
00911     \textcolor{keywordflow}{else}
00912     \{
00913       status = CAN_ModeStatus_Success;
00914     \}
00915   \}
00916   \textcolor{keywordflow}{else}  \textcolor{keywordflow}{if} (CAN\_OperatingMode == CAN_OperatingMode_Sleep)
00917   \{
00918     \textcolor{comment}{/* Request Sleep mode */}
00919     CANx->MCR = (uint32\_t)((CANx->MCR & (uint32\_t)(~(uint32\_t)CAN_MCR_INRQ)) | CAN\_MCR\_SLEEP);
00920 
00921     \textcolor{comment}{/* Wait the acknowledge */}
00922     \textcolor{keywordflow}{while} (((CANx->MSR & CAN_MODE_MASK) != CAN_MSR_SLAK) && (timeout!=0))
00923     \{
00924       timeout--;
00925     \}
00926     \textcolor{keywordflow}{if} ((CANx->MSR & CAN_MODE_MASK) != CAN_MSR_SLAK)
00927     \{
00928       status = CAN_ModeStatus_Failed;
00929     \}
00930     \textcolor{keywordflow}{else}
00931     \{
00932       status = CAN_ModeStatus_Success;
00933     \}
00934   \}
00935   \textcolor{keywordflow}{else}
00936   \{
00937     status = CAN_ModeStatus_Failed;
00938   \}
00939 
00940   \textcolor{keywordflow}{return}  (uint8\_t) status;
00941 \}
\end{DoxyCode}
\mbox{\label{group__CAN_ga351b90bb8a3bb0c846f85bbd56ef4dc8}} 
\index{C\+AN@{C\+AN}!C\+A\+N\+\_\+\+Receive@{C\+A\+N\+\_\+\+Receive}}
\index{C\+A\+N\+\_\+\+Receive@{C\+A\+N\+\_\+\+Receive}!C\+AN@{C\+AN}}
\subsubsection{C\+A\+N\+\_\+\+Receive()}
{\footnotesize\ttfamily void C\+A\+N\+\_\+\+Receive (\begin{DoxyParamCaption}\item[{\textbf{ C\+A\+N\+\_\+\+Type\+Def} $\ast$}]{C\+A\+Nx,  }\item[{uint8\+\_\+t}]{F\+I\+F\+O\+Number,  }\item[{\textbf{ Can\+Rx\+Msg} $\ast$}]{Rx\+Message }\end{DoxyParamCaption})}



Receives a correct C\+AN frame. 


\begin{DoxyParams}{Parameters}
{\em C\+A\+Nx} & where x can be 1 or 2 to select the C\+AN peripheral. \\
\hline
{\em F\+I\+F\+O\+Number} & Receive F\+I\+FO number, C\+A\+N\+\_\+\+F\+I\+F\+O0 or C\+A\+N\+\_\+\+F\+I\+F\+O1. \\
\hline
{\em Rx\+Message} & pointer to a structure receive frame which contains C\+AN Id, C\+AN D\+LC, C\+AN data and F\+MI number. \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em None} & \\
\hline
\end{DoxyRetVals}


Definition at line \textbf{ 745} of file \textbf{ stm32f4xx\+\_\+can.\+c}.



References \textbf{ Can\+Rx\+Msg\+::\+I\+DE}.


\begin{DoxyCode}
00746 \{
00747   \textcolor{comment}{/* Check the parameters */}
00748   assert_param(IS_CAN_ALL_PERIPH(CANx));
00749   assert_param(IS_CAN_FIFO(FIFONumber));
00750   \textcolor{comment}{/* Get the Id */}
00751   RxMessage->IDE = (uint8\_t)0x04 & CANx->sFIFOMailBox[FIFONumber].RIR;
00752   if (RxMessage->IDE == CAN_Id_Standard)
00753   \{
00754     RxMessage->StdId = (uint32\_t)0x000007FF & (CANx->sFIFOMailBox[FIFONumber].
      RIR >> 21);
00755   \}
00756   \textcolor{keywordflow}{else}
00757   \{
00758     RxMessage->ExtId = (uint32\_t)0x1FFFFFFF & (CANx->sFIFOMailBox[FIFONumber].
      RIR >> 3);
00759   \}
00760   
00761   RxMessage->RTR = (uint8\_t)0x02 & CANx->sFIFOMailBox[FIFONumber].RIR;
00762   \textcolor{comment}{/* Get the DLC */}
00763   RxMessage->DLC = (uint8\_t)0x0F & CANx->sFIFOMailBox[FIFONumber].RDTR;
00764   \textcolor{comment}{/* Get the FMI */}
00765   RxMessage->FMI = (uint8\_t)0xFF & (CANx->sFIFOMailBox[FIFONumber].RDTR >> 8);
00766   \textcolor{comment}{/* Get the data field */}
00767   RxMessage->Data[0] = (uint8\_t)0xFF & CANx->sFIFOMailBox[FIFONumber].RDLR;
00768   RxMessage->Data[1] = (uint8\_t)0xFF & (CANx->sFIFOMailBox[FIFONumber].RDLR >> 8);
00769   RxMessage->Data[2] = (uint8\_t)0xFF & (CANx->sFIFOMailBox[FIFONumber].RDLR >> 16);
00770   RxMessage->Data[3] = (uint8\_t)0xFF & (CANx->sFIFOMailBox[FIFONumber].RDLR >> 24);
00771   RxMessage->Data[4] = (uint8\_t)0xFF & CANx->sFIFOMailBox[FIFONumber].RDHR;
00772   RxMessage->Data[5] = (uint8\_t)0xFF & (CANx->sFIFOMailBox[FIFONumber].RDHR >> 8);
00773   RxMessage->Data[6] = (uint8\_t)0xFF & (CANx->sFIFOMailBox[FIFONumber].RDHR >> 16);
00774   RxMessage->Data[7] = (uint8\_t)0xFF & (CANx->sFIFOMailBox[FIFONumber].RDHR >> 24);
00775   \textcolor{comment}{/* Release the FIFO */}
00776   \textcolor{comment}{/* Release FIFO0 */}
00777   \textcolor{keywordflow}{if} (FIFONumber == CAN_FIFO0)
00778   \{
00779     CANx->RF0R |= CAN_RF0R_RFOM0;
00780   \}
00781   \textcolor{comment}{/* Release FIFO1 */}
00782   \textcolor{keywordflow}{else} \textcolor{comment}{/* FIFONumber == CAN\_FIFO1 */}
00783   \{
00784     CANx->RF1R |= CAN_RF1R_RFOM1;
00785   \}
00786 \}
\end{DoxyCode}
\mbox{\label{group__CAN_ga109ff8960bc59f44b984c9646f17b3c0}} 
\index{C\+AN@{C\+AN}!C\+A\+N\+\_\+\+Slave\+Start\+Bank@{C\+A\+N\+\_\+\+Slave\+Start\+Bank}}
\index{C\+A\+N\+\_\+\+Slave\+Start\+Bank@{C\+A\+N\+\_\+\+Slave\+Start\+Bank}!C\+AN@{C\+AN}}
\subsubsection{C\+A\+N\+\_\+\+Slave\+Start\+Bank()}
{\footnotesize\ttfamily void C\+A\+N\+\_\+\+Slave\+Start\+Bank (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{C\+A\+N\+\_\+\+Bank\+Number }\end{DoxyParamCaption})}



Select the start bank filter for slave C\+AN. 


\begin{DoxyParams}{Parameters}
{\em C\+A\+N\+\_\+\+Bank\+Number} & Select the start slave bank filter from 1..27. \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em None} & \\
\hline
\end{DoxyRetVals}


Definition at line \textbf{ 463} of file \textbf{ stm32f4xx\+\_\+can.\+c}.


\begin{DoxyCode}
00464 \{
00465   \textcolor{comment}{/* Check the parameters */}
00466   assert_param(IS_CAN_BANKNUMBER(CAN\_BankNumber));
00467   
00468   \textcolor{comment}{/* Enter Initialisation mode for the filter */}
00469   CAN1->FMR |= FMR_FINIT;
00470   
00471   \textcolor{comment}{/* Select the start slave bank */}
00472   CAN1->FMR &= (uint32\_t)0xFFFFC0F1 ;
00473   CAN1->FMR |= (uint32\_t)(CAN\_BankNumber)<<8;
00474   
00475   \textcolor{comment}{/* Leave Initialisation mode for the filter */}
00476   CAN1->FMR &= ~FMR_FINIT;
00477 \}
\end{DoxyCode}
\mbox{\label{group__CAN_ga640215e38765759d7eceb8a039046667}} 
\index{C\+AN@{C\+AN}!C\+A\+N\+\_\+\+Sleep@{C\+A\+N\+\_\+\+Sleep}}
\index{C\+A\+N\+\_\+\+Sleep@{C\+A\+N\+\_\+\+Sleep}!C\+AN@{C\+AN}}
\subsubsection{C\+A\+N\+\_\+\+Sleep()}
{\footnotesize\ttfamily uint8\+\_\+t C\+A\+N\+\_\+\+Sleep (\begin{DoxyParamCaption}\item[{\textbf{ C\+A\+N\+\_\+\+Type\+Def} $\ast$}]{C\+A\+Nx }\end{DoxyParamCaption})}



Enters the Sleep (low power) mode. 


\begin{DoxyParams}{Parameters}
{\em C\+A\+Nx} & where x can be 1 or 2 to select the C\+AN peripheral. \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em C\+A\+N\+\_\+\+Sleep\+\_\+\+Ok} & if sleep entered, C\+A\+N\+\_\+\+Sleep\+\_\+\+Failed otherwise. \\
\hline
\end{DoxyRetVals}


Definition at line \textbf{ 948} of file \textbf{ stm32f4xx\+\_\+can.\+c}.


\begin{DoxyCode}
00949 \{
00950   uint8\_t sleepstatus = CAN_Sleep_Failed;
00951   
00952   \textcolor{comment}{/* Check the parameters */}
00953   assert_param(IS_CAN_ALL_PERIPH(CANx));
00954     
00955   \textcolor{comment}{/* Request Sleep mode */}
00956    CANx->MCR = (((CANx->MCR) & (uint32\_t)(~(uint32\_t)CAN_MCR_INRQ)) | 
      CAN_MCR_SLEEP);
00957    
00958   \textcolor{comment}{/* Sleep mode status */}
00959   \textcolor{keywordflow}{if} ((CANx->MSR & (CAN_MSR_SLAK|CAN_MSR_INAK)) == CAN_MSR_SLAK)
00960   \{
00961     \textcolor{comment}{/* Sleep mode not entered */}
00962     sleepstatus =  CAN_Sleep_Ok;
00963   \}
00964   \textcolor{comment}{/* return sleep mode status */}
00965    \textcolor{keywordflow}{return} (uint8\_t)sleepstatus;
00966 \}
\end{DoxyCode}
\mbox{\label{group__CAN_gad77ad810868ed111755fc9e8ae0c7646}} 
\index{C\+AN@{C\+AN}!C\+A\+N\+\_\+\+Struct\+Init@{C\+A\+N\+\_\+\+Struct\+Init}}
\index{C\+A\+N\+\_\+\+Struct\+Init@{C\+A\+N\+\_\+\+Struct\+Init}!C\+AN@{C\+AN}}
\subsubsection{C\+A\+N\+\_\+\+Struct\+Init()}
{\footnotesize\ttfamily void C\+A\+N\+\_\+\+Struct\+Init (\begin{DoxyParamCaption}\item[{\textbf{ C\+A\+N\+\_\+\+Init\+Type\+Def} $\ast$}]{C\+A\+N\+\_\+\+Init\+Struct }\end{DoxyParamCaption})}



Fills each C\+A\+N\+\_\+\+Init\+Struct member with its default value. 


\begin{DoxyParams}{Parameters}
{\em C\+A\+N\+\_\+\+Init\+Struct} & pointer to a \doxyref{C\+A\+N\+\_\+\+Init\+Type\+Def}{p.}{structCAN__InitTypeDef} structure which ill be initialized. \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em None} & \\
\hline
\end{DoxyRetVals}


Definition at line \textbf{ 420} of file \textbf{ stm32f4xx\+\_\+can.\+c}.



References \textbf{ C\+A\+N\+\_\+\+Init\+Type\+Def\+::\+C\+A\+N\+\_\+\+A\+B\+OM}, \textbf{ C\+A\+N\+\_\+\+Init\+Type\+Def\+::\+C\+A\+N\+\_\+\+A\+W\+UM}, \textbf{ C\+A\+N\+\_\+\+Init\+Type\+Def\+::\+C\+A\+N\+\_\+\+B\+S1}, \textbf{ C\+A\+N\+\_\+\+Init\+Type\+Def\+::\+C\+A\+N\+\_\+\+B\+S2}, \textbf{ C\+A\+N\+\_\+\+Init\+Type\+Def\+::\+C\+A\+N\+\_\+\+Mode}, \textbf{ C\+A\+N\+\_\+\+Init\+Type\+Def\+::\+C\+A\+N\+\_\+\+N\+A\+RT}, \textbf{ C\+A\+N\+\_\+\+Init\+Type\+Def\+::\+C\+A\+N\+\_\+\+Prescaler}, \textbf{ C\+A\+N\+\_\+\+Init\+Type\+Def\+::\+C\+A\+N\+\_\+\+R\+F\+LM}, \textbf{ C\+A\+N\+\_\+\+Init\+Type\+Def\+::\+C\+A\+N\+\_\+\+S\+JW}, \textbf{ C\+A\+N\+\_\+\+Init\+Type\+Def\+::\+C\+A\+N\+\_\+\+T\+T\+CM}, \textbf{ C\+A\+N\+\_\+\+Init\+Type\+Def\+::\+C\+A\+N\+\_\+\+T\+X\+FP}, and \textbf{ D\+I\+S\+A\+B\+LE}.


\begin{DoxyCode}
00421 \{
00422   \textcolor{comment}{/* Reset CAN init structure parameters values */}
00423   
00424   \textcolor{comment}{/* Initialize the time triggered communication mode */}
00425   CAN\_InitStruct->CAN_TTCM = DISABLE;
00426   
00427   \textcolor{comment}{/* Initialize the automatic bus-off management */}
00428   CAN\_InitStruct->CAN_ABOM = DISABLE;
00429   
00430   \textcolor{comment}{/* Initialize the automatic wake-up mode */}
00431   CAN\_InitStruct->CAN_AWUM = DISABLE;
00432   
00433   \textcolor{comment}{/* Initialize the no automatic retransmission */}
00434   CAN\_InitStruct->CAN_NART = DISABLE;
00435   
00436   \textcolor{comment}{/* Initialize the receive FIFO locked mode */}
00437   CAN\_InitStruct->CAN_RFLM = DISABLE;
00438   
00439   \textcolor{comment}{/* Initialize the transmit FIFO priority */}
00440   CAN\_InitStruct->CAN_TXFP = DISABLE;
00441   
00442   \textcolor{comment}{/* Initialize the CAN\_Mode member */}
00443   CAN\_InitStruct->CAN_Mode = CAN_Mode_Normal;
00444   
00445   \textcolor{comment}{/* Initialize the CAN\_SJW member */}
00446   CAN\_InitStruct->CAN_SJW = CAN_SJW_1tq;
00447   
00448   \textcolor{comment}{/* Initialize the CAN\_BS1 member */}
00449   CAN\_InitStruct->CAN_BS1 = CAN_BS1_4tq;
00450   
00451   \textcolor{comment}{/* Initialize the CAN\_BS2 member */}
00452   CAN\_InitStruct->CAN_BS2 = CAN_BS2_3tq;
00453   
00454   \textcolor{comment}{/* Initialize the CAN\_Prescaler member */}
00455   CAN\_InitStruct->CAN_Prescaler = 1;
00456 \}
\end{DoxyCode}
\mbox{\label{group__CAN_gaccfcb81f76f58400077c7b2d8641dd83}} 
\index{C\+AN@{C\+AN}!C\+A\+N\+\_\+\+Transmit@{C\+A\+N\+\_\+\+Transmit}}
\index{C\+A\+N\+\_\+\+Transmit@{C\+A\+N\+\_\+\+Transmit}!C\+AN@{C\+AN}}
\subsubsection{C\+A\+N\+\_\+\+Transmit()}
{\footnotesize\ttfamily uint8\+\_\+t C\+A\+N\+\_\+\+Transmit (\begin{DoxyParamCaption}\item[{\textbf{ C\+A\+N\+\_\+\+Type\+Def} $\ast$}]{C\+A\+Nx,  }\item[{\textbf{ Can\+Tx\+Msg} $\ast$}]{Tx\+Message }\end{DoxyParamCaption})}



Initiates and transmits a C\+AN frame message. 


\begin{DoxyParams}{Parameters}
{\em C\+A\+Nx} & where x can be 1 or 2 to to select the C\+AN peripheral. \\
\hline
{\em Tx\+Message} & pointer to a structure which contains C\+AN Id, C\+AN D\+LC and C\+AN data. \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em The} & number of the mailbox that is used for transmission or C\+A\+N\+\_\+\+Tx\+Status\+\_\+\+No\+Mail\+Box if there is no empty mailbox. \\
\hline
\end{DoxyRetVals}


Definition at line \textbf{ 572} of file \textbf{ stm32f4xx\+\_\+can.\+c}.



References \textbf{ Can\+Tx\+Msg\+::\+D\+LC}, and \textbf{ Can\+Tx\+Msg\+::\+I\+DE}.


\begin{DoxyCode}
00573 \{
00574   uint8\_t transmit\_mailbox = 0;
00575   \textcolor{comment}{/* Check the parameters */}
00576   assert_param(IS_CAN_ALL_PERIPH(CANx));
00577   assert_param(IS_CAN_IDTYPE(TxMessage->IDE));
00578   assert_param(IS_CAN_RTR(TxMessage->RTR));
00579   assert_param(IS_CAN_DLC(TxMessage->DLC));
00580 
00581   \textcolor{comment}{/* Select one empty transmit mailbox */}
00582   \textcolor{keywordflow}{if} ((CANx->TSR&CAN_TSR_TME0) == CAN_TSR_TME0)
00583   \{
00584     transmit\_mailbox = 0;
00585   \}
00586   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((CANx->TSR&CAN_TSR_TME1) == CAN_TSR_TME1)
00587   \{
00588     transmit\_mailbox = 1;
00589   \}
00590   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((CANx->TSR&CAN_TSR_TME2) == CAN_TSR_TME2)
00591   \{
00592     transmit\_mailbox = 2;
00593   \}
00594   \textcolor{keywordflow}{else}
00595   \{
00596     transmit\_mailbox = CAN_TxStatus_NoMailBox;
00597   \}
00598 
00599   \textcolor{keywordflow}{if} (transmit\_mailbox != CAN_TxStatus_NoMailBox)
00600   \{
00601     \textcolor{comment}{/* Set up the Id */}
00602     CANx->sTxMailBox[transmit\_mailbox].TIR &= TMIDxR_TXRQ;
00603     \textcolor{keywordflow}{if} (TxMessage->IDE == CAN_Id_Standard)
00604     \{
00605       assert_param(IS_CAN_STDID(TxMessage->StdId));  
00606       CANx->sTxMailBox[transmit\_mailbox].TIR |= ((TxMessage->StdId << 21) | \(\backslash\)
00607                                                   TxMessage->RTR);
00608     \}
00609     \textcolor{keywordflow}{else}
00610     \{
00611       assert_param(IS_CAN_EXTID(TxMessage->ExtId));
00612       CANx->sTxMailBox[transmit\_mailbox].TIR |= ((TxMessage->ExtId << 3) | \(\backslash\)
00613                                                   TxMessage->IDE | \(\backslash\)
00614                                                   TxMessage->RTR);
00615     \}
00616     
00617     \textcolor{comment}{/* Set up the DLC */}
00618     TxMessage->DLC &= (uint8\_t)0x0000000F;
00619     CANx->sTxMailBox[transmit\_mailbox].TDTR &= (uint32\_t)0xFFFFFFF0;
00620     CANx->sTxMailBox[transmit\_mailbox].TDTR |= TxMessage->DLC;
00621 
00622     \textcolor{comment}{/* Set up the data field */}
00623     CANx->sTxMailBox[transmit\_mailbox].TDLR = (((uint32\_t)TxMessage->Data[3] << 24) | 
00624                                              ((uint32\_t)TxMessage->Data[2] << 16) |
00625                                              ((uint32\_t)TxMessage->Data[1] << 8) | 
00626                                              ((uint32\_t)TxMessage->Data[0]));
00627     CANx->sTxMailBox[transmit\_mailbox].TDHR = (((uint32\_t)TxMessage->Data[7] << 24) | 
00628                                              ((uint32\_t)TxMessage->Data[6] << 16) |
00629                                              ((uint32\_t)TxMessage->Data[5] << 8) |
00630                                              ((uint32\_t)TxMessage->Data[4]));
00631     \textcolor{comment}{/* Request transmission */}
00632     CANx->sTxMailBox[transmit\_mailbox].TIR |= TMIDxR_TXRQ;
00633   \}
00634   \textcolor{keywordflow}{return} transmit\_mailbox;
00635 \}
\end{DoxyCode}
\mbox{\label{group__CAN_ga68ab05a0a6cdfcc2b6f6b6b2c10848e2}} 
\index{C\+AN@{C\+AN}!C\+A\+N\+\_\+\+Transmit\+Status@{C\+A\+N\+\_\+\+Transmit\+Status}}
\index{C\+A\+N\+\_\+\+Transmit\+Status@{C\+A\+N\+\_\+\+Transmit\+Status}!C\+AN@{C\+AN}}
\subsubsection{C\+A\+N\+\_\+\+Transmit\+Status()}
{\footnotesize\ttfamily uint8\+\_\+t C\+A\+N\+\_\+\+Transmit\+Status (\begin{DoxyParamCaption}\item[{\textbf{ C\+A\+N\+\_\+\+Type\+Def} $\ast$}]{C\+A\+Nx,  }\item[{uint8\+\_\+t}]{Transmit\+Mailbox }\end{DoxyParamCaption})}



Checks the transmission status of a C\+AN Frame. 


\begin{DoxyParams}{Parameters}
{\em C\+A\+Nx} & where x can be 1 or 2 to select the C\+AN peripheral. \\
\hline
{\em Transmit\+Mailbox} & the number of the mailbox that is used for transmission. \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em C\+A\+N\+\_\+\+Tx\+Status\+\_\+\+Ok} & if the C\+AN driver transmits the message, C\+A\+N\+\_\+\+Tx\+Status\+\_\+\+Failed in an other case. \\
\hline
\end{DoxyRetVals}


Definition at line \textbf{ 644} of file \textbf{ stm32f4xx\+\_\+can.\+c}.


\begin{DoxyCode}
00645 \{
00646   uint32\_t state = 0;
00647 
00648   \textcolor{comment}{/* Check the parameters */}
00649   assert_param(IS_CAN_ALL_PERIPH(CANx));
00650   assert_param(IS_CAN_TRANSMITMAILBOX(TransmitMailbox));
00651  
00652   \textcolor{keywordflow}{switch} (TransmitMailbox)
00653   \{
00654     \textcolor{keywordflow}{case} (CAN_TXMAILBOX_0): 
00655       state =   CANx->TSR &  (CAN_TSR_RQCP0 | CAN_TSR_TXOK0 | CAN_TSR_TME0);
00656       \textcolor{keywordflow}{break};
00657     \textcolor{keywordflow}{case} (CAN_TXMAILBOX_1): 
00658       state =   CANx->TSR &  (CAN_TSR_RQCP1 | CAN_TSR_TXOK1 | CAN_TSR_TME1);
00659       \textcolor{keywordflow}{break};
00660     \textcolor{keywordflow}{case} (CAN_TXMAILBOX_2): 
00661       state =   CANx->TSR &  (CAN_TSR_RQCP2 | CAN_TSR_TXOK2 | CAN_TSR_TME2);
00662       \textcolor{keywordflow}{break};
00663     \textcolor{keywordflow}{default}:
00664       state = CAN_TxStatus_Failed;
00665       \textcolor{keywordflow}{break};
00666   \}
00667   \textcolor{keywordflow}{switch} (state)
00668   \{
00669       \textcolor{comment}{/* transmit pending  */}
00670     \textcolor{keywordflow}{case} (0x0): state = CAN_TxStatus_Pending;
00671       \textcolor{keywordflow}{break};
00672       \textcolor{comment}{/* transmit failed  */}
00673      \textcolor{keywordflow}{case} (CAN_TSR_RQCP0 | CAN_TSR_TME0): state = CAN_TxStatus_Failed;
00674       \textcolor{keywordflow}{break};
00675      \textcolor{keywordflow}{case} (CAN_TSR_RQCP1 | CAN_TSR_TME1): state = CAN_TxStatus_Failed;
00676       \textcolor{keywordflow}{break};
00677      \textcolor{keywordflow}{case} (CAN_TSR_RQCP2 | CAN_TSR_TME2): state = CAN_TxStatus_Failed;
00678       \textcolor{keywordflow}{break};
00679       \textcolor{comment}{/* transmit succeeded  */}
00680     \textcolor{keywordflow}{case} (CAN_TSR_RQCP0 | CAN_TSR_TXOK0 | CAN_TSR_TME0):state = CAN_TxStatus_Ok;
00681       \textcolor{keywordflow}{break};
00682     \textcolor{keywordflow}{case} (CAN_TSR_RQCP1 | CAN_TSR_TXOK1 | CAN_TSR_TME1):state = CAN_TxStatus_Ok;
00683       \textcolor{keywordflow}{break};
00684     \textcolor{keywordflow}{case} (CAN_TSR_RQCP2 | CAN_TSR_TXOK2 | CAN_TSR_TME2):state = CAN_TxStatus_Ok;
00685       \textcolor{keywordflow}{break};
00686     \textcolor{keywordflow}{default}: state = CAN_TxStatus_Failed;
00687       \textcolor{keywordflow}{break};
00688   \}
00689   \textcolor{keywordflow}{return} (uint8\_t) state;
00690 \}
\end{DoxyCode}
\mbox{\label{group__CAN_ga94740177bab153ca5b102d122f9a8cca}} 
\index{C\+AN@{C\+AN}!C\+A\+N\+\_\+\+T\+T\+Com\+Mode\+Cmd@{C\+A\+N\+\_\+\+T\+T\+Com\+Mode\+Cmd}}
\index{C\+A\+N\+\_\+\+T\+T\+Com\+Mode\+Cmd@{C\+A\+N\+\_\+\+T\+T\+Com\+Mode\+Cmd}!C\+AN@{C\+AN}}
\subsubsection{C\+A\+N\+\_\+\+T\+T\+Com\+Mode\+Cmd()}
{\footnotesize\ttfamily void C\+A\+N\+\_\+\+T\+T\+Com\+Mode\+Cmd (\begin{DoxyParamCaption}\item[{\textbf{ C\+A\+N\+\_\+\+Type\+Def} $\ast$}]{C\+A\+Nx,  }\item[{\textbf{ Functional\+State}}]{New\+State }\end{DoxyParamCaption})}



Enables or disables the C\+AN Time Trigger\+Operation communication mode. 

\begin{DoxyNote}{Note}
D\+LC must be programmed as 8 in order Time Stamp (2 bytes) to be sent over the C\+AN bus. 
\end{DoxyNote}

\begin{DoxyParams}{Parameters}
{\em C\+A\+Nx} & where x can be 1 or 2 to to select the C\+AN peripheral. \\
\hline
{\em New\+State} & Mode new state. This parameter can be\+: E\+N\+A\+B\+LE or D\+I\+S\+A\+B\+LE. When enabled, Time stamp (T\+I\+ME[15\+:0]) value is sent in the last two data bytes of the 8-\/byte message\+: T\+I\+ME[7\+:0] in data byte 6 and T\+I\+ME[15\+:8] in data byte 7. \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em None} & \\
\hline
\end{DoxyRetVals}


Definition at line \textbf{ 518} of file \textbf{ stm32f4xx\+\_\+can.\+c}.



References \textbf{ D\+I\+S\+A\+B\+LE}.


\begin{DoxyCode}
00519 \{
00520   \textcolor{comment}{/* Check the parameters */}
00521   assert_param(IS_CAN_ALL_PERIPH(CANx));
00522   assert_param(IS_FUNCTIONAL_STATE(NewState));
00523   \textcolor{keywordflow}{if} (NewState != DISABLE)
00524   \{
00525     \textcolor{comment}{/* Enable the TTCM mode */}
00526     CANx->MCR |= CAN_MCR_TTCM;
00527 
00528     \textcolor{comment}{/* Set TGT bits */}
00529     CANx->sTxMailBox[0].TDTR |= ((uint32\_t)CAN_TDT0R_TGT);
00530     CANx->sTxMailBox[1].TDTR |= ((uint32\_t)CAN_TDT1R_TGT);
00531     CANx->sTxMailBox[2].TDTR |= ((uint32\_t)CAN_TDT2R_TGT);
00532   \}
00533   \textcolor{keywordflow}{else}
00534   \{
00535     \textcolor{comment}{/* Disable the TTCM mode */}
00536     CANx->MCR &= (uint32\_t)(~(uint32\_t)CAN_MCR_TTCM);
00537 
00538     \textcolor{comment}{/* Reset TGT bits */}
00539     CANx->sTxMailBox[0].TDTR &= ((uint32\_t)~CAN_TDT0R_TGT);
00540     CANx->sTxMailBox[1].TDTR &= ((uint32\_t)~CAN_TDT1R_TGT);
00541     CANx->sTxMailBox[2].TDTR &= ((uint32\_t)~CAN_TDT2R_TGT);
00542   \}
00543 \}
\end{DoxyCode}
\mbox{\label{group__CAN_ga78cdfbf1884b9e33c552bcbca15bed10}} 
\index{C\+AN@{C\+AN}!C\+A\+N\+\_\+\+Wake\+Up@{C\+A\+N\+\_\+\+Wake\+Up}}
\index{C\+A\+N\+\_\+\+Wake\+Up@{C\+A\+N\+\_\+\+Wake\+Up}!C\+AN@{C\+AN}}
\subsubsection{C\+A\+N\+\_\+\+Wake\+Up()}
{\footnotesize\ttfamily uint8\+\_\+t C\+A\+N\+\_\+\+Wake\+Up (\begin{DoxyParamCaption}\item[{\textbf{ C\+A\+N\+\_\+\+Type\+Def} $\ast$}]{C\+A\+Nx }\end{DoxyParamCaption})}



Wakes up the C\+AN peripheral from sleep mode . 


\begin{DoxyParams}{Parameters}
{\em C\+A\+Nx} & where x can be 1 or 2 to select the C\+AN peripheral. \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em C\+A\+N\+\_\+\+Wake\+Up\+\_\+\+Ok} & if sleep mode left, C\+A\+N\+\_\+\+Wake\+Up\+\_\+\+Failed otherwise. \\
\hline
\end{DoxyRetVals}


Definition at line \textbf{ 973} of file \textbf{ stm32f4xx\+\_\+can.\+c}.


\begin{DoxyCode}
00974 \{
00975   uint32\_t wait\_slak = SLAK_TIMEOUT;
00976   uint8\_t wakeupstatus = CAN_WakeUp_Failed;
00977   
00978   \textcolor{comment}{/* Check the parameters */}
00979   assert_param(IS_CAN_ALL_PERIPH(CANx));
00980     
00981   \textcolor{comment}{/* Wake up request */}
00982   CANx->MCR &= ~(uint32\_t)CAN_MCR_SLEEP;
00983     
00984   \textcolor{comment}{/* Sleep mode status */}
00985   \textcolor{keywordflow}{while}(((CANx->MSR & CAN_MSR_SLAK) == CAN_MSR_SLAK)&&(wait\_slak!=0x00))
00986   \{
00987    wait\_slak--;
00988   \}
00989   \textcolor{keywordflow}{if}((CANx->MSR & CAN_MSR_SLAK) != CAN_MSR_SLAK)
00990   \{
00991    \textcolor{comment}{/* wake up done : Sleep mode exited */}
00992     wakeupstatus = CAN_WakeUp_Ok;
00993   \}
00994   \textcolor{comment}{/* return wakeup status */}
00995   \textcolor{keywordflow}{return} (uint8\_t)wakeupstatus;
00996 \}
\end{DoxyCode}
