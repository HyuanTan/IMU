<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Document Of Source Code: EMPL</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Document Of Source Code
   &#160;<span id="projectnumber">0.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#files">Files</a> &#124;
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">EMPL</div>  </div>
</div><!--header-->
<div class="contents">

<p>Embedded Motion Processing Library.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="files"></a>
Files</h2></td></tr>
<tr class="memitem:main_8c"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html">main.c</a></td></tr>
<tr class="memdesc:main_8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test app for eMPL using the Motion Driver DMP image. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structrx__s.html">rx_s</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structhal__s.html">hal_s</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structplatform__data__s.html">platform_data_s</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga83c044582a9fec2e45f8858efa5885b8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__eMPL.html#ga83c044582a9fec2e45f8858efa5885b8">PRINT_ACCEL</a>&#160;&#160;&#160;(0x01)</td></tr>
<tr class="separator:ga83c044582a9fec2e45f8858efa5885b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1f7cea00edafdbe1570199b28042ddd3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__eMPL.html#ga1f7cea00edafdbe1570199b28042ddd3">PRINT_GYRO</a>&#160;&#160;&#160;(0x02)</td></tr>
<tr class="separator:ga1f7cea00edafdbe1570199b28042ddd3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga709f1d5781d96858850143298f88104c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__eMPL.html#ga709f1d5781d96858850143298f88104c">PRINT_QUAT</a>&#160;&#160;&#160;(0x04)</td></tr>
<tr class="separator:ga709f1d5781d96858850143298f88104c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae55039e3cf38b78e1ec327c3e81d2859"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__eMPL.html#gae55039e3cf38b78e1ec327c3e81d2859">PRINT_COMPASS</a>&#160;&#160;&#160;(0x08)</td></tr>
<tr class="separator:gae55039e3cf38b78e1ec327c3e81d2859"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabfb66b3aafb997de9897c558dfc34b8e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__eMPL.html#gabfb66b3aafb997de9897c558dfc34b8e">PRINT_EULER</a>&#160;&#160;&#160;(0x10)</td></tr>
<tr class="separator:gabfb66b3aafb997de9897c558dfc34b8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga83fe59ee63a2dd6ba73760f07a21ee95"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__eMPL.html#ga83fe59ee63a2dd6ba73760f07a21ee95">PRINT_ROT_MAT</a>&#160;&#160;&#160;(0x20)</td></tr>
<tr class="separator:ga83fe59ee63a2dd6ba73760f07a21ee95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga39965157fdb18499d2665cdb203971dd"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__eMPL.html#ga39965157fdb18499d2665cdb203971dd">PRINT_HEADING</a>&#160;&#160;&#160;(0x40)</td></tr>
<tr class="separator:ga39965157fdb18499d2665cdb203971dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafc50e337bac90191d386f47e3cf49a7d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__eMPL.html#gafc50e337bac90191d386f47e3cf49a7d">PRINT_PEDO</a>&#160;&#160;&#160;(0x80)</td></tr>
<tr class="separator:gafc50e337bac90191d386f47e3cf49a7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga247e0609bfe123b5d988f0c63e99bf76"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__eMPL.html#ga247e0609bfe123b5d988f0c63e99bf76">PRINT_LINEAR_ACCEL</a>&#160;&#160;&#160;(0x100)</td></tr>
<tr class="separator:ga247e0609bfe123b5d988f0c63e99bf76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga31581e6a5034c28ac6270530f4b17e51"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__eMPL.html#ga31581e6a5034c28ac6270530f4b17e51">PRINT_GRAVITY_VECTOR</a>&#160;&#160;&#160;(0x200)</td></tr>
<tr class="separator:ga31581e6a5034c28ac6270530f4b17e51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga96e2dc57b8fe509f98cbbb52811717c3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__eMPL.html#ga96e2dc57b8fe509f98cbbb52811717c3">ACCEL_ON</a>&#160;&#160;&#160;(0x01)</td></tr>
<tr class="separator:ga96e2dc57b8fe509f98cbbb52811717c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1abb1b0f967cb0c0f3a0910f18241889"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__eMPL.html#ga1abb1b0f967cb0c0f3a0910f18241889">GYRO_ON</a>&#160;&#160;&#160;(0x02)</td></tr>
<tr class="separator:ga1abb1b0f967cb0c0f3a0910f18241889"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac4b29ad9d2af05af504ca053f3c5d76d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__eMPL.html#gac4b29ad9d2af05af504ca053f3c5d76d">COMPASS_ON</a>&#160;&#160;&#160;(0x04)</td></tr>
<tr class="separator:gac4b29ad9d2af05af504ca053f3c5d76d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga37210bcb4e70d9199030fb7cd89135e7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__eMPL.html#ga37210bcb4e70d9199030fb7cd89135e7">MOTION</a>&#160;&#160;&#160;(0)</td></tr>
<tr class="separator:ga37210bcb4e70d9199030fb7cd89135e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga35a7dc3ebde5e1980ce1412334326f28"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__eMPL.html#ga35a7dc3ebde5e1980ce1412334326f28">NO_MOTION</a>&#160;&#160;&#160;(1)</td></tr>
<tr class="separator:ga35a7dc3ebde5e1980ce1412334326f28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga292d717406e906831952ce46612fe4cd"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__eMPL.html#ga292d717406e906831952ce46612fe4cd">DEFAULT_MPU_HZ</a>&#160;&#160;&#160;(20)</td></tr>
<tr class="separator:ga292d717406e906831952ce46612fe4cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae69620948dea1b76e0ab7843ab719db7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__eMPL.html#gae69620948dea1b76e0ab7843ab719db7">FLASH_SIZE</a>&#160;&#160;&#160;(512)</td></tr>
<tr class="separator:gae69620948dea1b76e0ab7843ab719db7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga923aad67335bb52801a4f8dfc0b0fef0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__eMPL.html#ga923aad67335bb52801a4f8dfc0b0fef0">FLASH_MEM_START</a>&#160;&#160;&#160;((void*)0x1800)</td></tr>
<tr class="separator:ga923aad67335bb52801a4f8dfc0b0fef0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga77888d9bc269c75d63baf58cd000c7d9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__eMPL.html#ga77888d9bc269c75d63baf58cd000c7d9">PEDO_READ_MS</a>&#160;&#160;&#160;(1000)</td></tr>
<tr class="separator:ga77888d9bc269c75d63baf58cd000c7d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga209a05c6769a81d074903aaffe2f44a6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__eMPL.html#ga209a05c6769a81d074903aaffe2f44a6">TEMP_READ_MS</a>&#160;&#160;&#160;(500)</td></tr>
<tr class="separator:ga209a05c6769a81d074903aaffe2f44a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0718d456616de258f21190908610fdf6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__eMPL.html#ga0718d456616de258f21190908610fdf6">COMPASS_READ_MS</a>&#160;&#160;&#160;(100)</td></tr>
<tr class="separator:ga0718d456616de258f21190908610fdf6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga6a14df92edfa4e41346035ca5bf0d991"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__eMPL.html#ga6a14df92edfa4e41346035ca5bf0d991">read_from_mpl</a> (void)</td></tr>
<tr class="separator:ga6a14df92edfa4e41346035ca5bf0d991"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga399e39056041b2ec05d6f764e4f33b44"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__eMPL.html#ga399e39056041b2ec05d6f764e4f33b44">setup_gyro</a> (void)</td></tr>
<tr class="separator:ga399e39056041b2ec05d6f764e4f33b44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab1f482e5c0712ab28da61a1eff46fc75"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__eMPL.html#gab1f482e5c0712ab28da61a1eff46fc75">tap_cb</a> (unsigned char direction, unsigned char count)</td></tr>
<tr class="separator:gab1f482e5c0712ab28da61a1eff46fc75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa4a8ed4fa732bc82b2b518d80d196297"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__eMPL.html#gaa4a8ed4fa732bc82b2b518d80d196297">android_orient_cb</a> (unsigned char orientation)</td></tr>
<tr class="separator:gaa4a8ed4fa732bc82b2b518d80d196297"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gada9a71be1d41b7964984028357749505"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__eMPL.html#gada9a71be1d41b7964984028357749505">run_self_test</a> (void)</td></tr>
<tr class="separator:gada9a71be1d41b7964984028357749505"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2ccb744024182ca302323f00a7acd796"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__eMPL.html#ga2ccb744024182ca302323f00a7acd796">handle_input</a> (void)</td></tr>
<tr class="separator:ga2ccb744024182ca302323f00a7acd796"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga97b092893abbc0853590db8530636b63"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__eMPL.html#ga97b092893abbc0853590db8530636b63">gyro_data_ready_cb</a> (void)</td></tr>
<tr class="separator:ga97b092893abbc0853590db8530636b63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga840291bc02cba5474a4cb46a9b9566fe"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__eMPL.html#ga840291bc02cba5474a4cb46a9b9566fe">main</a> (void)</td></tr>
<tr class="memdesc:ga840291bc02cba5474a4cb46a9b9566fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">main entry point.  <a href="#ga840291bc02cba5474a4cb46a9b9566fe">More...</a><br /></td></tr>
<tr class="separator:ga840291bc02cba5474a4cb46a9b9566fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ga359d30cf3d94f8046df41f14467c36de"><td class="memItemLeft" align="right" valign="top">volatile uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__eMPL.html#ga359d30cf3d94f8046df41f14467c36de">hal_timestamp</a> = 0</td></tr>
<tr class="memdesc:ga359d30cf3d94f8046df41f14467c36de"><td class="mdescLeft">&#160;</td><td class="mdescRight">timestamp variable initialize, its for count tick  <a href="#ga359d30cf3d94f8046df41f14467c36de">More...</a><br /></td></tr>
<tr class="separator:ga359d30cf3d94f8046df41f14467c36de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4ef9c4b8e1082c8507e6cb1b9c618b87"><td class="memItemLeft" align="right" valign="top">unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__eMPL.html#ga4ef9c4b8e1082c8507e6cb1b9c618b87">header</a> [3]</td></tr>
<tr class="separator:ga4ef9c4b8e1082c8507e6cb1b9c618b87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga42416d99bb2db2007e3b19b8951fea0d"><td class="memItemLeft" align="right" valign="top">unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__eMPL.html#ga42416d99bb2db2007e3b19b8951fea0d">cmd</a></td></tr>
<tr class="separator:ga42416d99bb2db2007e3b19b8951fea0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaeb8fb45fc306b199be68b3f61940fbb0"><td class="memItemLeft" align="right" valign="top">unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__eMPL.html#gaeb8fb45fc306b199be68b3f61940fbb0">lp_accel_mode</a></td></tr>
<tr class="separator:gaeb8fb45fc306b199be68b3f61940fbb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaaa21c01566947e7007476657cb614e3f"><td class="memItemLeft" align="right" valign="top">unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__eMPL.html#gaaa21c01566947e7007476657cb614e3f">sensors</a></td></tr>
<tr class="separator:gaaa21c01566947e7007476657cb614e3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga49fb51079238683b21264827348b5968"><td class="memItemLeft" align="right" valign="top">unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__eMPL.html#ga49fb51079238683b21264827348b5968">dmp_on</a></td></tr>
<tr class="separator:ga49fb51079238683b21264827348b5968"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4028a8e467f1dc2db3018a557c353e8d"><td class="memItemLeft" align="right" valign="top">unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__eMPL.html#ga4028a8e467f1dc2db3018a557c353e8d">wait_for_tap</a></td></tr>
<tr class="separator:ga4028a8e467f1dc2db3018a557c353e8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacfce447bdb258e6fcf8e12e1b6e4481a"><td class="memItemLeft" align="right" valign="top">volatile unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__eMPL.html#gacfce447bdb258e6fcf8e12e1b6e4481a">new_gyro</a></td></tr>
<tr class="separator:gacfce447bdb258e6fcf8e12e1b6e4481a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafb031e775df5d8654f1ac1170378eb8d"><td class="memItemLeft" align="right" valign="top">unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__eMPL.html#gafb031e775df5d8654f1ac1170378eb8d">motion_int_mode</a></td></tr>
<tr class="separator:gafb031e775df5d8654f1ac1170378eb8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1418e767c7efaa0fb2b3a55b7a69b44b"><td class="memItemLeft" align="right" valign="top">unsigned long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__eMPL.html#ga1418e767c7efaa0fb2b3a55b7a69b44b">no_dmp_hz</a></td></tr>
<tr class="separator:ga1418e767c7efaa0fb2b3a55b7a69b44b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa40f644b7de352cb9ad81e2c602b5bae"><td class="memItemLeft" align="right" valign="top">unsigned long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__eMPL.html#gaa40f644b7de352cb9ad81e2c602b5bae">next_pedo_ms</a></td></tr>
<tr class="separator:gaa40f644b7de352cb9ad81e2c602b5bae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6f7f2c3d9913da113b6c5df295f50422"><td class="memItemLeft" align="right" valign="top">unsigned long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__eMPL.html#ga6f7f2c3d9913da113b6c5df295f50422">next_temp_ms</a></td></tr>
<tr class="separator:ga6f7f2c3d9913da113b6c5df295f50422"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7e499f7a5d40750be7a5ba81761a56bd"><td class="memItemLeft" align="right" valign="top">unsigned long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__eMPL.html#ga7e499f7a5d40750be7a5ba81761a56bd">next_compass_ms</a></td></tr>
<tr class="separator:ga7e499f7a5d40750be7a5ba81761a56bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5ab95f126fb29c3c65d6f4aa4944a2f7"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__eMPL.html#ga5ab95f126fb29c3c65d6f4aa4944a2f7">report</a></td></tr>
<tr class="separator:ga5ab95f126fb29c3c65d6f4aa4944a2f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab90560c34732c55496e27d7aad8b9ce2"><td class="memItemLeft" align="right" valign="top">unsigned short&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__eMPL.html#gab90560c34732c55496e27d7aad8b9ce2">dmp_features</a></td></tr>
<tr class="separator:gab90560c34732c55496e27d7aad8b9ce2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga02c35d11f6cb2fd88475c231ddf6afce"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structrx__s.html">rx_s</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__eMPL.html#ga02c35d11f6cb2fd88475c231ddf6afce">rx</a></td></tr>
<tr class="separator:ga02c35d11f6cb2fd88475c231ddf6afce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3cb1077f30b35eae5e6f9eb104179ec2"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structhal__s.html">hal_s</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a> = {0}</td></tr>
<tr class="separator:ga3cb1077f30b35eae5e6f9eb104179ec2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5bfb2c29b84492416fe0a885d4664132"><td class="memItemLeft" align="right" valign="top">volatile unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__eMPL.html#ga5bfb2c29b84492416fe0a885d4664132">rx_new</a></td></tr>
<tr class="memdesc:ga5bfb2c29b84492416fe0a885d4664132"><td class="mdescLeft">&#160;</td><td class="mdescRight">Usart Receive variable init.  <a href="#ga5bfb2c29b84492416fe0a885d4664132">More...</a><br /></td></tr>
<tr class="separator:ga5bfb2c29b84492416fe0a885d4664132"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga56d9a02ae0e768d49fd95fd014c47b07"><td class="memItemLeft" align="right" valign="top">unsigned char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__eMPL.html#ga56d9a02ae0e768d49fd95fd014c47b07">mpl_key</a> = (unsigned char*)&quot;eMPL 5.1&quot;</td></tr>
<tr class="separator:ga56d9a02ae0e768d49fd95fd014c47b07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf119b3b2187456063d2687f989236daf"><td class="memItemLeft" align="right" valign="top">signed char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__eMPL.html#gaf119b3b2187456063d2687f989236daf">orientation</a> [9]</td></tr>
<tr class="separator:gaf119b3b2187456063d2687f989236daf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6baed579bec05b70f94fb3b420c7f27a"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structplatform__data__s.html">platform_data_s</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__eMPL.html#ga6baed579bec05b70f94fb3b420c7f27a">gyro_pdata</a></td></tr>
<tr class="separator:ga6baed579bec05b70f94fb3b420c7f27a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Embedded Motion Processing Library. </p>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ga96e2dc57b8fe509f98cbbb52811717c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga96e2dc57b8fe509f98cbbb52811717c3">&#9670;&nbsp;</a></span>ACCEL_ON</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ACCEL_ON&#160;&#160;&#160;(0x01)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00044">44</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a id="gac4b29ad9d2af05af504ca053f3c5d76d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac4b29ad9d2af05af504ca053f3c5d76d">&#9670;&nbsp;</a></span>COMPASS_ON</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define COMPASS_ON&#160;&#160;&#160;(0x04)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00046">46</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a id="ga0718d456616de258f21190908610fdf6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0718d456616de258f21190908610fdf6">&#9670;&nbsp;</a></span>COMPASS_READ_MS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define COMPASS_READ_MS&#160;&#160;&#160;(100)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00059">59</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a id="ga292d717406e906831952ce46612fe4cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga292d717406e906831952ce46612fe4cd">&#9670;&nbsp;</a></span>DEFAULT_MPU_HZ</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEFAULT_MPU_HZ&#160;&#160;&#160;(20)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Starting sampling rate. </p>

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00052">52</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a id="ga923aad67335bb52801a4f8dfc0b0fef0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga923aad67335bb52801a4f8dfc0b0fef0">&#9670;&nbsp;</a></span>FLASH_MEM_START</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FLASH_MEM_START&#160;&#160;&#160;((void*)0x1800)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00055">55</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a id="gae69620948dea1b76e0ab7843ab719db7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae69620948dea1b76e0ab7843ab719db7">&#9670;&nbsp;</a></span>FLASH_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FLASH_SIZE&#160;&#160;&#160;(512)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00054">54</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a id="ga1abb1b0f967cb0c0f3a0910f18241889"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1abb1b0f967cb0c0f3a0910f18241889">&#9670;&nbsp;</a></span>GYRO_ON</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define GYRO_ON&#160;&#160;&#160;(0x02)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00045">45</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a id="ga37210bcb4e70d9199030fb7cd89135e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga37210bcb4e70d9199030fb7cd89135e7">&#9670;&nbsp;</a></span>MOTION</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MOTION&#160;&#160;&#160;(0)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00048">48</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a id="ga35a7dc3ebde5e1980ce1412334326f28"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga35a7dc3ebde5e1980ce1412334326f28">&#9670;&nbsp;</a></span>NO_MOTION</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NO_MOTION&#160;&#160;&#160;(1)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00049">49</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a id="ga77888d9bc269c75d63baf58cd000c7d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga77888d9bc269c75d63baf58cd000c7d9">&#9670;&nbsp;</a></span>PEDO_READ_MS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PEDO_READ_MS&#160;&#160;&#160;(1000)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00057">57</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a id="ga83c044582a9fec2e45f8858efa5885b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga83c044582a9fec2e45f8858efa5885b8">&#9670;&nbsp;</a></span>PRINT_ACCEL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PRINT_ACCEL&#160;&#160;&#160;(0x01)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Includes ---------------------------------------------------------&mdash;&mdash;&mdash;</p>
<p>Private typedef -----------------------------------------------------&mdash;&mdash;</p>
<p>Data read from MPL. </p>

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00032">32</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a id="gae55039e3cf38b78e1ec327c3e81d2859"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae55039e3cf38b78e1ec327c3e81d2859">&#9670;&nbsp;</a></span>PRINT_COMPASS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PRINT_COMPASS&#160;&#160;&#160;(0x08)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00035">35</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a id="gabfb66b3aafb997de9897c558dfc34b8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gabfb66b3aafb997de9897c558dfc34b8e">&#9670;&nbsp;</a></span>PRINT_EULER</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PRINT_EULER&#160;&#160;&#160;(0x10)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00036">36</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a id="ga31581e6a5034c28ac6270530f4b17e51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga31581e6a5034c28ac6270530f4b17e51">&#9670;&nbsp;</a></span>PRINT_GRAVITY_VECTOR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PRINT_GRAVITY_VECTOR&#160;&#160;&#160;(0x200)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00041">41</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a id="ga1f7cea00edafdbe1570199b28042ddd3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1f7cea00edafdbe1570199b28042ddd3">&#9670;&nbsp;</a></span>PRINT_GYRO</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PRINT_GYRO&#160;&#160;&#160;(0x02)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00033">33</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a id="ga39965157fdb18499d2665cdb203971dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga39965157fdb18499d2665cdb203971dd">&#9670;&nbsp;</a></span>PRINT_HEADING</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PRINT_HEADING&#160;&#160;&#160;(0x40)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00038">38</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a id="ga247e0609bfe123b5d988f0c63e99bf76"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga247e0609bfe123b5d988f0c63e99bf76">&#9670;&nbsp;</a></span>PRINT_LINEAR_ACCEL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PRINT_LINEAR_ACCEL&#160;&#160;&#160;(0x100)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00040">40</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a id="gafc50e337bac90191d386f47e3cf49a7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gafc50e337bac90191d386f47e3cf49a7d">&#9670;&nbsp;</a></span>PRINT_PEDO</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PRINT_PEDO&#160;&#160;&#160;(0x80)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00039">39</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a id="ga709f1d5781d96858850143298f88104c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga709f1d5781d96858850143298f88104c">&#9670;&nbsp;</a></span>PRINT_QUAT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PRINT_QUAT&#160;&#160;&#160;(0x04)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00034">34</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a id="ga83fe59ee63a2dd6ba73760f07a21ee95"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga83fe59ee63a2dd6ba73760f07a21ee95">&#9670;&nbsp;</a></span>PRINT_ROT_MAT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PRINT_ROT_MAT&#160;&#160;&#160;(0x20)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00037">37</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a id="ga209a05c6769a81d074903aaffe2f44a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga209a05c6769a81d074903aaffe2f44a6">&#9670;&nbsp;</a></span>TEMP_READ_MS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TEMP_READ_MS&#160;&#160;&#160;(500)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00058">58</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="gaa4a8ed4fa732bc82b2b518d80d196297"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa4a8ed4fa732bc82b2b518d80d196297">&#9670;&nbsp;</a></span>android_orient_cb()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void android_orient_cb </td>
          <td>(</td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>orientation</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>If you want to connect IMU with Android mobile device via bluetooth then this function should be called </p>

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00310">310</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;{</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="keywordflow">switch</span> (orientation) {</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="keywordflow">case</span> ANDROID_ORIENT_PORTRAIT:</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        MPL_LOGI(<span class="stringliteral">&quot;Portrait\n&quot;</span>);</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="keywordflow">case</span> ANDROID_ORIENT_LANDSCAPE:</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        MPL_LOGI(<span class="stringliteral">&quot;Landscape\n&quot;</span>);</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="keywordflow">case</span> ANDROID_ORIENT_REVERSE_PORTRAIT:</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        MPL_LOGI(<span class="stringliteral">&quot;Reverse Portrait\n&quot;</span>);</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="keywordflow">case</span> ANDROID_ORIENT_REVERSE_LANDSCAPE:</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        MPL_LOGI(<span class="stringliteral">&quot;Reverse Landscape\n&quot;</span>);</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    }</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="ga97b092893abbc0853590db8530636b63"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga97b092893abbc0853590db8530636b63">&#9670;&nbsp;</a></span>gyro_data_ready_cb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gyro_data_ready_cb </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Every time new gyro data is available, this function is called in an ISR context. In this example, it sets a flag protecting the FIFO read function. </p>

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00651">651</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

<p class="reference">References <a class="el" href="main_8c_source.html#l00081">hal</a>, and <a class="el" href="main_8c_source.html#l00071">hal_s::new_gyro</a>.</p>

<p class="reference">Referenced by <a class="el" href="stm32f4xx__it_8c_source.html#l00191">EXTI1_IRQHandler()</a>.</p>
<div class="fragment"><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;{</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    <a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#gacfce447bdb258e6fcf8e12e1b6e4481a">new_gyro</a> = 1;</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;}</div><div class="ttc" id="group__eMPL_html_ga3cb1077f30b35eae5e6f9eb104179ec2"><div class="ttname"><a href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a></div><div class="ttdeci">static struct hal_s hal</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00081">main.c:81</a></div></div>
<div class="ttc" id="group__eMPL_html_gacfce447bdb258e6fcf8e12e1b6e4481a"><div class="ttname"><a href="group__eMPL.html#gacfce447bdb258e6fcf8e12e1b6e4481a">hal_s::new_gyro</a></div><div class="ttdeci">volatile unsigned char new_gyro</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00071">main.c:71</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga2ccb744024182ca302323f00a7acd796"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2ccb744024182ca302323f00a7acd796">&#9670;&nbsp;</a></span>handle_input()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void handle_input </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>These commands turn off individual sensors.</p>
<p>The commands send individual sensor data or fused data to the PC.</p>
<p>This command prints out the value of each gyro register for debugging. If logging is disabled, this function has no effect.</p>
<p>When LP accel mode is enabled, the driver automatically configures the hardware for latched interrupts. However, the MCU sometimes misses the rising/falling edge, and the hal.new_gyro flag is never set. To avoid getting locked in this state, we're overriding the</p>
<p>TODO: The MCU supports level-triggered interrupts.</p>
<p>The hardware self test can be run without any interaction with the MPL since it's completely localized in the gyro driver. Logging is assumed to be enabled; otherwise, a couple LEDs could probably be used here to display the test results.</p>
<p>Let MPL know that contiguity was broken.</p>
<p>Depending on your application, sensor data may be needed at a faster or slower rate. These commands can speed up or slow down the rate at which the sensor data is pushed to the MPL.</p>
<p>In this example, the compass rate is never changed.</p>
<p>Set hardware to interrupt on gesture event only. This feature is useful for keeping the MCU asleep until the DMP detects as a tap or orientation event.</p>
<p>Set hardware to interrupt periodically.</p>
<p>Toggle pedometer display.</p>
<p>Reset pedometer.</p>
<p>LP accel is not compatible with the DMP.</p>
<p>Toggle DMP.</p>
<p>Restore FIFO settings.</p>
<p>When the DMP is used, the hardware sampling rate is fixed at 200Hz, and the DMP is configured to downsample the FIFO output using the function dmp_set_fifo_rate. However, when the DMP is turned off, the sampling rate remains at 200Hz. This could be handled in inv_mpu.c, but it would need to know that inv_mpu_dmp_motion_driver.c exists. To avoid this, we'll just put the extra logic in the application layer.</p>
<p>Preserve current FIFO rate.</p>
<p>Test the motion interrupt hardware feature.</p>
<p>not enabled for 6050 product</p>
<p>Toggle LP quaternion. The DMP features can be enabled/disabled at runtime. Use this same approach for other features.</p>

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00408">408</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

<p class="reference">References <a class="el" href="main_8c_source.html#l00063">rx_s::cmd</a>, <a class="el" href="main_8c_source.html#l00069">hal_s::dmp_on</a>, <a class="el" href="main_8c_source.html#l00081">hal</a>, <a class="el" href="main_8c_source.html#l00067">hal_s::lp_accel_mode</a>, <a class="el" href="main_8c_source.html#l00072">hal_s::motion_int_mode</a>, <a class="el" href="main_8c_source.html#l00077">hal_s::report</a>, <a class="el" href="main_8c_source.html#l00333">run_self_test()</a>, <a class="el" href="main_8c_source.html#l00079">hal_s::rx</a>, <a class="el" href="main_8c_source.html#l00068">hal_s::sensors</a>, <a class="el" href="main_8c_source.html#l00249">setup_gyro()</a>, and <a class="el" href="stm32f4xx__usart_8c_source.html#l00554">USART_ReceiveData()</a>.</p>

<p class="reference">Referenced by <a class="el" href="main_8c_source.html#l00665">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;{</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  </div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="keywordtype">char</span> c = <a class="code" href="group__USART__Group2.html#gac67a91845b0b1d54d31bdfb1c5e9867c">USART_ReceiveData</a>(<a class="code" href="group__Peripheral__declaration.html#ga92871691058ff7ccffd7635930cb08da">USART1</a>);</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="comment">//char c = USART_ReceiveData(USART2);</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="keywordflow">switch</span> (c) {</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <span class="keywordflow">case</span> <span class="charliteral">&#39;8&#39;</span>:</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        <a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#gaaa21c01566947e7007476657cb614e3f">sensors</a> ^= <a class="code" href="group__eMPL.html#ga96e2dc57b8fe509f98cbbb52811717c3">ACCEL_ON</a>;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        <a class="code" href="group__eMPL.html#ga399e39056041b2ec05d6f764e4f33b44">setup_gyro</a>();</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        <span class="keywordflow">if</span> (!(<a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#gaaa21c01566947e7007476657cb614e3f">sensors</a> &amp; <a class="code" href="group__eMPL.html#ga96e2dc57b8fe509f98cbbb52811717c3">ACCEL_ON</a>))</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;            inv_accel_was_turned_off();</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="keywordflow">case</span> <span class="charliteral">&#39;9&#39;</span>:</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        <a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#gaaa21c01566947e7007476657cb614e3f">sensors</a> ^= <a class="code" href="group__eMPL.html#ga1abb1b0f967cb0c0f3a0910f18241889">GYRO_ON</a>;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        <a class="code" href="group__eMPL.html#ga399e39056041b2ec05d6f764e4f33b44">setup_gyro</a>();</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        <span class="keywordflow">if</span> (!(<a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#gaaa21c01566947e7007476657cb614e3f">sensors</a> &amp; <a class="code" href="group__eMPL.html#ga1abb1b0f967cb0c0f3a0910f18241889">GYRO_ON</a>))</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;            inv_gyro_was_turned_off();</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="preprocessor">#ifdef COMPASS_ENABLED</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="keywordflow">case</span> <span class="charliteral">&#39;0&#39;</span>:</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#gaaa21c01566947e7007476657cb614e3f">sensors</a> ^= <a class="code" href="group__eMPL.html#gac4b29ad9d2af05af504ca053f3c5d76d">COMPASS_ON</a>;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        <a class="code" href="group__eMPL.html#ga399e39056041b2ec05d6f764e4f33b44">setup_gyro</a>();</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        <span class="keywordflow">if</span> (!(<a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#gaaa21c01566947e7007476657cb614e3f">sensors</a> &amp; <a class="code" href="group__eMPL.html#gac4b29ad9d2af05af504ca053f3c5d76d">COMPASS_ON</a>))</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;            inv_compass_was_turned_off();</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="keywordflow">case</span> <span class="charliteral">&#39;a&#39;</span>:</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        <a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#ga5ab95f126fb29c3c65d6f4aa4944a2f7">report</a> ^= <a class="code" href="group__eMPL.html#ga83c044582a9fec2e45f8858efa5885b8">PRINT_ACCEL</a>;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="keywordflow">case</span> <span class="charliteral">&#39;g&#39;</span>:</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        <a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#ga5ab95f126fb29c3c65d6f4aa4944a2f7">report</a> ^= <a class="code" href="group__eMPL.html#ga1f7cea00edafdbe1570199b28042ddd3">PRINT_GYRO</a>;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="preprocessor">#ifdef COMPASS_ENABLED</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="keywordflow">case</span> <span class="charliteral">&#39;c&#39;</span>:</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        <a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#ga5ab95f126fb29c3c65d6f4aa4944a2f7">report</a> ^= <a class="code" href="group__eMPL.html#gae55039e3cf38b78e1ec327c3e81d2859">PRINT_COMPASS</a>;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="keywordflow">case</span> <span class="charliteral">&#39;e&#39;</span>:</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        <a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#ga5ab95f126fb29c3c65d6f4aa4944a2f7">report</a> ^= <a class="code" href="group__eMPL.html#gabfb66b3aafb997de9897c558dfc34b8e">PRINT_EULER</a>;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="keywordflow">case</span> <span class="charliteral">&#39;r&#39;</span>:</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        <a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#ga5ab95f126fb29c3c65d6f4aa4944a2f7">report</a> ^= <a class="code" href="group__eMPL.html#ga83fe59ee63a2dd6ba73760f07a21ee95">PRINT_ROT_MAT</a>;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="keywordflow">case</span> <span class="charliteral">&#39;q&#39;</span>:</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        <a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#ga5ab95f126fb29c3c65d6f4aa4944a2f7">report</a> ^= <a class="code" href="group__eMPL.html#ga709f1d5781d96858850143298f88104c">PRINT_QUAT</a>;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="keywordflow">case</span> <span class="charliteral">&#39;h&#39;</span>:</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        <a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#ga5ab95f126fb29c3c65d6f4aa4944a2f7">report</a> ^= <a class="code" href="group__eMPL.html#ga39965157fdb18499d2665cdb203971dd">PRINT_HEADING</a>;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="keywordflow">case</span> <span class="charliteral">&#39;i&#39;</span>:</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        <a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#ga5ab95f126fb29c3c65d6f4aa4944a2f7">report</a> ^= <a class="code" href="group__eMPL.html#ga247e0609bfe123b5d988f0c63e99bf76">PRINT_LINEAR_ACCEL</a>;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="keywordflow">case</span> <span class="charliteral">&#39;o&#39;</span>:</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        <a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#ga5ab95f126fb29c3c65d6f4aa4944a2f7">report</a> ^= <a class="code" href="group__eMPL.html#ga31581e6a5034c28ac6270530f4b17e51">PRINT_GRAVITY_VECTOR</a>;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="preprocessor">#ifdef COMPASS_ENABLED</span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="keywordflow">case</span> <span class="charliteral">&#39;w&#39;</span>:</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        send_status_compass();</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="keywordflow">case</span> <span class="charliteral">&#39;d&#39;</span>:</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        mpu_reg_dump();</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="comment">/* Test out low-power accel mode. */</span></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="keywordflow">case</span> <span class="charliteral">&#39;p&#39;</span>:</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#ga49fb51079238683b21264827348b5968">dmp_on</a>)</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;            <span class="comment">/* LP accel is not compatible with the DMP. */</span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        mpu_lp_accel_mode(20);</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        mpu_set_int_latched(0);</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        <a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#gaaa21c01566947e7007476657cb614e3f">sensors</a> &amp;= ~(<a class="code" href="group__eMPL.html#ga1abb1b0f967cb0c0f3a0910f18241889">GYRO_ON</a>|<a class="code" href="group__eMPL.html#gac4b29ad9d2af05af504ca053f3c5d76d">COMPASS_ON</a>);</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        <a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#gaaa21c01566947e7007476657cb614e3f">sensors</a> |= <a class="code" href="group__eMPL.html#ga96e2dc57b8fe509f98cbbb52811717c3">ACCEL_ON</a>;</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        <a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#gaeb8fb45fc306b199be68b3f61940fbb0">lp_accel_mode</a> = 1;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        inv_gyro_was_turned_off();</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        inv_compass_was_turned_off();</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="keywordflow">case</span> <span class="charliteral">&#39;t&#39;</span>:</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        <a class="code" href="group__eMPL.html#gada9a71be1d41b7964984028357749505">run_self_test</a>();</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        inv_accel_was_turned_off();</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        inv_gyro_was_turned_off();</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        inv_compass_was_turned_off();</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="keywordflow">case</span> <span class="charliteral">&#39;1&#39;</span>:</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#ga49fb51079238683b21264827348b5968">dmp_on</a>) {</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;            dmp_set_fifo_rate(10);</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;            inv_set_quat_sample_rate(100000L);</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        } <span class="keywordflow">else</span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;            mpu_set_sample_rate(10);</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        inv_set_gyro_sample_rate(100000L);</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        inv_set_accel_sample_rate(100000L);</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <span class="keywordflow">case</span> <span class="charliteral">&#39;2&#39;</span>:</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#ga49fb51079238683b21264827348b5968">dmp_on</a>) {</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;            dmp_set_fifo_rate(20);</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;            inv_set_quat_sample_rate(50000L);</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        } <span class="keywordflow">else</span></div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;            mpu_set_sample_rate(20);</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        inv_set_gyro_sample_rate(50000L);</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        inv_set_accel_sample_rate(50000L);</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="keywordflow">case</span> <span class="charliteral">&#39;3&#39;</span>:</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#ga49fb51079238683b21264827348b5968">dmp_on</a>) {</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;            dmp_set_fifo_rate(40);</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;            inv_set_quat_sample_rate(25000L);</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        } <span class="keywordflow">else</span></div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;            mpu_set_sample_rate(40);</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        inv_set_gyro_sample_rate(25000L);</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        inv_set_accel_sample_rate(25000L);</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <span class="keywordflow">case</span> <span class="charliteral">&#39;4&#39;</span>:</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#ga49fb51079238683b21264827348b5968">dmp_on</a>) {</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;            dmp_set_fifo_rate(50);</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;            inv_set_quat_sample_rate(20000L);</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        } <span class="keywordflow">else</span></div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;            mpu_set_sample_rate(50);</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        inv_set_gyro_sample_rate(20000L);</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        inv_set_accel_sample_rate(20000L);</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <span class="keywordflow">case</span> <span class="charliteral">&#39;5&#39;</span>:</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#ga49fb51079238683b21264827348b5968">dmp_on</a>) {</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;            dmp_set_fifo_rate(100);</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;            inv_set_quat_sample_rate(10000L);</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        } <span class="keywordflow">else</span></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;            mpu_set_sample_rate(100);</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        inv_set_gyro_sample_rate(10000L);</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        inv_set_accel_sample_rate(10000L);</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <span class="keywordflow">case</span> <span class="charliteral">&#39;,&#39;</span>:</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        dmp_set_interrupt_mode(DMP_INT_GESTURE);</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <span class="keywordflow">case</span> <span class="charliteral">&#39;.&#39;</span>:</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        dmp_set_interrupt_mode(DMP_INT_CONTINUOUS);</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <span class="keywordflow">case</span> <span class="charliteral">&#39;6&#39;</span>:</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        <a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#ga5ab95f126fb29c3c65d6f4aa4944a2f7">report</a> ^= <a class="code" href="group__eMPL.html#gafc50e337bac90191d386f47e3cf49a7d">PRINT_PEDO</a>;</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <span class="keywordflow">case</span> <span class="charliteral">&#39;7&#39;</span>:</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        dmp_set_pedometer_step_count(0);</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        dmp_set_pedometer_walk_time(0);</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <span class="keywordflow">case</span> <span class="charliteral">&#39;f&#39;</span>:</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#gaeb8fb45fc306b199be68b3f61940fbb0">lp_accel_mode</a>)</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#ga49fb51079238683b21264827348b5968">dmp_on</a>) {</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> dmp_rate;</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> mask = 0;</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;            <a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#ga49fb51079238683b21264827348b5968">dmp_on</a> = 0;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;            mpu_set_dmp_state(0);</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#gaaa21c01566947e7007476657cb614e3f">sensors</a> &amp; <a class="code" href="group__eMPL.html#ga96e2dc57b8fe509f98cbbb52811717c3">ACCEL_ON</a>)</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                mask |= INV_XYZ_ACCEL;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#gaaa21c01566947e7007476657cb614e3f">sensors</a> &amp; <a class="code" href="group__eMPL.html#ga1abb1b0f967cb0c0f3a0910f18241889">GYRO_ON</a>)</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                mask |= INV_XYZ_GYRO;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#gaaa21c01566947e7007476657cb614e3f">sensors</a> &amp; <a class="code" href="group__eMPL.html#gac4b29ad9d2af05af504ca053f3c5d76d">COMPASS_ON</a>)</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                mask |= INV_XYZ_COMPASS;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;            mpu_configure_fifo(mask);</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;            dmp_get_fifo_rate(&amp;dmp_rate);</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;            mpu_set_sample_rate(dmp_rate);</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;            inv_quaternion_sensor_was_turned_off();</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;            MPL_LOGI(<span class="stringliteral">&quot;DMP disabled.\n&quot;</span>);</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> sample_rate;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;            <a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#ga49fb51079238683b21264827348b5968">dmp_on</a> = 1;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;            mpu_get_sample_rate(&amp;sample_rate);</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;            dmp_set_fifo_rate(sample_rate);</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;            inv_set_quat_sample_rate(1000000L / sample_rate);</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;            mpu_set_dmp_state(1);</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;            MPL_LOGI(<span class="stringliteral">&quot;DMP enabled.\n&quot;</span>);</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        }</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <span class="keywordflow">case</span> <span class="charliteral">&#39;m&#39;</span>:</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="preprocessor">    #ifndef MPU6050 </span></div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="preprocessor">    hal.motion_int_mode = 1;</span></div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="preprocessor">    #endif </span></div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <span class="keywordflow">case</span> <span class="charliteral">&#39;v&#39;</span>:</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        <a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#gab90560c34732c55496e27d7aad8b9ce2">dmp_features</a> ^= DMP_FEATURE_6X_LP_QUAT;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;        dmp_enable_feature(<a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#gab90560c34732c55496e27d7aad8b9ce2">dmp_features</a>);</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;        <span class="keywordflow">if</span> (!(<a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#gab90560c34732c55496e27d7aad8b9ce2">dmp_features</a> &amp; DMP_FEATURE_6X_LP_QUAT)) {</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;            inv_quaternion_sensor_was_turned_off();</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;            MPL_LOGI(<span class="stringliteral">&quot;LP quaternion disabled.\n&quot;</span>);</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        } <span class="keywordflow">else</span></div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;            MPL_LOGI(<span class="stringliteral">&quot;LP quaternion enabled.\n&quot;</span>);</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    }</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    <a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#ga02c35d11f6cb2fd88475c231ddf6afce">rx</a>.<a class="code" href="group__eMPL.html#ga42416d99bb2db2007e3b19b8951fea0d">cmd</a> = 0;</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;}</div><div class="ttc" id="group__eMPL_html_gae55039e3cf38b78e1ec327c3e81d2859"><div class="ttname"><a href="group__eMPL.html#gae55039e3cf38b78e1ec327c3e81d2859">PRINT_COMPASS</a></div><div class="ttdeci">#define PRINT_COMPASS</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00035">main.c:35</a></div></div>
<div class="ttc" id="group__eMPL_html_ga83c044582a9fec2e45f8858efa5885b8"><div class="ttname"><a href="group__eMPL.html#ga83c044582a9fec2e45f8858efa5885b8">PRINT_ACCEL</a></div><div class="ttdeci">#define PRINT_ACCEL</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00032">main.c:32</a></div></div>
<div class="ttc" id="group__eMPL_html_gada9a71be1d41b7964984028357749505"><div class="ttname"><a href="group__eMPL.html#gada9a71be1d41b7964984028357749505">run_self_test</a></div><div class="ttdeci">static void run_self_test(void)</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00333">main.c:333</a></div></div>
<div class="ttc" id="group__eMPL_html_gab90560c34732c55496e27d7aad8b9ce2"><div class="ttname"><a href="group__eMPL.html#gab90560c34732c55496e27d7aad8b9ce2">hal_s::dmp_features</a></div><div class="ttdeci">unsigned short dmp_features</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00078">main.c:78</a></div></div>
<div class="ttc" id="group__eMPL_html_gafc50e337bac90191d386f47e3cf49a7d"><div class="ttname"><a href="group__eMPL.html#gafc50e337bac90191d386f47e3cf49a7d">PRINT_PEDO</a></div><div class="ttdeci">#define PRINT_PEDO</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00039">main.c:39</a></div></div>
<div class="ttc" id="group__eMPL_html_ga39965157fdb18499d2665cdb203971dd"><div class="ttname"><a href="group__eMPL.html#ga39965157fdb18499d2665cdb203971dd">PRINT_HEADING</a></div><div class="ttdeci">#define PRINT_HEADING</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00038">main.c:38</a></div></div>
<div class="ttc" id="group__eMPL_html_ga1f7cea00edafdbe1570199b28042ddd3"><div class="ttname"><a href="group__eMPL.html#ga1f7cea00edafdbe1570199b28042ddd3">PRINT_GYRO</a></div><div class="ttdeci">#define PRINT_GYRO</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00033">main.c:33</a></div></div>
<div class="ttc" id="group__eMPL_html_ga3cb1077f30b35eae5e6f9eb104179ec2"><div class="ttname"><a href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a></div><div class="ttdeci">static struct hal_s hal</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00081">main.c:81</a></div></div>
<div class="ttc" id="group__eMPL_html_ga709f1d5781d96858850143298f88104c"><div class="ttname"><a href="group__eMPL.html#ga709f1d5781d96858850143298f88104c">PRINT_QUAT</a></div><div class="ttdeci">#define PRINT_QUAT</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00034">main.c:34</a></div></div>
<div class="ttc" id="group__eMPL_html_ga247e0609bfe123b5d988f0c63e99bf76"><div class="ttname"><a href="group__eMPL.html#ga247e0609bfe123b5d988f0c63e99bf76">PRINT_LINEAR_ACCEL</a></div><div class="ttdeci">#define PRINT_LINEAR_ACCEL</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00040">main.c:40</a></div></div>
<div class="ttc" id="group__eMPL_html_ga49fb51079238683b21264827348b5968"><div class="ttname"><a href="group__eMPL.html#ga49fb51079238683b21264827348b5968">hal_s::dmp_on</a></div><div class="ttdeci">unsigned char dmp_on</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00069">main.c:69</a></div></div>
<div class="ttc" id="group__eMPL_html_ga1abb1b0f967cb0c0f3a0910f18241889"><div class="ttname"><a href="group__eMPL.html#ga1abb1b0f967cb0c0f3a0910f18241889">GYRO_ON</a></div><div class="ttdeci">#define GYRO_ON</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00045">main.c:45</a></div></div>
<div class="ttc" id="group__Peripheral__declaration_html_ga92871691058ff7ccffd7635930cb08da"><div class="ttname"><a href="group__Peripheral__declaration.html#ga92871691058ff7ccffd7635930cb08da">USART1</a></div><div class="ttdeci">#define USART1</div><div class="ttdef"><b>Definition:</b> <a href="stm32f4xx_8h_source.html#l01170">stm32f4xx.h:1170</a></div></div>
<div class="ttc" id="group__eMPL_html_ga96e2dc57b8fe509f98cbbb52811717c3"><div class="ttname"><a href="group__eMPL.html#ga96e2dc57b8fe509f98cbbb52811717c3">ACCEL_ON</a></div><div class="ttdeci">#define ACCEL_ON</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00044">main.c:44</a></div></div>
<div class="ttc" id="group__eMPL_html_gaeb8fb45fc306b199be68b3f61940fbb0"><div class="ttname"><a href="group__eMPL.html#gaeb8fb45fc306b199be68b3f61940fbb0">hal_s::lp_accel_mode</a></div><div class="ttdeci">unsigned char lp_accel_mode</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00067">main.c:67</a></div></div>
<div class="ttc" id="group__eMPL_html_ga5ab95f126fb29c3c65d6f4aa4944a2f7"><div class="ttname"><a href="group__eMPL.html#ga5ab95f126fb29c3c65d6f4aa4944a2f7">hal_s::report</a></div><div class="ttdeci">unsigned int report</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00077">main.c:77</a></div></div>
<div class="ttc" id="group__eMPL_html_ga31581e6a5034c28ac6270530f4b17e51"><div class="ttname"><a href="group__eMPL.html#ga31581e6a5034c28ac6270530f4b17e51">PRINT_GRAVITY_VECTOR</a></div><div class="ttdeci">#define PRINT_GRAVITY_VECTOR</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00041">main.c:41</a></div></div>
<div class="ttc" id="group__eMPL_html_ga83fe59ee63a2dd6ba73760f07a21ee95"><div class="ttname"><a href="group__eMPL.html#ga83fe59ee63a2dd6ba73760f07a21ee95">PRINT_ROT_MAT</a></div><div class="ttdeci">#define PRINT_ROT_MAT</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00037">main.c:37</a></div></div>
<div class="ttc" id="group__eMPL_html_gaaa21c01566947e7007476657cb614e3f"><div class="ttname"><a href="group__eMPL.html#gaaa21c01566947e7007476657cb614e3f">hal_s::sensors</a></div><div class="ttdeci">unsigned char sensors</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00068">main.c:68</a></div></div>
<div class="ttc" id="group__USART__Group2_html_gac67a91845b0b1d54d31bdfb1c5e9867c"><div class="ttname"><a href="group__USART__Group2.html#gac67a91845b0b1d54d31bdfb1c5e9867c">USART_ReceiveData</a></div><div class="ttdeci">uint16_t USART_ReceiveData(USART_TypeDef *USARTx)</div><div class="ttdoc">Returns the most recent received data by the USARTx peripheral. </div><div class="ttdef"><b>Definition:</b> <a href="stm32f4xx__usart_8c_source.html#l00554">stm32f4xx_usart.c:554</a></div></div>
<div class="ttc" id="group__eMPL_html_gac4b29ad9d2af05af504ca053f3c5d76d"><div class="ttname"><a href="group__eMPL.html#gac4b29ad9d2af05af504ca053f3c5d76d">COMPASS_ON</a></div><div class="ttdeci">#define COMPASS_ON</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00046">main.c:46</a></div></div>
<div class="ttc" id="group__eMPL_html_ga02c35d11f6cb2fd88475c231ddf6afce"><div class="ttname"><a href="group__eMPL.html#ga02c35d11f6cb2fd88475c231ddf6afce">hal_s::rx</a></div><div class="ttdeci">struct rx_s rx</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00079">main.c:79</a></div></div>
<div class="ttc" id="group__eMPL_html_gabfb66b3aafb997de9897c558dfc34b8e"><div class="ttname"><a href="group__eMPL.html#gabfb66b3aafb997de9897c558dfc34b8e">PRINT_EULER</a></div><div class="ttdeci">#define PRINT_EULER</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00036">main.c:36</a></div></div>
<div class="ttc" id="group__eMPL_html_ga399e39056041b2ec05d6f764e4f33b44"><div class="ttname"><a href="group__eMPL.html#ga399e39056041b2ec05d6f764e4f33b44">setup_gyro</a></div><div class="ttdeci">static void setup_gyro(void)</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00249">main.c:249</a></div></div>
<div class="ttc" id="group__eMPL_html_ga42416d99bb2db2007e3b19b8951fea0d"><div class="ttname"><a href="group__eMPL.html#ga42416d99bb2db2007e3b19b8951fea0d">rx_s::cmd</a></div><div class="ttdeci">unsigned char cmd</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00063">main.c:63</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga840291bc02cba5474a4cb46a9b9566fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga840291bc02cba5474a4cb46a9b9566fe">&#9670;&nbsp;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>main entry point. </p>
<dl class="section user"><dt>Parameters None</dt><dd></dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">void</td><td>None </td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Required preconditions: None</dt><dd></dd></dl>
<p>Variable Declaration</p>
<p>If you're not using an MPU9150 AND you're not using DMP features, this function will place all slaves on the primary bus. mpu_set_bypass(1);</p>
<p>Compute 6-axis and 9-axis quaternions.</p>
<p>The MPL expects compass data at a constant rate (matching the rate passed to inv_set_compass_sample_rate). If this is an issue for your application, call this function, and the MPL will depend on the timestamps passed to inv_build_compass instead.</p>
<p>inv_9x_fusion_use_timestamps(1);</p>
<p>This function has been deprecated. inv_enable_no_gyro_fusion();</p>
<p>Update gyro biases when not in motion. WARNING: These algorithms are mutually exclusive.</p>
<p>inv_enable_motion_no_motion();</p>
<p>inv_set_no_motion_time(1000);</p>
<p>Update gyro biases when temperature changes.</p>
<p>This algorithm updates the accel biases when in motion. A more accurate bias measurement can be made when running the self-test (see case 't' in handle_input), but this algorithm can be enabled if the self-test can't be executed in your application.</p>
<p>inv_enable_in_use_auto_calibration();</p>
<p>If you need to estimate your heading before the compass is calibrated, enable this algorithm. It becomes useless after a good figure-eight is detected, so we'll just leave it out to save memory. inv_enable_heading_from_gyro();</p>
<p>Allows use of the MPL APIs in read_from_mpl.</p>
<p>Get/set hardware configuration. Start gyro.</p>
<p>Wake up all sensors.</p>
<p>Push both gyro and accel data into the FIFO.</p>
<p>Read back configuration in case it was set improperly.</p>
<p>Sync driver configuration with MPL.</p>
<p>Sample rate expected in microseconds.</p>
<p>Set chip-to-body orientation matrix. Set hardware units to dps/g's/degrees scaling factor.</p>
<p>Initialize HAL state variables.</p>
<p>Compass reads are handled by scheduler.</p>
<p>To initialize the DMP:</p><ol type="1">
<li>Call dmp_load_motion_driver_firmware(). This pushes the DMP image in inv_mpu_dmp_motion_driver.h into the MPU memory.</li>
<li>Push the gyro and accel orientation matrix to the DMP.</li>
<li>Register gesture callbacks. Don't worry, these callbacks won't be executed unless the corresponding feature is enabled.</li>
<li>Call dmp_enable_feature(mask) to enable different features.</li>
<li>Call dmp_set_fifo_rate(freq) to select a DMP output rate.</li>
<li>Call any feature-specific control functions.</li>
</ol>
<p>To enable the DMP, just call mpu_set_dmp_state(1). This function can be called repeatedly to enable and disable the DMP at runtime.</p>
<p>The following is a short summary of the features supported in the DMP image provided in inv_mpu_dmp_motion_driver.c: DMP_FEATURE_LP_QUAT: Generate a gyro-only quaternion on the DMP at 200Hz. Integrating the gyro data at higher rates reduces numerical errors (compared to integration on the MCU at a lower sampling rate). DMP_FEATURE_6X_LP_QUAT: Generate a gyro/accel quaternion on the DMP at 200Hz. Cannot be used in combination with DMP_FEATURE_LP_QUAT. DMP_FEATURE_TAP: Detect taps along the X, Y, and Z axes. DMP_FEATURE_ANDROID_ORIENT: Google's screen rotation algorithm. Triggers an event at the four orientations where the screen should rotate. DMP_FEATURE_GYRO_CAL: Calibrates the gyro data after eight seconds of no motion. DMP_FEATURE_SEND_RAW_ACCEL: Add raw accelerometer data to the FIFO. DMP_FEATURE_SEND_RAW_GYRO: Add raw gyro data to the FIFO. DMP_FEATURE_SEND_CAL_GYRO: Add calibrated gyro data to the FIFO. Cannot be used in combination with DMP_FEATURE_SEND_RAW_GYRO.</p>
<p>Known Bug - DMP when enabled will sample sensor data at 200Hz and output to FIFO at the rate specified in the dmp_set_fifo_rate API. The DMP will then sent an interrupt once a sample has been put into the FIFO. Therefore if the dmp_set_fifo_rate is at 25Hz there will be a 25Hz interrupt from the MPU device.</p>
<p>There is a known issue in which if you do not enable DMP_FEATURE_TAP then the interrupts will be at 200Hz even if fifo rate is set at a different rate. To avoid this issue include the DMP_FEATURE_TAP</p>
<p>DMP sensor fusion works only with gyro at +-2000dps and accel +-2G</p>
<p>A byte has been received via USART. See handle_input for a list of valid commands.</p>
<p>Temperature data doesn't need to be read with every gyro sample. Let's make them timer-based like the compass reads.</p>
<p>Enable motion interrupt.</p>
<p>Notify the MPL that contiguity was broken.</p>
<p>Wait for the MPU interrupt.</p>
<p>Restore the previous sensor configuration.</p>
<p>This function gets new data from the FIFO when the DMP is in use. The FIFO can contain any combination of gyro, accel, quaternion, and gesture data. The sensors parameter tells the caller which data fields were actually populated with new data. For example, if sensors == (INV_XYZ_GYRO | INV_WXYZ_QUAT), then the FIFO isn't being filled with accel data. The driver parses the gesture data to determine if a gesture event has occurred; on an event, the application will be notified via a callback (assuming that a callback function was properly registered). The more parameter is non-zero if there are leftover packets in the FIFO.</p>
<p>Push the new data to the MPL.</p>
<p>Temperature only used for gyro temp comp.</p>
<p>This function gets new data from the FIFO. The FIFO can contain gyro, accel, both, or neither. The sensors parameter tells the caller which data fields were actually populated with new data. For example, if sensors == INV_XYZ_GYRO, then the FIFO isn't being filled with accel data. The more parameter is non-zero if there are leftover packets in the FIFO. The HAL can use this information to increase the frequency at which this function is called.</p>
<p>Push the new data to the MPL.</p>
<p>Temperature only used for gyro temp comp.</p>
<p>This function reads bias-compensated sensor data and sensor fusion outputs from the MPL. The outputs are formatted as seen in eMPL_outputs.c. This function only needs to be called at the rate requested by the host.</p>

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00665">665</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

<p class="reference">References <a class="el" href="board-st__discovery_8c_source.html#l00017">board_init()</a>, <a class="el" href="main_8c_source.html#l00063">rx_s::cmd</a>, <a class="el" href="main_8c_source.html#l00069">hal_s::dmp_on</a>, <a class="el" href="board-st__discovery_8c_source.html#l00055">get_tick_count()</a>, <a class="el" href="main_8c_source.html#l00081">hal</a>, <a class="el" href="main_8c_source.html#l00408">handle_input()</a>, <a class="el" href="main_8c_source.html#l00067">hal_s::lp_accel_mode</a>, <a class="el" href="main_8c_source.html#l00072">hal_s::motion_int_mode</a>, <a class="el" href="main_8c_source.html#l00071">hal_s::new_gyro</a>, <a class="el" href="main_8c_source.html#l00076">hal_s::next_compass_ms</a>, <a class="el" href="main_8c_source.html#l00074">hal_s::next_pedo_ms</a>, <a class="el" href="main_8c_source.html#l00075">hal_s::next_temp_ms</a>, <a class="el" href="main_8c_source.html#l00143">read_from_mpl()</a>, <a class="el" href="main_8c_source.html#l00077">hal_s::report</a>, <a class="el" href="main_8c_source.html#l00079">hal_s::rx</a>, <a class="el" href="main_8c_source.html#l00068">hal_s::sensors</a>, <a class="el" href="stm32f4xx__usart_8c_source.html#l01429">USART_ClearITPendingBit()</a>, and <a class="el" href="stm32f4xx__usart_8c_source.html#l01355">USART_GetITStatus()</a>.</p>
<div class="fragment"><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;{ </div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    inv_error_t result;</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> accel_fsr,  new_temp = 0;</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> gyro_rate, gyro_fsr;</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> timestamp;</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    <span class="keyword">struct </span>int_param_s int_param;</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="preprocessor">#ifdef COMPASS_ENABLED</span></div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> new_compass = 0;</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> compass_fsr;</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    <a class="code" href="board-st__discovery_8c.html#ad7d81512b0ce3a7214547801a3e41264">board_init</a>(); </div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160; </div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  result = mpu_init(&amp;int_param);</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;  <span class="keywordflow">if</span> (result) {</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;      MPL_LOGE(<span class="stringliteral">&quot;Could not initialize gyro.\n&quot;</span>);</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;  }</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;      MPL_LOGE(<span class="stringliteral">&quot;Initialise gyro successful.\n&quot;</span>);</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    }</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;  </div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;  result = inv_init_mpl();</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;  <span class="keywordflow">if</span> (result) {</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;      MPL_LOGE(<span class="stringliteral">&quot;Could not initialize MPL.\n&quot;</span>);</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;  }</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;      MPL_LOGE(<span class="stringliteral">&quot;Initialise MPL successful.\n&quot;</span>);</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;  }</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    inv_enable_quaternion();</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    inv_enable_9x_sensor_fusion();</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    inv_enable_fast_nomot();</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    inv_enable_gyro_tc();</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="preprocessor">#ifdef COMPASS_ENABLED</span></div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    inv_enable_vector_compass_cal();</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    inv_enable_magnetic_disturbance();</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    inv_enable_eMPL_outputs();</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;  result = inv_start_mpl();</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;  <span class="keywordflow">if</span> (result == INV_ERROR_NOT_AUTHORIZED) {</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;      <span class="keywordflow">while</span> (1) {</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;          MPL_LOGE(<span class="stringliteral">&quot;Not authorized.\n&quot;</span>);</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;      }</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;  }</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;  <span class="keywordflow">if</span> (result) {</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;      MPL_LOGE(<span class="stringliteral">&quot;Could not start the MPL.\n&quot;</span>);</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;  }</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;<span class="preprocessor">#ifdef COMPASS_ENABLED</span></div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    mpu_set_sensors(INV_XYZ_GYRO | INV_XYZ_ACCEL | INV_XYZ_COMPASS);</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    mpu_set_sensors(INV_XYZ_GYRO | INV_XYZ_ACCEL);</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    mpu_configure_fifo(INV_XYZ_GYRO | INV_XYZ_ACCEL);</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    mpu_set_sample_rate(<a class="code" href="group__eMPL.html#ga292d717406e906831952ce46612fe4cd">DEFAULT_MPU_HZ</a>);</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;<span class="preprocessor">#ifdef COMPASS_ENABLED</span></div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    mpu_set_compass_sample_rate(1000 / <a class="code" href="group__eMPL.html#ga0718d456616de258f21190908610fdf6">COMPASS_READ_MS</a>);</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    mpu_get_sample_rate(&amp;gyro_rate);</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    mpu_get_gyro_fsr(&amp;gyro_fsr);</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    mpu_get_accel_fsr(&amp;accel_fsr);</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;<span class="preprocessor">#ifdef COMPASS_ENABLED</span></div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    mpu_get_compass_fsr(&amp;compass_fsr);</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    inv_set_gyro_sample_rate(1000000L / gyro_rate);</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    inv_set_accel_sample_rate(1000000L / gyro_rate);</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;<span class="preprocessor">#ifdef COMPASS_ENABLED</span></div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    <span class="comment">/* The compass rate is independent of the gyro and accel rates. As long as</span></div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;<span class="comment">     * inv_set_compass_sample_rate is called with the correct value, the 9-axis</span></div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;<span class="comment">     * fusion algorithm&#39;s compass correction gain will work properly.</span></div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    inv_set_compass_sample_rate(<a class="code" href="group__eMPL.html#ga0718d456616de258f21190908610fdf6">COMPASS_READ_MS</a> * 1000L);</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    inv_set_gyro_orientation_and_scale(</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;            inv_orientation_matrix_to_scalar(<a class="code" href="group__eMPL.html#ga6baed579bec05b70f94fb3b420c7f27a">gyro_pdata</a>.<a class="code" href="group__eMPL.html#gaf119b3b2187456063d2687f989236daf">orientation</a>),</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;            (<span class="keywordtype">long</span>)gyro_fsr&lt;&lt;15);</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    inv_set_accel_orientation_and_scale(</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;            inv_orientation_matrix_to_scalar(<a class="code" href="group__eMPL.html#ga6baed579bec05b70f94fb3b420c7f27a">gyro_pdata</a>.<a class="code" href="group__eMPL.html#gaf119b3b2187456063d2687f989236daf">orientation</a>),</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;            (<span class="keywordtype">long</span>)accel_fsr&lt;&lt;15);</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="preprocessor">#ifdef COMPASS_ENABLED</span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    inv_set_compass_orientation_and_scale(</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;            inv_orientation_matrix_to_scalar(compass_pdata.orientation),</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;            (<span class="keywordtype">long</span>)compass_fsr&lt;&lt;15);</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;<span class="preprocessor">#ifdef COMPASS_ENABLED</span></div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    <a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#gaaa21c01566947e7007476657cb614e3f">sensors</a> = <a class="code" href="group__eMPL.html#ga96e2dc57b8fe509f98cbbb52811717c3">ACCEL_ON</a> | <a class="code" href="group__eMPL.html#ga1abb1b0f967cb0c0f3a0910f18241889">GYRO_ON</a> | <a class="code" href="group__eMPL.html#gac4b29ad9d2af05af504ca053f3c5d76d">COMPASS_ON</a>;</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    <a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#gaaa21c01566947e7007476657cb614e3f">sensors</a> = <a class="code" href="group__eMPL.html#ga96e2dc57b8fe509f98cbbb52811717c3">ACCEL_ON</a> | <a class="code" href="group__eMPL.html#ga1abb1b0f967cb0c0f3a0910f18241889">GYRO_ON</a>;</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    <a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#ga49fb51079238683b21264827348b5968">dmp_on</a> = 0;</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    <a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#ga5ab95f126fb29c3c65d6f4aa4944a2f7">report</a> = 0;</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    <a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#ga02c35d11f6cb2fd88475c231ddf6afce">rx</a>.<a class="code" href="group__eMPL.html#ga42416d99bb2db2007e3b19b8951fea0d">cmd</a> = 0;</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    <a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#gaa40f644b7de352cb9ad81e2c602b5bae">next_pedo_ms</a> = 0;</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    <a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#ga7e499f7a5d40750be7a5ba81761a56bd">next_compass_ms</a> = 0;</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    <a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#ga6f7f2c3d9913da113b6c5df295f50422">next_temp_ms</a> = 0;</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;  <a class="code" href="board-st__discovery_8c.html#ae640b1a6fa58dce2fd3858ed0df803c0">get_tick_count</a>(&amp;timestamp);</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    dmp_load_motion_driver_firmware();</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    dmp_set_orientation(</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;        inv_orientation_matrix_to_scalar(<a class="code" href="group__eMPL.html#ga6baed579bec05b70f94fb3b420c7f27a">gyro_pdata</a>.<a class="code" href="group__eMPL.html#gaf119b3b2187456063d2687f989236daf">orientation</a>));</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    dmp_register_tap_cb(<a class="code" href="group__eMPL.html#gab1f482e5c0712ab28da61a1eff46fc75">tap_cb</a>);</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    dmp_register_android_orient_cb(<a class="code" href="group__eMPL.html#gaa4a8ed4fa732bc82b2b518d80d196297">android_orient_cb</a>);</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    <a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#gab90560c34732c55496e27d7aad8b9ce2">dmp_features</a> = DMP_FEATURE_6X_LP_QUAT | DMP_FEATURE_TAP |</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;        DMP_FEATURE_ANDROID_ORIENT | DMP_FEATURE_SEND_RAW_ACCEL | DMP_FEATURE_SEND_CAL_GYRO |</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;        DMP_FEATURE_GYRO_CAL;</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    dmp_enable_feature(<a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#gab90560c34732c55496e27d7aad8b9ce2">dmp_features</a>);</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    dmp_set_fifo_rate(<a class="code" href="group__eMPL.html#ga292d717406e906831952ce46612fe4cd">DEFAULT_MPU_HZ</a>);</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    mpu_set_dmp_state(1);</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    <a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#ga49fb51079238683b21264827348b5968">dmp_on</a> = 1;</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;  <span class="keywordflow">while</span>(1){</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    </div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> sensor_timestamp;</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    <span class="keywordtype">int</span> new_data = 0;</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__USART__Group9.html#ga93d8f031241bcdbe938d091a85295445">USART_GetITStatus</a>(<a class="code" href="group__Peripheral__declaration.html#ga92871691058ff7ccffd7635930cb08da">USART1</a>, <a class="code" href="group__USART__Interrupt__definition.html#gacdd49b93072655a21a63a35e6431f8ae">USART_IT_RXNE</a>)) {</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    <span class="comment">//if (USART_GetITStatus(USART2, USART_IT_RXNE)) {</span></div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;<span class="comment"></span>        <a class="code" href="group__USART__Group9.html#ga1fc25d0338695063be5e50156955d9bc">USART_ClearITPendingBit</a>(<a class="code" href="group__Peripheral__declaration.html#ga92871691058ff7ccffd7635930cb08da">USART1</a>, <a class="code" href="group__USART__Interrupt__definition.html#gacdd49b93072655a21a63a35e6431f8ae">USART_IT_RXNE</a>);</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;        <span class="comment">//USART_ClearITPendingBit(USART2, USART_IT_RXNE);</span></div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;        <a class="code" href="group__eMPL.html#ga2ccb744024182ca302323f00a7acd796">handle_input</a>();</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    }</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    <a class="code" href="board-st__discovery_8c.html#ae640b1a6fa58dce2fd3858ed0df803c0">get_tick_count</a>(&amp;timestamp);</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;<span class="preprocessor">#ifdef COMPASS_ENABLED</span></div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;        <span class="keywordflow">if</span> ((timestamp &gt; <a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#ga7e499f7a5d40750be7a5ba81761a56bd">next_compass_ms</a>) &amp;&amp; !<a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#gaeb8fb45fc306b199be68b3f61940fbb0">lp_accel_mode</a> &amp;&amp;</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;            <a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#gacfce447bdb258e6fcf8e12e1b6e4481a">new_gyro</a> &amp;&amp; (<a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#gaaa21c01566947e7007476657cb614e3f">sensors</a> &amp; <a class="code" href="group__eMPL.html#gac4b29ad9d2af05af504ca053f3c5d76d">COMPASS_ON</a>)) {</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;            <a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#ga7e499f7a5d40750be7a5ba81761a56bd">next_compass_ms</a> = timestamp + <a class="code" href="group__eMPL.html#ga0718d456616de258f21190908610fdf6">COMPASS_READ_MS</a>;</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;            new_compass = 1;</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;        }</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;        <span class="keywordflow">if</span> (timestamp &gt; <a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#ga6f7f2c3d9913da113b6c5df295f50422">next_temp_ms</a>) {</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;            <a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#ga6f7f2c3d9913da113b6c5df295f50422">next_temp_ms</a> = timestamp + <a class="code" href="group__eMPL.html#ga209a05c6769a81d074903aaffe2f44a6">TEMP_READ_MS</a>;</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;            new_temp = 1;</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;        }</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#gafb031e775df5d8654f1ac1170378eb8d">motion_int_mode</a>) {</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;        mpu_lp_motion_interrupt(500, 1, 5);</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;        inv_accel_was_turned_off();</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;        inv_gyro_was_turned_off();</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;        inv_compass_was_turned_off();</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;        inv_quaternion_sensor_was_turned_off();</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;        <span class="keywordflow">while</span> (!<a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#gacfce447bdb258e6fcf8e12e1b6e4481a">new_gyro</a>) {}</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;        mpu_lp_motion_interrupt(0, 0, 0);</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;        <a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#gafb031e775df5d8654f1ac1170378eb8d">motion_int_mode</a> = 0;</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    }</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#gaaa21c01566947e7007476657cb614e3f">sensors</a> || !<a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#gacfce447bdb258e6fcf8e12e1b6e4481a">new_gyro</a>) {</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    }    </div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#gacfce447bdb258e6fcf8e12e1b6e4481a">new_gyro</a> &amp;&amp; <a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#gaeb8fb45fc306b199be68b3f61940fbb0">lp_accel_mode</a>) {</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;            <span class="keywordtype">short</span> accel_short[3];</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;            <span class="keywordtype">long</span> accel[3];</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;            mpu_get_accel_reg(accel_short, &amp;sensor_timestamp);</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;            accel[0] = (long)accel_short[0];</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;            accel[1] = (long)accel_short[1];</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;            accel[2] = (long)accel_short[2];</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;            inv_build_accel(accel, 0, sensor_timestamp);</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;            new_data = 1;</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;            <a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#gacfce447bdb258e6fcf8e12e1b6e4481a">new_gyro</a> = 0;</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#gacfce447bdb258e6fcf8e12e1b6e4481a">new_gyro</a> &amp;&amp; <a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#ga49fb51079238683b21264827348b5968">dmp_on</a>) {</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;            <span class="keywordtype">short</span> gyro[3], accel_short[3], sensors;</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> more;</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;            <span class="keywordtype">long</span> accel[3], quat[4], temperature;</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;            dmp_read_fifo(gyro, accel_short, quat, &amp;sensor_timestamp, &amp;sensors, &amp;more);</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;            <span class="keywordflow">if</span> (!more)</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;                <a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#gacfce447bdb258e6fcf8e12e1b6e4481a">new_gyro</a> = 0;</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;            <span class="keywordflow">if</span> (sensors &amp; INV_XYZ_GYRO) {</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;                inv_build_gyro(gyro, sensor_timestamp);</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;                new_data = 1;</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;                <span class="keywordflow">if</span> (new_temp) {</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;                    new_temp = 0;</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;                    mpu_get_temperature(&amp;temperature, &amp;sensor_timestamp);</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;                    inv_build_temp(temperature, sensor_timestamp);</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;                }</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;            }</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;            <span class="keywordflow">if</span> (sensors &amp; INV_XYZ_ACCEL) {</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;                accel[0] = (long)accel_short[0];</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;                accel[1] = (long)accel_short[1];</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;                accel[2] = (long)accel_short[2];</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;                inv_build_accel(accel, 0, sensor_timestamp);</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;                new_data = 1;</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;            }</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;            <span class="keywordflow">if</span> (sensors &amp; INV_WXYZ_QUAT) {</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                inv_build_quat(quat, 0, sensor_timestamp);</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;                new_data = 1;</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;            }</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#gacfce447bdb258e6fcf8e12e1b6e4481a">new_gyro</a>) {</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;            <span class="keywordtype">short</span> gyro[3], accel_short[3];</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> sensors, more;</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;            <span class="keywordtype">long</span> accel[3], temperature;</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;            <a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#gacfce447bdb258e6fcf8e12e1b6e4481a">new_gyro</a> = 0;</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;            mpu_read_fifo(gyro, accel_short, &amp;sensor_timestamp,</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;                &amp;sensors, &amp;more);</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;            <span class="keywordflow">if</span> (more)</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;                <a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#gacfce447bdb258e6fcf8e12e1b6e4481a">new_gyro</a> = 1;</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;            <span class="keywordflow">if</span> (sensors &amp; INV_XYZ_GYRO) {</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;                inv_build_gyro(gyro, sensor_timestamp);</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;                new_data = 1;</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;                <span class="keywordflow">if</span> (new_temp) {</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;                    new_temp = 0;</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;                    mpu_get_temperature(&amp;temperature, &amp;sensor_timestamp);</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;                    inv_build_temp(temperature, sensor_timestamp);</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;                }</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;            }</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;            <span class="keywordflow">if</span> (sensors &amp; INV_XYZ_ACCEL) {</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;                accel[0] = (long)accel_short[0];</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;                accel[1] = (long)accel_short[1];</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;                accel[2] = (long)accel_short[2];</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;                inv_build_accel(accel, 0, sensor_timestamp);</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;                new_data = 1;</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;            }</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;        }</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;<span class="preprocessor">#ifdef COMPASS_ENABLED</span></div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;        <span class="keywordflow">if</span> (new_compass) {</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;            <span class="keywordtype">short</span> compass_short[3];</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;            <span class="keywordtype">long</span> compass[3];</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;            new_compass = 0;</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;            <span class="keywordflow">if</span> (!mpu_get_compass_reg(compass_short, &amp;sensor_timestamp)) {</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;                compass[0] = (long)compass_short[0];</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;                compass[1] = (long)compass_short[1];</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;                compass[2] = (long)compass_short[2];</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;                inv_build_compass(compass, 0, sensor_timestamp);</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;            }</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;            new_data = 1;</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;        }</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;        <span class="keywordflow">if</span> (new_data) {</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;            inv_execute_on_data();</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;            <a class="code" href="group__eMPL.html#ga6a14df92edfa4e41346035ca5bf0d991">read_from_mpl</a>();</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;        }</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;    }</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;}</div><div class="ttc" id="group__USART__Group9_html_ga93d8f031241bcdbe938d091a85295445"><div class="ttname"><a href="group__USART__Group9.html#ga93d8f031241bcdbe938d091a85295445">USART_GetITStatus</a></div><div class="ttdeci">ITStatus USART_GetITStatus(USART_TypeDef *USARTx, uint16_t USART_IT)</div><div class="ttdoc">Checks whether the specified USART interrupt has occurred or not. </div><div class="ttdef"><b>Definition:</b> <a href="stm32f4xx__usart_8c_source.html#l01355">stm32f4xx_usart.c:1355</a></div></div>
<div class="ttc" id="group__eMPL_html_gafb031e775df5d8654f1ac1170378eb8d"><div class="ttname"><a href="group__eMPL.html#gafb031e775df5d8654f1ac1170378eb8d">hal_s::motion_int_mode</a></div><div class="ttdeci">unsigned char motion_int_mode</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00072">main.c:72</a></div></div>
<div class="ttc" id="group__eMPL_html_gab90560c34732c55496e27d7aad8b9ce2"><div class="ttname"><a href="group__eMPL.html#gab90560c34732c55496e27d7aad8b9ce2">hal_s::dmp_features</a></div><div class="ttdeci">unsigned short dmp_features</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00078">main.c:78</a></div></div>
<div class="ttc" id="board-st__discovery_8c_html_ad7d81512b0ce3a7214547801a3e41264"><div class="ttname"><a href="board-st__discovery_8c.html#ad7d81512b0ce3a7214547801a3e41264">board_init</a></div><div class="ttdeci">void board_init()</div><div class="ttdef"><b>Definition:</b> <a href="board-st__discovery_8c_source.html#l00017">board-st_discovery.c:17</a></div></div>
<div class="ttc" id="group__eMPL_html_ga0718d456616de258f21190908610fdf6"><div class="ttname"><a href="group__eMPL.html#ga0718d456616de258f21190908610fdf6">COMPASS_READ_MS</a></div><div class="ttdeci">#define COMPASS_READ_MS</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00059">main.c:59</a></div></div>
<div class="ttc" id="group__eMPL_html_ga6a14df92edfa4e41346035ca5bf0d991"><div class="ttname"><a href="group__eMPL.html#ga6a14df92edfa4e41346035ca5bf0d991">read_from_mpl</a></div><div class="ttdeci">static void read_from_mpl(void)</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00143">main.c:143</a></div></div>
<div class="ttc" id="group__eMPL_html_ga6baed579bec05b70f94fb3b420c7f27a"><div class="ttname"><a href="group__eMPL.html#ga6baed579bec05b70f94fb3b420c7f27a">gyro_pdata</a></div><div class="ttdeci">static struct platform_data_s gyro_pdata</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00102">main.c:102</a></div></div>
<div class="ttc" id="group__eMPL_html_ga2ccb744024182ca302323f00a7acd796"><div class="ttname"><a href="group__eMPL.html#ga2ccb744024182ca302323f00a7acd796">handle_input</a></div><div class="ttdeci">static void handle_input(void)</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00408">main.c:408</a></div></div>
<div class="ttc" id="group__eMPL_html_ga209a05c6769a81d074903aaffe2f44a6"><div class="ttname"><a href="group__eMPL.html#ga209a05c6769a81d074903aaffe2f44a6">TEMP_READ_MS</a></div><div class="ttdeci">#define TEMP_READ_MS</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00058">main.c:58</a></div></div>
<div class="ttc" id="group__eMPL_html_ga3cb1077f30b35eae5e6f9eb104179ec2"><div class="ttname"><a href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a></div><div class="ttdeci">static struct hal_s hal</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00081">main.c:81</a></div></div>
<div class="ttc" id="group__eMPL_html_ga49fb51079238683b21264827348b5968"><div class="ttname"><a href="group__eMPL.html#ga49fb51079238683b21264827348b5968">hal_s::dmp_on</a></div><div class="ttdeci">unsigned char dmp_on</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00069">main.c:69</a></div></div>
<div class="ttc" id="group__eMPL_html_ga1abb1b0f967cb0c0f3a0910f18241889"><div class="ttname"><a href="group__eMPL.html#ga1abb1b0f967cb0c0f3a0910f18241889">GYRO_ON</a></div><div class="ttdeci">#define GYRO_ON</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00045">main.c:45</a></div></div>
<div class="ttc" id="group__eMPL_html_ga7e499f7a5d40750be7a5ba81761a56bd"><div class="ttname"><a href="group__eMPL.html#ga7e499f7a5d40750be7a5ba81761a56bd">hal_s::next_compass_ms</a></div><div class="ttdeci">unsigned long next_compass_ms</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00076">main.c:76</a></div></div>
<div class="ttc" id="group__Peripheral__declaration_html_ga92871691058ff7ccffd7635930cb08da"><div class="ttname"><a href="group__Peripheral__declaration.html#ga92871691058ff7ccffd7635930cb08da">USART1</a></div><div class="ttdeci">#define USART1</div><div class="ttdef"><b>Definition:</b> <a href="stm32f4xx_8h_source.html#l01170">stm32f4xx.h:1170</a></div></div>
<div class="ttc" id="group__eMPL_html_ga96e2dc57b8fe509f98cbbb52811717c3"><div class="ttname"><a href="group__eMPL.html#ga96e2dc57b8fe509f98cbbb52811717c3">ACCEL_ON</a></div><div class="ttdeci">#define ACCEL_ON</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00044">main.c:44</a></div></div>
<div class="ttc" id="group__eMPL_html_gaeb8fb45fc306b199be68b3f61940fbb0"><div class="ttname"><a href="group__eMPL.html#gaeb8fb45fc306b199be68b3f61940fbb0">hal_s::lp_accel_mode</a></div><div class="ttdeci">unsigned char lp_accel_mode</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00067">main.c:67</a></div></div>
<div class="ttc" id="group__eMPL_html_gaf119b3b2187456063d2687f989236daf"><div class="ttname"><a href="group__eMPL.html#gaf119b3b2187456063d2687f989236daf">platform_data_s::orientation</a></div><div class="ttdeci">signed char orientation[9]</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00092">main.c:92</a></div></div>
<div class="ttc" id="group__eMPL_html_ga5ab95f126fb29c3c65d6f4aa4944a2f7"><div class="ttname"><a href="group__eMPL.html#ga5ab95f126fb29c3c65d6f4aa4944a2f7">hal_s::report</a></div><div class="ttdeci">unsigned int report</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00077">main.c:77</a></div></div>
<div class="ttc" id="group__eMPL_html_gab1f482e5c0712ab28da61a1eff46fc75"><div class="ttname"><a href="group__eMPL.html#gab1f482e5c0712ab28da61a1eff46fc75">tap_cb</a></div><div class="ttdeci">static void tap_cb(unsigned char direction, unsigned char count)</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00279">main.c:279</a></div></div>
<div class="ttc" id="board-st__discovery_8c_html_ae640b1a6fa58dce2fd3858ed0df803c0"><div class="ttname"><a href="board-st__discovery_8c.html#ae640b1a6fa58dce2fd3858ed0df803c0">get_tick_count</a></div><div class="ttdeci">int get_tick_count(unsigned long *count)</div><div class="ttdef"><b>Definition:</b> <a href="board-st__discovery_8c_source.html#l00055">board-st_discovery.c:55</a></div></div>
<div class="ttc" id="group__eMPL_html_gaa4a8ed4fa732bc82b2b518d80d196297"><div class="ttname"><a href="group__eMPL.html#gaa4a8ed4fa732bc82b2b518d80d196297">android_orient_cb</a></div><div class="ttdeci">static void android_orient_cb(unsigned char orientation)</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00310">main.c:310</a></div></div>
<div class="ttc" id="group__eMPL_html_gaa40f644b7de352cb9ad81e2c602b5bae"><div class="ttname"><a href="group__eMPL.html#gaa40f644b7de352cb9ad81e2c602b5bae">hal_s::next_pedo_ms</a></div><div class="ttdeci">unsigned long next_pedo_ms</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00074">main.c:74</a></div></div>
<div class="ttc" id="group__USART__Group9_html_ga1fc25d0338695063be5e50156955d9bc"><div class="ttname"><a href="group__USART__Group9.html#ga1fc25d0338695063be5e50156955d9bc">USART_ClearITPendingBit</a></div><div class="ttdeci">void USART_ClearITPendingBit(USART_TypeDef *USARTx, uint16_t USART_IT)</div><div class="ttdoc">Clears the USARTx&amp;#39;s interrupt pending bits. </div><div class="ttdef"><b>Definition:</b> <a href="stm32f4xx__usart_8c_source.html#l01429">stm32f4xx_usart.c:1429</a></div></div>
<div class="ttc" id="group__USART__Interrupt__definition_html_gacdd49b93072655a21a63a35e6431f8ae"><div class="ttname"><a href="group__USART__Interrupt__definition.html#gacdd49b93072655a21a63a35e6431f8ae">USART_IT_RXNE</a></div><div class="ttdeci">#define USART_IT_RXNE</div><div class="ttdef"><b>Definition:</b> <a href="stm32f4xx__usart_8h_source.html#l00240">stm32f4xx_usart.h:240</a></div></div>
<div class="ttc" id="group__eMPL_html_ga6f7f2c3d9913da113b6c5df295f50422"><div class="ttname"><a href="group__eMPL.html#ga6f7f2c3d9913da113b6c5df295f50422">hal_s::next_temp_ms</a></div><div class="ttdeci">unsigned long next_temp_ms</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00075">main.c:75</a></div></div>
<div class="ttc" id="group__eMPL_html_gaaa21c01566947e7007476657cb614e3f"><div class="ttname"><a href="group__eMPL.html#gaaa21c01566947e7007476657cb614e3f">hal_s::sensors</a></div><div class="ttdeci">unsigned char sensors</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00068">main.c:68</a></div></div>
<div class="ttc" id="group__eMPL_html_ga292d717406e906831952ce46612fe4cd"><div class="ttname"><a href="group__eMPL.html#ga292d717406e906831952ce46612fe4cd">DEFAULT_MPU_HZ</a></div><div class="ttdeci">#define DEFAULT_MPU_HZ</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00052">main.c:52</a></div></div>
<div class="ttc" id="group__eMPL_html_gac4b29ad9d2af05af504ca053f3c5d76d"><div class="ttname"><a href="group__eMPL.html#gac4b29ad9d2af05af504ca053f3c5d76d">COMPASS_ON</a></div><div class="ttdeci">#define COMPASS_ON</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00046">main.c:46</a></div></div>
<div class="ttc" id="group__eMPL_html_ga02c35d11f6cb2fd88475c231ddf6afce"><div class="ttname"><a href="group__eMPL.html#ga02c35d11f6cb2fd88475c231ddf6afce">hal_s::rx</a></div><div class="ttdeci">struct rx_s rx</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00079">main.c:79</a></div></div>
<div class="ttc" id="group__eMPL_html_gacfce447bdb258e6fcf8e12e1b6e4481a"><div class="ttname"><a href="group__eMPL.html#gacfce447bdb258e6fcf8e12e1b6e4481a">hal_s::new_gyro</a></div><div class="ttdeci">volatile unsigned char new_gyro</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00071">main.c:71</a></div></div>
<div class="ttc" id="group__eMPL_html_ga42416d99bb2db2007e3b19b8951fea0d"><div class="ttname"><a href="group__eMPL.html#ga42416d99bb2db2007e3b19b8951fea0d">rx_s::cmd</a></div><div class="ttdeci">unsigned char cmd</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00063">main.c:63</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga6a14df92edfa4e41346035ca5bf0d991"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6a14df92edfa4e41346035ca5bf0d991">&#9670;&nbsp;</a></span>read_from_mpl()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void read_from_mpl </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compass calibration for MPU9150</p>
<p>Private define ---------------------------------------------&mdash;&mdash;&mdash;&mdash;&mdash; </p>
<p>CLocal Variable init</p>
<p>Sends a quaternion packet to the PC. Since this is used by the Python test app to visually represent a 3D quaternion, it's sent each time the MPL has new data.</p>
<p>Specific data packets can be sent or suppressed using USB commands.</p>
<p>Whenever the MPL detects a change in motion state, the application can be notified. For this example, we use an LED to represent the current motion state.</p>

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00143">143</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

<p class="reference">References <a class="el" href="board-st__discovery_8c_source.html#l00055">get_tick_count()</a>, <a class="el" href="main_8c_source.html#l00081">hal</a>, <a class="el" href="main_8c_source.html#l00074">hal_s::next_pedo_ms</a>, and <a class="el" href="main_8c_source.html#l00077">hal_s::report</a>.</p>

<p class="reference">Referenced by <a class="el" href="main_8c_source.html#l00665">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;{</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordtype">long</span> msg, data[9];</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    int8_t accuracy;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> timestamp;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keywordtype">float</span> float_data[3] = {0};</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keywordflow">if</span> (inv_get_sensor_type_quat(data, &amp;accuracy, (inv_time_t*)&amp;timestamp)) {</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        eMPL_send_quat(data);</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#ga5ab95f126fb29c3c65d6f4aa4944a2f7">report</a> &amp; <a class="code" href="group__eMPL.html#ga709f1d5781d96858850143298f88104c">PRINT_QUAT</a>)</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            eMPL_send_data(PACKET_DATA_QUAT, data);</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    }</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#ga5ab95f126fb29c3c65d6f4aa4944a2f7">report</a> &amp; <a class="code" href="group__eMPL.html#ga83c044582a9fec2e45f8858efa5885b8">PRINT_ACCEL</a>) {</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <span class="keywordflow">if</span> (inv_get_sensor_type_accel(data, &amp;accuracy,</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            (inv_time_t*)&amp;timestamp))</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            eMPL_send_data(PACKET_DATA_ACCEL, data);</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    }</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#ga5ab95f126fb29c3c65d6f4aa4944a2f7">report</a> &amp; <a class="code" href="group__eMPL.html#ga1f7cea00edafdbe1570199b28042ddd3">PRINT_GYRO</a>) {</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <span class="keywordflow">if</span> (inv_get_sensor_type_gyro(data, &amp;accuracy,</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            (inv_time_t*)&amp;timestamp))</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            eMPL_send_data(PACKET_DATA_GYRO, data);</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    }</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="preprocessor">#ifdef COMPASS_ENABLED</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#ga5ab95f126fb29c3c65d6f4aa4944a2f7">report</a> &amp; <a class="code" href="group__eMPL.html#gae55039e3cf38b78e1ec327c3e81d2859">PRINT_COMPASS</a>) {</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <span class="keywordflow">if</span> (inv_get_sensor_type_compass(data, &amp;accuracy,</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            (inv_time_t*)&amp;timestamp))</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            eMPL_send_data(PACKET_DATA_COMPASS, data);</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    }</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#ga5ab95f126fb29c3c65d6f4aa4944a2f7">report</a> &amp; <a class="code" href="group__eMPL.html#gabfb66b3aafb997de9897c558dfc34b8e">PRINT_EULER</a>) {</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        <span class="keywordflow">if</span> (inv_get_sensor_type_euler(data, &amp;accuracy,</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            (inv_time_t*)&amp;timestamp))</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            eMPL_send_data(PACKET_DATA_EULER, data);</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    }</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#ga5ab95f126fb29c3c65d6f4aa4944a2f7">report</a> &amp; <a class="code" href="group__eMPL.html#ga83fe59ee63a2dd6ba73760f07a21ee95">PRINT_ROT_MAT</a>) {</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <span class="keywordflow">if</span> (inv_get_sensor_type_rot_mat(data, &amp;accuracy,</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            (inv_time_t*)&amp;timestamp))</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            eMPL_send_data(PACKET_DATA_ROT, data);</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    }</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#ga5ab95f126fb29c3c65d6f4aa4944a2f7">report</a> &amp; <a class="code" href="group__eMPL.html#ga39965157fdb18499d2665cdb203971dd">PRINT_HEADING</a>) {</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        <span class="keywordflow">if</span> (inv_get_sensor_type_heading(data, &amp;accuracy,</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            (inv_time_t*)&amp;timestamp))</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            eMPL_send_data(PACKET_DATA_HEADING, data);</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    }</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#ga5ab95f126fb29c3c65d6f4aa4944a2f7">report</a> &amp; <a class="code" href="group__eMPL.html#ga247e0609bfe123b5d988f0c63e99bf76">PRINT_LINEAR_ACCEL</a>) {</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <span class="keywordflow">if</span> (inv_get_sensor_type_linear_acceleration(float_data, &amp;accuracy, (inv_time_t*)&amp;timestamp)) {</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            MPL_LOGI(<span class="stringliteral">&quot;Linear Accel: %7.5f %7.5f %7.5f\r\n&quot;</span>,</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                    float_data[0], float_data[1], float_data[2]);                                        </div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;         }</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    }</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#ga5ab95f126fb29c3c65d6f4aa4944a2f7">report</a> &amp; <a class="code" href="group__eMPL.html#ga31581e6a5034c28ac6270530f4b17e51">PRINT_GRAVITY_VECTOR</a>) {</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            <span class="keywordflow">if</span> (inv_get_sensor_type_gravity(float_data, &amp;accuracy,</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                (inv_time_t*)&amp;timestamp))</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                MPL_LOGI(<span class="stringliteral">&quot;Gravity Vector: %7.5f %7.5f %7.5f\r\n&quot;</span>,</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                        float_data[0], float_data[1], float_data[2]);</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    }</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#ga5ab95f126fb29c3c65d6f4aa4944a2f7">report</a> &amp; <a class="code" href="group__eMPL.html#gafc50e337bac90191d386f47e3cf49a7d">PRINT_PEDO</a>) {</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> timestamp;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <a class="code" href="board-st__discovery_8c.html#ae640b1a6fa58dce2fd3858ed0df803c0">get_tick_count</a>(&amp;timestamp);</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        <span class="keywordflow">if</span> (timestamp &gt; <a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#gaa40f644b7de352cb9ad81e2c602b5bae">next_pedo_ms</a>) {</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;            <a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#gaa40f644b7de352cb9ad81e2c602b5bae">next_pedo_ms</a> = timestamp + <a class="code" href="group__eMPL.html#ga77888d9bc269c75d63baf58cd000c7d9">PEDO_READ_MS</a>;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> step_count, walk_time;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            dmp_get_pedometer_step_count(&amp;step_count);</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            dmp_get_pedometer_walk_time(&amp;walk_time);</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            MPL_LOGI(<span class="stringliteral">&quot;Walked %ld steps over %ld milliseconds..\n&quot;</span>, step_count,</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            walk_time);</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        }</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    }</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    msg = inv_get_message_level_0(INV_MSG_MOTION_EVENT |</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;            INV_MSG_NO_MOTION_EVENT);</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keywordflow">if</span> (msg) {</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <span class="keywordflow">if</span> (msg &amp; INV_MSG_MOTION_EVENT) {</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            MPL_LOGI(<span class="stringliteral">&quot;Motion!\n&quot;</span>);</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (msg &amp; INV_MSG_NO_MOTION_EVENT) {</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            MPL_LOGI(<span class="stringliteral">&quot;No motion!\n&quot;</span>);</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        }</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    }</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;}</div><div class="ttc" id="group__eMPL_html_gae55039e3cf38b78e1ec327c3e81d2859"><div class="ttname"><a href="group__eMPL.html#gae55039e3cf38b78e1ec327c3e81d2859">PRINT_COMPASS</a></div><div class="ttdeci">#define PRINT_COMPASS</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00035">main.c:35</a></div></div>
<div class="ttc" id="group__eMPL_html_ga83c044582a9fec2e45f8858efa5885b8"><div class="ttname"><a href="group__eMPL.html#ga83c044582a9fec2e45f8858efa5885b8">PRINT_ACCEL</a></div><div class="ttdeci">#define PRINT_ACCEL</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00032">main.c:32</a></div></div>
<div class="ttc" id="group__eMPL_html_ga77888d9bc269c75d63baf58cd000c7d9"><div class="ttname"><a href="group__eMPL.html#ga77888d9bc269c75d63baf58cd000c7d9">PEDO_READ_MS</a></div><div class="ttdeci">#define PEDO_READ_MS</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00057">main.c:57</a></div></div>
<div class="ttc" id="group__eMPL_html_gafc50e337bac90191d386f47e3cf49a7d"><div class="ttname"><a href="group__eMPL.html#gafc50e337bac90191d386f47e3cf49a7d">PRINT_PEDO</a></div><div class="ttdeci">#define PRINT_PEDO</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00039">main.c:39</a></div></div>
<div class="ttc" id="group__eMPL_html_ga39965157fdb18499d2665cdb203971dd"><div class="ttname"><a href="group__eMPL.html#ga39965157fdb18499d2665cdb203971dd">PRINT_HEADING</a></div><div class="ttdeci">#define PRINT_HEADING</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00038">main.c:38</a></div></div>
<div class="ttc" id="group__eMPL_html_ga1f7cea00edafdbe1570199b28042ddd3"><div class="ttname"><a href="group__eMPL.html#ga1f7cea00edafdbe1570199b28042ddd3">PRINT_GYRO</a></div><div class="ttdeci">#define PRINT_GYRO</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00033">main.c:33</a></div></div>
<div class="ttc" id="group__eMPL_html_ga3cb1077f30b35eae5e6f9eb104179ec2"><div class="ttname"><a href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a></div><div class="ttdeci">static struct hal_s hal</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00081">main.c:81</a></div></div>
<div class="ttc" id="group__eMPL_html_ga709f1d5781d96858850143298f88104c"><div class="ttname"><a href="group__eMPL.html#ga709f1d5781d96858850143298f88104c">PRINT_QUAT</a></div><div class="ttdeci">#define PRINT_QUAT</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00034">main.c:34</a></div></div>
<div class="ttc" id="group__eMPL_html_ga247e0609bfe123b5d988f0c63e99bf76"><div class="ttname"><a href="group__eMPL.html#ga247e0609bfe123b5d988f0c63e99bf76">PRINT_LINEAR_ACCEL</a></div><div class="ttdeci">#define PRINT_LINEAR_ACCEL</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00040">main.c:40</a></div></div>
<div class="ttc" id="group__eMPL_html_ga5ab95f126fb29c3c65d6f4aa4944a2f7"><div class="ttname"><a href="group__eMPL.html#ga5ab95f126fb29c3c65d6f4aa4944a2f7">hal_s::report</a></div><div class="ttdeci">unsigned int report</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00077">main.c:77</a></div></div>
<div class="ttc" id="board-st__discovery_8c_html_ae640b1a6fa58dce2fd3858ed0df803c0"><div class="ttname"><a href="board-st__discovery_8c.html#ae640b1a6fa58dce2fd3858ed0df803c0">get_tick_count</a></div><div class="ttdeci">int get_tick_count(unsigned long *count)</div><div class="ttdef"><b>Definition:</b> <a href="board-st__discovery_8c_source.html#l00055">board-st_discovery.c:55</a></div></div>
<div class="ttc" id="group__eMPL_html_ga31581e6a5034c28ac6270530f4b17e51"><div class="ttname"><a href="group__eMPL.html#ga31581e6a5034c28ac6270530f4b17e51">PRINT_GRAVITY_VECTOR</a></div><div class="ttdeci">#define PRINT_GRAVITY_VECTOR</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00041">main.c:41</a></div></div>
<div class="ttc" id="group__eMPL_html_gaa40f644b7de352cb9ad81e2c602b5bae"><div class="ttname"><a href="group__eMPL.html#gaa40f644b7de352cb9ad81e2c602b5bae">hal_s::next_pedo_ms</a></div><div class="ttdeci">unsigned long next_pedo_ms</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00074">main.c:74</a></div></div>
<div class="ttc" id="group__eMPL_html_ga83fe59ee63a2dd6ba73760f07a21ee95"><div class="ttname"><a href="group__eMPL.html#ga83fe59ee63a2dd6ba73760f07a21ee95">PRINT_ROT_MAT</a></div><div class="ttdeci">#define PRINT_ROT_MAT</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00037">main.c:37</a></div></div>
<div class="ttc" id="group__eMPL_html_gabfb66b3aafb997de9897c558dfc34b8e"><div class="ttname"><a href="group__eMPL.html#gabfb66b3aafb997de9897c558dfc34b8e">PRINT_EULER</a></div><div class="ttdeci">#define PRINT_EULER</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00036">main.c:36</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gada9a71be1d41b7964984028357749505"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gada9a71be1d41b7964984028357749505">&#9670;&nbsp;</a></span>run_self_test()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void run_self_test </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Self Test Function </p>
<p>Test passed. We can trust the gyro data here, so now we need to update calibrated data </p>

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00333">333</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="main_8c_source.html#l00408">handle_input()</a>.</p>
<div class="fragment"><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;{</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="keywordtype">int</span> result;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keywordtype">long</span> gyro[3], accel[3];</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="preprocessor">#if defined (MPU6500) || defined (MPU9250)</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    result = mpu_run_6500_self_test(gyro, accel, 0);</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="preprocessor">#elif defined (MPU6050) || defined (MPU9150)</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    result = mpu_run_self_test(gyro, accel);</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keywordflow">if</span> (result == 0x7) {</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    MPL_LOGI(<span class="stringliteral">&quot;Passed!\n&quot;</span>);</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        MPL_LOGI(<span class="stringliteral">&quot;accel: %7.4f %7.4f %7.4f\n&quot;</span>,</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                    accel[0]/65536.f,</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                    accel[1]/65536.f,</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                    accel[2]/65536.f);</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        MPL_LOGI(<span class="stringliteral">&quot;gyro: %7.4f %7.4f %7.4f\n&quot;</span>,</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                    gyro[0]/65536.f,</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                    gyro[1]/65536.f,</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                    gyro[2]/65536.f);</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="preprocessor">#ifdef USE_CAL_HW_REGISTERS</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> i = 0;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <span class="keywordflow">for</span>(i = 0; i&lt;3; i++) {</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;            gyro[i] = (long)(gyro[i] * 32.8f); <span class="comment">//convert to +-1000dps</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;            accel[i] *= 2048.f; <span class="comment">//convert to +-16G</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;            accel[i] = accel[i] &gt;&gt; 16;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;            gyro[i] = (long)(gyro[i] &gt;&gt; 16);</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        }</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        mpu_set_gyro_bias_reg(gyro);</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="preprocessor">#if defined (MPU6500) || defined (MPU9250)</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        mpu_set_accel_bias_6500_reg(accel);</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="preprocessor">#elif defined (MPU6050) || defined (MPU9150)</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        mpu_set_accel_bias_6050_reg(accel);</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        <span class="comment">/* Push the calibrated data to the MPL library.</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment">         *</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment">         * MPL expects biases in hardware units &lt;&lt; 16, but self test returns</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">         * biases in g&#39;s &lt;&lt; 16.</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> accel_sens;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        <span class="keywordtype">float</span> gyro_sens;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        mpu_get_accel_sens(&amp;accel_sens);</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        accel[0] *= accel_sens;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        accel[1] *= accel_sens;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        accel[2] *= accel_sens;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        inv_set_accel_bias(accel, 3);</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        mpu_get_gyro_sens(&amp;gyro_sens);</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        gyro[0] = (long) (gyro[0] * gyro_sens);</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        gyro[1] = (long) (gyro[1] * gyro_sens);</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        gyro[2] = (long) (gyro[2] * gyro_sens);</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        inv_set_gyro_bias(gyro, 3);</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    }</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;            <span class="keywordflow">if</span> (!(result &amp; 0x1))</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                MPL_LOGE(<span class="stringliteral">&quot;Gyro failed.\n&quot;</span>);</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;            <span class="keywordflow">if</span> (!(result &amp; 0x2))</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                MPL_LOGE(<span class="stringliteral">&quot;Accel failed.\n&quot;</span>);</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;            <span class="keywordflow">if</span> (!(result &amp; 0x4))</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                MPL_LOGE(<span class="stringliteral">&quot;Compass failed.\n&quot;</span>);</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;     }</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="ga399e39056041b2ec05d6f764e4f33b44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga399e39056041b2ec05d6f764e4f33b44">&#9670;&nbsp;</a></span>setup_gyro()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void setup_gyro </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Handle sensor on/off combinations. </p>
<p>If you need a power transition, this function should be called with a mask of the sensors still enabled. The driver turns off any sensors excluded from this mask.</p>
<p>Switching out of LP accel, notify MPL of new accel sampling rate. </p>

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00249">249</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

<p class="reference">References <a class="el" href="main_8c_source.html#l00081">hal</a>, <a class="el" href="main_8c_source.html#l00067">hal_s::lp_accel_mode</a>, and <a class="el" href="main_8c_source.html#l00068">hal_s::sensors</a>.</p>

<p class="reference">Referenced by <a class="el" href="main_8c_source.html#l00408">handle_input()</a>.</p>
<div class="fragment"><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;{</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> mask = 0, lp_accel_was_on = 0;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#gaaa21c01566947e7007476657cb614e3f">sensors</a> &amp; <a class="code" href="group__eMPL.html#ga96e2dc57b8fe509f98cbbb52811717c3">ACCEL_ON</a>)</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        mask |= INV_XYZ_ACCEL;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#gaaa21c01566947e7007476657cb614e3f">sensors</a> &amp; <a class="code" href="group__eMPL.html#ga1abb1b0f967cb0c0f3a0910f18241889">GYRO_ON</a>) {</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        mask |= INV_XYZ_GYRO;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        lp_accel_was_on |= <a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#gaeb8fb45fc306b199be68b3f61940fbb0">lp_accel_mode</a>;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    }</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="preprocessor">#ifdef COMPASS_ENABLED</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#gaaa21c01566947e7007476657cb614e3f">sensors</a> &amp; <a class="code" href="group__eMPL.html#gac4b29ad9d2af05af504ca053f3c5d76d">COMPASS_ON</a>) {</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        mask |= INV_XYZ_COMPASS;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        lp_accel_was_on |= <a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#gaeb8fb45fc306b199be68b3f61940fbb0">lp_accel_mode</a>;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    }</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    mpu_set_sensors(mask);</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    mpu_configure_fifo(mask);</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="keywordflow">if</span> (lp_accel_was_on) {</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> rate;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <a class="code" href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a>.<a class="code" href="group__eMPL.html#gaeb8fb45fc306b199be68b3f61940fbb0">lp_accel_mode</a> = 0;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        mpu_get_sample_rate(&amp;rate);</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        inv_set_accel_sample_rate(1000000L / rate);</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    }</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;}</div><div class="ttc" id="group__eMPL_html_ga3cb1077f30b35eae5e6f9eb104179ec2"><div class="ttname"><a href="group__eMPL.html#ga3cb1077f30b35eae5e6f9eb104179ec2">hal</a></div><div class="ttdeci">static struct hal_s hal</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00081">main.c:81</a></div></div>
<div class="ttc" id="group__eMPL_html_ga1abb1b0f967cb0c0f3a0910f18241889"><div class="ttname"><a href="group__eMPL.html#ga1abb1b0f967cb0c0f3a0910f18241889">GYRO_ON</a></div><div class="ttdeci">#define GYRO_ON</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00045">main.c:45</a></div></div>
<div class="ttc" id="group__eMPL_html_ga96e2dc57b8fe509f98cbbb52811717c3"><div class="ttname"><a href="group__eMPL.html#ga96e2dc57b8fe509f98cbbb52811717c3">ACCEL_ON</a></div><div class="ttdeci">#define ACCEL_ON</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00044">main.c:44</a></div></div>
<div class="ttc" id="group__eMPL_html_gaeb8fb45fc306b199be68b3f61940fbb0"><div class="ttname"><a href="group__eMPL.html#gaeb8fb45fc306b199be68b3f61940fbb0">hal_s::lp_accel_mode</a></div><div class="ttdeci">unsigned char lp_accel_mode</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00067">main.c:67</a></div></div>
<div class="ttc" id="group__eMPL_html_gaaa21c01566947e7007476657cb614e3f"><div class="ttname"><a href="group__eMPL.html#gaaa21c01566947e7007476657cb614e3f">hal_s::sensors</a></div><div class="ttdeci">unsigned char sensors</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00068">main.c:68</a></div></div>
<div class="ttc" id="group__eMPL_html_gac4b29ad9d2af05af504ca053f3c5d76d"><div class="ttname"><a href="group__eMPL.html#gac4b29ad9d2af05af504ca053f3c5d76d">COMPASS_ON</a></div><div class="ttdeci">#define COMPASS_ON</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00046">main.c:46</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gab1f482e5c0712ab28da61a1eff46fc75"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab1f482e5c0712ab28da61a1eff46fc75">&#9670;&nbsp;</a></span>tap_cb()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void tap_cb </td>
          <td>(</td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>direction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00279">279</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;{</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="keywordflow">switch</span> (direction) {</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keywordflow">case</span> TAP_X_UP:</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        MPL_LOGI(<span class="stringliteral">&quot;Tap X+ &quot;</span>);</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keywordflow">case</span> TAP_X_DOWN:</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        MPL_LOGI(<span class="stringliteral">&quot;Tap X- &quot;</span>);</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordflow">case</span> TAP_Y_UP:</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        MPL_LOGI(<span class="stringliteral">&quot;Tap Y+ &quot;</span>);</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="keywordflow">case</span> TAP_Y_DOWN:</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        MPL_LOGI(<span class="stringliteral">&quot;Tap Y- &quot;</span>);</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="keywordflow">case</span> TAP_Z_UP:</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        MPL_LOGI(<span class="stringliteral">&quot;Tap Z+ &quot;</span>);</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="keywordflow">case</span> TAP_Z_DOWN:</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        MPL_LOGI(<span class="stringliteral">&quot;Tap Z- &quot;</span>);</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    }</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    MPL_LOGI(<span class="stringliteral">&quot;x%d\n&quot;</span>, count);</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ga42416d99bb2db2007e3b19b8951fea0d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga42416d99bb2db2007e3b19b8951fea0d">&#9670;&nbsp;</a></span>cmd</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char cmd</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00063">63</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="main_8c_source.html#l00408">handle_input()</a>, and <a class="el" href="main_8c_source.html#l00665">main()</a>.</p>

</div>
</div>
<a id="gab90560c34732c55496e27d7aad8b9ce2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab90560c34732c55496e27d7aad8b9ce2">&#9670;&nbsp;</a></span>dmp_features</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned short dmp_features</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00078">78</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a id="ga49fb51079238683b21264827348b5968"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga49fb51079238683b21264827348b5968">&#9670;&nbsp;</a></span>dmp_on</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char dmp_on</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00069">69</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="main_8c_source.html#l00408">handle_input()</a>, and <a class="el" href="main_8c_source.html#l00665">main()</a>.</p>

</div>
</div>
<a id="ga6baed579bec05b70f94fb3b420c7f27a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6baed579bec05b70f94fb3b420c7f27a">&#9670;&nbsp;</a></span>gyro_pdata</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structplatform__data__s.html">platform_data_s</a> gyro_pdata</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div><div class="line">    .orientation = { 1, 0, 0,</div><div class="line">                     0, 1, 0,</div><div class="line">                     0, 0, 1}</div><div class="line">}</div></div><!-- fragment --><p>The sensors can be mounted onto the board in any orientation. The mounting matrix seen below tells the MPL how to rotate the raw data from the driver(s). TODO: The following matrices refer to the configuration on internal test boards at Invensense. If needed, please modify the matrices to match the chip-to-body matrix for your particular set up. </p>

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00102">102</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a id="ga3cb1077f30b35eae5e6f9eb104179ec2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3cb1077f30b35eae5e6f9eb104179ec2">&#9670;&nbsp;</a></span>hal</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structhal__s.html">hal_s</a> hal = {0}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00081">81</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="main_8c_source.html#l00651">gyro_data_ready_cb()</a>, <a class="el" href="main_8c_source.html#l00408">handle_input()</a>, <a class="el" href="main_8c_source.html#l00665">main()</a>, <a class="el" href="main_8c_source.html#l00143">read_from_mpl()</a>, and <a class="el" href="main_8c_source.html#l00249">setup_gyro()</a>.</p>

</div>
</div>
<a id="ga359d30cf3d94f8046df41f14467c36de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga359d30cf3d94f8046df41f14467c36de">&#9670;&nbsp;</a></span>hal_timestamp</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">volatile uint32_t hal_timestamp = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>timestamp variable initialize, its for count tick </p>

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00043">43</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a id="ga4ef9c4b8e1082c8507e6cb1b9c618b87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4ef9c4b8e1082c8507e6cb1b9c618b87">&#9670;&nbsp;</a></span>header</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char header[3]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00062">62</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a id="gaeb8fb45fc306b199be68b3f61940fbb0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaeb8fb45fc306b199be68b3f61940fbb0">&#9670;&nbsp;</a></span>lp_accel_mode</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char lp_accel_mode</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00067">67</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="main_8c_source.html#l00408">handle_input()</a>, <a class="el" href="main_8c_source.html#l00665">main()</a>, and <a class="el" href="main_8c_source.html#l00249">setup_gyro()</a>.</p>

</div>
</div>
<a id="gafb031e775df5d8654f1ac1170378eb8d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gafb031e775df5d8654f1ac1170378eb8d">&#9670;&nbsp;</a></span>motion_int_mode</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char motion_int_mode</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00072">72</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="main_8c_source.html#l00408">handle_input()</a>, and <a class="el" href="main_8c_source.html#l00665">main()</a>.</p>

</div>
</div>
<a id="ga56d9a02ae0e768d49fd95fd014c47b07"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga56d9a02ae0e768d49fd95fd014c47b07">&#9670;&nbsp;</a></span>mpl_key</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char* mpl_key = (unsigned char*)&quot;eMPL 5.1&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00088">88</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a id="gacfce447bdb258e6fcf8e12e1b6e4481a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gacfce447bdb258e6fcf8e12e1b6e4481a">&#9670;&nbsp;</a></span>new_gyro</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">volatile unsigned char new_gyro</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00071">71</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="main_8c_source.html#l00651">gyro_data_ready_cb()</a>, and <a class="el" href="main_8c_source.html#l00665">main()</a>.</p>

</div>
</div>
<a id="ga7e499f7a5d40750be7a5ba81761a56bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7e499f7a5d40750be7a5ba81761a56bd">&#9670;&nbsp;</a></span>next_compass_ms</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned long next_compass_ms</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00076">76</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="main_8c_source.html#l00665">main()</a>.</p>

</div>
</div>
<a id="gaa40f644b7de352cb9ad81e2c602b5bae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa40f644b7de352cb9ad81e2c602b5bae">&#9670;&nbsp;</a></span>next_pedo_ms</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned long next_pedo_ms</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00074">74</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="main_8c_source.html#l00665">main()</a>, and <a class="el" href="main_8c_source.html#l00143">read_from_mpl()</a>.</p>

</div>
</div>
<a id="ga6f7f2c3d9913da113b6c5df295f50422"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6f7f2c3d9913da113b6c5df295f50422">&#9670;&nbsp;</a></span>next_temp_ms</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned long next_temp_ms</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00075">75</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="main_8c_source.html#l00665">main()</a>.</p>

</div>
</div>
<a id="ga1418e767c7efaa0fb2b3a55b7a69b44b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1418e767c7efaa0fb2b3a55b7a69b44b">&#9670;&nbsp;</a></span>no_dmp_hz</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned long no_dmp_hz</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00073">73</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a id="gaf119b3b2187456063d2687f989236daf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf119b3b2187456063d2687f989236daf">&#9670;&nbsp;</a></span>orientation</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">signed char orientation[9]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00092">92</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a id="ga5ab95f126fb29c3c65d6f4aa4944a2f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5ab95f126fb29c3c65d6f4aa4944a2f7">&#9670;&nbsp;</a></span>report</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int report</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00077">77</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="main_8c_source.html#l00408">handle_input()</a>, <a class="el" href="main_8c_source.html#l00665">main()</a>, and <a class="el" href="main_8c_source.html#l00143">read_from_mpl()</a>.</p>

</div>
</div>
<a id="ga02c35d11f6cb2fd88475c231ddf6afce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga02c35d11f6cb2fd88475c231ddf6afce">&#9670;&nbsp;</a></span>rx</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structrx__s.html">rx_s</a> rx</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00079">79</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="main_8c_source.html#l00408">handle_input()</a>, and <a class="el" href="main_8c_source.html#l00665">main()</a>.</p>

</div>
</div>
<a id="ga5bfb2c29b84492416fe0a885d4664132"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5bfb2c29b84492416fe0a885d4664132">&#9670;&nbsp;</a></span>rx_new</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">volatile unsigned char rx_new</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Usart Receive variable init. </p>
<p>USB RX binary semaphore. Actually, it's just a flag. Not included in struct because it's declared extern elsewhere. </p>

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00086">86</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a id="gaaa21c01566947e7007476657cb614e3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaaa21c01566947e7007476657cb614e3f">&#9670;&nbsp;</a></span>sensors</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char sensors</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00068">68</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="main_8c_source.html#l00408">handle_input()</a>, <a class="el" href="main_8c_source.html#l00665">main()</a>, and <a class="el" href="main_8c_source.html#l00249">setup_gyro()</a>.</p>

</div>
</div>
<a id="ga4028a8e467f1dc2db3018a557c353e8d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4028a8e467f1dc2db3018a557c353e8d">&#9670;&nbsp;</a></span>wait_for_tap</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char wait_for_tap</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00070">70</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
